var cc=cc||{};cc._tmp=cc._tmp||{};cc._LogInfos={};window._p;_p=window;_p.gl;_p.WebGLRenderingContext;_p.DeviceOrientationEvent;_p.DeviceMotionEvent;_p.AudioContext;_p.webkitAudioContext;_p.mozAudioContext;_p=Object.prototype;_p._super;_p.ctor;delete window._p;cc.newElement=function(a){return document.createElement(a)};cc._addEventListener=function(a,c,b,d){a.addEventListener(c,b,d)};cc._isNodeJs="undefined"!=typeof require&&require("fs");
cc.each=function(a,c,b){if(a)if(a instanceof Array)for(var d=0,e=a.length;e>d&&!1!==c.call(b,a[d],d);d++);else for(d in a)if(!1===c.call(b,a[d],d))break};cc.extend=function(a){var c=2<=arguments.length?Array.prototype.slice.call(arguments,1):[];return cc.each(c,function(c){for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d])}),a};cc.isFunction=function(a){return"function"==typeof a};cc.isNumber=function(a){return"number"==typeof a||"[object Number]"===Object.prototype.toString.call(a)};
cc.isString=function(a){return"string"==typeof a||"[object String]"===Object.prototype.toString.call(a)};cc.isArray=function(a){return Array.isArray(a)||"object"==typeof a&&"[object Array]"===Object.prototype.toString.call(a)};cc.isUndefined=function(a){return"undefined"==typeof a};cc.isObject=function(a){return"object"==typeof a&&"[object Object]"===Object.prototype.toString.call(a)};
cc.isCrossOrigin=function(a){if(!a)return cc.log("invalid URL"),!1;var c=a.indexOf("://");if(-1===c)return!1;c=a.indexOf("/",c+3);return(-1===c?a:a.substring(0,c))!==location.origin};
cc.AsyncPool=function(a,c,b,d,e){var f=this;f._srcObj=a;f._limit=c;f._pool=[];f._iterator=b;f._iteratorTarget=e;f._onEnd=d;f._onEndTarget=e;f._results=a instanceof Array?[]:{};f._isErr=!1;cc.each(a,function(a,c){f._pool.push({index:c,value:a})});f.size=f._pool.length;f.finishedSize=0;f._workingSize=0;f._limit=f._limit||f.size;f.onIterator=function(a,c){f._iterator=a;f._iteratorTarget=c};f.onEnd=function(a,c){f._onEnd=a;f._onEndTarget=c};f._handleItem=function(){var a=this;if(!(0===a._pool.length||
a._workingSize>=a._limit)){var c=a._pool.shift(),b=c.value,d=c.index;a._workingSize++;a._iterator.call(a._iteratorTarget,b,d,function(c){if(!a._isErr){if(a.finishedSize++,a._workingSize--,c)return a._isErr=!0,void(a._onEnd&&a._onEnd.call(a._onEndTarget,c));var b=Array.prototype.slice.call(arguments,1);return a._results[this.index]=b[0],a.finishedSize===a.size?void(a._onEnd&&a._onEnd.call(a._onEndTarget,null,a._results)):void a._handleItem()}}.bind(c),a)}};f.flow=function(){if(0===this._pool.length)return void(this._onEnd&&
this._onEnd.call(this._onEndTarget,null,[]));for(var a=0;a<this._limit;a++)this._handleItem()}};
cc.async={series:function(a,c,b){a=new cc.AsyncPool(a,1,function(a,c,f){a.call(b,f)},c,b);return a.flow(),a},parallel:function(a,c,b){a=new cc.AsyncPool(a,0,function(a,c,f){a.call(b,f)},c,b);return a.flow(),a},waterfall:function(a,c,b){var d=[],e=[null],f=new cc.AsyncPool(a,1,function(c,f,k){d.push(function(c){d=Array.prototype.slice.call(arguments,1);a.length-1===f&&(e=e.concat(d));k.apply(null,arguments)});c.apply(b,d)},function(a){return c?a?c.call(b,a):void c.apply(b,e):void 0});return f.flow(),
f},map:function(a,c,b,d){var e=c;"object"==typeof c&&(b=c.cb,d=c.iteratorTarget,e=c.iterator);a=new cc.AsyncPool(a,0,e,b,d);return a.flow(),a},mapLimit:function(a,c,b,d,e){a=new cc.AsyncPool(a,c,b,d,e);return a.flow(),a}};
cc.path={join:function(){for(var a=arguments.length,c="",b=0;a>b;b++)c=(c+(""===c?"":"/")+arguments[b]).replace(/(\/|\\\\)$/,"");return c},extname:function(a){return(a=/(\.[^\.\/\?\\]*)(\?.*)?$/.exec(a))?a[1]:null},mainFileName:function(a){if(a){var c=a.lastIndexOf(".");if(-1!==c)return a.substring(0,c)}return a},basename:function(a,c){var b=a.indexOf("?");0<b&&(a=a.substring(0,b));b=/(\/|\\\\)([^(\/|\\\\)]+)$/g.exec(a.replace(/(\/|\\\\)$/,""));if(!b)return null;b=b[2];return c&&a.substring(a.length-
c.length).toLowerCase()===c.toLowerCase()?b.substring(0,b.length-c.length):b},dirname:function(a){return a.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,"$2")},changeExtname:function(a,c){c=c||"";var b=a.indexOf("?"),d="";return 0<b&&(d=a.substring(b),a=a.substring(0,b)),b=a.lastIndexOf("."),0>b?a+c+d:a.substring(0,b)+c+d},changeBasename:function(a,c,b){if(0===c.indexOf("."))return this.changeExtname(a,c);var d=a.indexOf("?"),e="";b=b?this.extname(a):"";return 0<d&&(e=a.substring(d),a=a.substring(0,d)),
d=a.lastIndexOf("/"),d=0>=d?0:d+1,a.substring(0,d)+c+b+e}};
cc.loader={_jsCache:{},_register:{},_langPathCache:{},_aliases:{},resPath:"",audioPath:"",cache:{},getXMLHttpRequest:function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},_getArgs4Js:function(a){var c=a[0],b=a[1],d=a[2],e=["",null,null];if(1===a.length)e[1]=c instanceof Array?c:[c];else if(2===a.length)"function"==typeof b?(e[1]=c instanceof Array?c:[c],e[2]=b):(e[0]=c||"",e[1]=b instanceof Array?b:[b]);else{if(3!==a.length)throw"arguments error to load js!";
e[0]=c||"";e[1]=b instanceof Array?b:[b];e[2]=d}return e},loadJs:function(a,c,b){var d=this,e=d._jsCache,f=d._getArgs4Js(arguments),g=f[0],h=f[1],f=f[2];-1<navigator.userAgent.indexOf("Trident/5")?d._loadJs4Dependency(g,h,0,f):cc.async.map(h,function(a,c,b){a=cc.path.join(g,a);return e[a]?b(null):void d._createScript(a,!1,b)},f)},loadJsWithImg:function(a,c,b){var d=this._loadJsImg(),e=this._getArgs4Js(arguments);this.loadJs(e[0],e[1],function(a){if(a)throw a;d.parentNode.removeChild(d);e[2]&&e[2]()})},
_createScript:function(a,c,b){var d=document,e=cc.newElement("script");e.async=c;this._jsCache[a]=!0;cc.game.config.noCache&&"string"==typeof a?this._noCacheRex.test(a)?e.src=a+"&_t="+(new Date-0):e.src=a+"?_t="+(new Date-0):e.src=a;cc._addEventListener(e,"load",function(){e.parentNode.removeChild(e);this.removeEventListener("load",arguments.callee,!1);b()},!1);cc._addEventListener(e,"error",function(){e.parentNode.removeChild(e);b("Load "+a+" failed!")},!1);d.body.appendChild(e)},_loadJs4Dependency:function(a,
c,b,d){if(b>=c.length)return void(d&&d());var e=this;e._createScript(cc.path.join(a,c[b]),!1,function(f){return f?d(f):void e._loadJs4Dependency(a,c,b+1,d)})},_loadJsImg:function(){var a=document,c=a.getElementById("cocos2d_loadJsImg");if(!c){c=cc.newElement("img");cc._loadingImage&&(c.src=cc._loadingImage);a=a.getElementById(cc.game.config.id);a.style.backgroundColor="black";a.parentNode.appendChild(c);var b=getComputedStyle?getComputedStyle(a):a.currentStyle;b||(b={width:a.width,height:a.height});
c.style.left=a.offsetLeft+(parseFloat(b.width)-c.width)/2+"px";c.style.top=a.offsetTop+(parseFloat(b.height)-c.height)/2+"px";c.style.position="absolute"}return c},loadTxt:function(a,c){if(cc._isNodeJs)require("fs").readFile(a,function(a,b){a?c(a):c(null,b.toString())});else{var b=this.getXMLHttpRequest(),d="load "+a+" failed!";b.open("GET",a,!0);/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?(b.setRequestHeader("Accept-Charset","utf-8"),b.onreadystatechange=function(){4===
b.readyState&&(200===b.status?c(null,b.responseText):c(d))}):(b.overrideMimeType&&b.overrideMimeType("text/plain; charset=utf-8"),b.onload=function(){4===b.readyState&&(200===b.status?c(null,b.responseText):c(d))});b.send(null)}},_loadTxtSync:function(a){if(cc._isNodeJs)return require("fs").readFileSync(a).toString();var c=this.getXMLHttpRequest();return c.open("GET",a,!1),/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?c.setRequestHeader("Accept-Charset","utf-8"):c.overrideMimeType&&
c.overrideMimeType("text/plain; charset=utf-8"),c.send(null),4===!c.readyState||200!==c.status?null:c.responseText},loadCsb:function(a,c){var b=new XMLHttpRequest;b.open("GET",a,!0);b.responseType="arraybuffer";b.onload=function(){var d=b.response;d&&(window.msg=d);4===b.readyState&&(200===b.status?c(null,b.response):c("load "+a+" failed!"))};b.send(null)},loadJson:function(a,c){this.loadTxt(a,function(b,d){if(b)c(b);else{try{var e=JSON.parse(d)}catch(f){throw"parse json ["+a+"] failed : "+f;}c(null,
e)}})},_checkIsImageURL:function(a){return null!=/(\.png)|(\.jpg)|(\.bmp)|(\.jpeg)|(\.gif)/.exec(a)},loadImg:function(a,c,b){var d={isCrossOrigin:!0};void 0!==b?d.isCrossOrigin=null===c.isCrossOrigin?d.isCrossOrigin:c.isCrossOrigin:void 0!==c&&(b=c);var e=this.getRes(a);if(e)return b&&b(null,e),e;e=new Image;d.isCrossOrigin&&"file://"!==location.origin&&(e.crossOrigin="Anonymous");var f=function(){this.removeEventListener("load",f,!1);this.removeEventListener("error",h,!1);cc.loader.cache[a]=e;b&&
b(null,e)},g=this,h=function(){this.removeEventListener("error",h,!1);e.crossOrigin&&"anonymous"===e.crossOrigin.toLowerCase()?(d.isCrossOrigin=!1,g.release(a),cc.loader.loadImg(a,d,b)):"function"==typeof b&&b("load image failed")};return cc._addEventListener(e,"load",f),cc._addEventListener(e,"error",h),e.src=a,e},_loadResIterator:function(a,c,b){var d=this,e=null,f=a.type;f?(f="."+f.toLowerCase(),e=a.src?a.src:a.name+f):(e=a,f=cc.path.extname(e));if(c=d.getRes(e))return b(null,c);c=null;if(f&&(c=
d._register[f.toLowerCase()]),!c)return cc.error("loader for ["+f+"] not exists!"),b();f=c.getBasePath?c.getBasePath():d.resPath;f=d.getUrl(f,e);cc.game.config.noCache&&"string"==typeof f&&(f+=d._noCacheRex.test(f)?"&_t="+(new Date-0):"?_t="+(new Date-0));c.load(f,e,a,function(a,c){a?(cc.log(a),d.cache[e]=null,delete d.cache[e],b()):(d.cache[e]=c,b(null,c))})},_noCacheRex:/\?/,getUrl:function(a,c){var b=this._langPathCache,d=cc.path;if(void 0!==a&&void 0===c){c=a;var e=d.extname(c),e=e?e.toLowerCase():
"";a=(e=this._register[e])&&e.getBasePath?e.getBasePath():this.resPath}if(c=cc.path.join(a||"",c),c.match(/[\/(\\\\)]lang[\/(\\\\)]/i)){if(b[c])return b[c];d=d.extname(c)||"";c=b[c]=c.substring(0,c.length-d.length)+"_"+cc.sys.language+d}return c},load:function(a,c,b){var d=this,e=arguments.length;if(0===e)throw"arguments error!";3===e?"function"==typeof c&&(c="function"==typeof b?{trigger:c,cb:b}:{cb:c,cbTarget:b}):2===e?"function"==typeof c&&(c={cb:c}):1===e&&(c={});a instanceof Array||(a=[a]);e=
new cc.AsyncPool(a,0,function(a,b,e,k){d._loadResIterator(a,b,function(a){if(a)return e(a);var b=Array.prototype.slice.call(arguments,1);c.trigger&&c.trigger.call(c.triggerTarget,b[0],k.size,k.finishedSize);e(null,b[0])})},c.cb,c.cbTarget);return e.flow(),e},_handleAliases:function(a,c){var b=this._aliases,d=[],e;for(e in a){var f=a[e];b[e]=f;d.push(f)}this.load(d,c)},loadAliases:function(a,c){var b=this,d=b.getRes(a);d?b._handleAliases(d.filenames,c):b.load(a,function(a,d){b._handleAliases(d[0].filenames,
c)})},register:function(a,c){if(a&&c){if("string"==typeof a)return this._register[a.trim().toLowerCase()]=c;for(var b=0,d=a.length;d>b;b++)this._register["."+a[b].trim().toLowerCase()]=c}},getRes:function(a){return this.cache[a]||this.cache[this._aliases[a]]},release:function(a){var c=this.cache,b=this._aliases;delete c[a];delete c[b[a]];delete b[a]},releaseAll:function(){var a=this.cache,c=this._aliases,b;for(b in a)delete a[b];for(b in c)delete c[b]}};
cc.formatStr=function(){var a=arguments,c=a.length;if(1>c)return"";var b=a[0],d=!0;"object"==typeof b&&(d=!1);for(var e=1;c>e;++e){var f=a[e];if(d)for(;;){var g=null;if("number"==typeof f&&b.match(/(%d)|(%s)/)){b=b.replace(/(%d)|(%s)/,f);break}(g=b.match(/%s/))?b=b.replace(/%s/,f):b+="    "+f;break}else b+="    "+f}return b};
(function(){var a,c,b=window;cc.isUndefined(document.hidden)?cc.isUndefined(document.mozHidden)?cc.isUndefined(document.msHidden)?cc.isUndefined(document.webkitHidden)||(a="webkitHidden",c="webkitvisibilitychange"):(a="msHidden",c="msvisibilitychange"):(a="mozHidden",c="mozvisibilitychange"):(a="hidden",c="visibilitychange");var d=function(){cc.eventManager&&cc.game._eventHide&&cc.eventManager.dispatchEvent(cc.game._eventHide)},e=function(){cc.eventManager&&cc.game._eventShow&&cc.eventManager.dispatchEvent(cc.game._eventShow);
cc.game._intervalId&&(window.cancelAnimationFrame(cc.game._intervalId),cc.game._runMainLoop())};a?cc._addEventListener(document,c,function(){document[a]?d():e()},!1):(cc._addEventListener(b,"blur",d,!1),cc._addEventListener(b,"focus",e,!1));-1<navigator.userAgent.indexOf("MicroMessenger")&&(b.onfocus=function(){e()});"onpageshow"in window&&"onpagehide"in window&&(cc._addEventListener(b,"pagehide",d,!1),cc._addEventListener(b,"pageshow",e,!1));c=b=null})();cc.log=cc.warn=cc.error=cc.assert=function(){};
cc.create3DContext=function(a,c){for(var b=["webgl","experimental-webgl","webkit-3d","moz-webgl"],d=null,e=0;e<b.length;++e){try{d=a.getContext(b[e],c)}catch(f){}if(d)break}return d};
cc._initSys=function(a,c){cc._RENDER_TYPE_CANVAS=0;cc._RENDER_TYPE_WEBGL=1;cc.sys={};var b=cc.sys;b.LANGUAGE_ENGLISH="en";b.LANGUAGE_CHINESE="zh";b.LANGUAGE_FRENCH="fr";b.LANGUAGE_ITALIAN="it";b.LANGUAGE_GERMAN="de";b.LANGUAGE_SPANISH="es";b.LANGUAGE_DUTCH="du";b.LANGUAGE_RUSSIAN="ru";b.LANGUAGE_KOREAN="ko";b.LANGUAGE_JAPANESE="ja";b.LANGUAGE_HUNGARIAN="hu";b.LANGUAGE_PORTUGUESE="pt";b.LANGUAGE_ARABIC="ar";b.LANGUAGE_NORWEGIAN="no";b.LANGUAGE_POLISH="pl";b.OS_IOS="iOS";b.OS_ANDROID="Android";b.OS_WINDOWS=
"Windows";b.OS_MARMALADE="Marmalade";b.OS_LINUX="Linux";b.OS_BADA="Bada";b.OS_BLACKBERRY="Blackberry";b.OS_OSX="OS X";b.OS_WP8="WP8";b.OS_WINRT="WINRT";b.OS_UNKNOWN="Unknown";b.UNKNOWN=0;b.IOS=1;b.ANDROID=2;b.WIN32=3;b.MARMALADE=4;b.LINUX=5;b.BADA=6;b.BLACKBERRY=7;b.MACOS=8;b.NACL=9;b.EMSCRIPTEN=10;b.TIZEN=11;b.QT5=12;b.WP8=13;b.WINRT=14;b.MOBILE_BROWSER=100;b.DESKTOP_BROWSER=101;b.BROWSER_TYPE_WECHAT="wechat";b.BROWSER_TYPE_ANDROID="androidbrowser";b.BROWSER_TYPE_IE="ie";b.BROWSER_TYPE_QQ="qqbrowser";
b.BROWSER_TYPE_MOBILE_QQ="mqqbrowser";b.BROWSER_TYPE_UC="ucbrowser";b.BROWSER_TYPE_360="360browser";b.BROWSER_TYPE_BAIDU_APP="baiduboxapp";b.BROWSER_TYPE_BAIDU="baidubrowser";b.BROWSER_TYPE_MAXTHON="maxthon";b.BROWSER_TYPE_OPERA="opera";b.BROWSER_TYPE_OUPENG="oupeng";b.BROWSER_TYPE_MIUI="miuibrowser";b.BROWSER_TYPE_FIREFOX="firefox";b.BROWSER_TYPE_SAFARI="safari";b.BROWSER_TYPE_CHROME="chrome";b.BROWSER_TYPE_LIEBAO="liebao";b.BROWSER_TYPE_QZONE="qzone";b.BROWSER_TYPE_SOUGOU="sogou";b.BROWSER_TYPE_UNKNOWN=
"unknown";b.isNative=!1;var d=window,e=d.navigator,f=document,g=f.documentElement,h=e.userAgent.toLowerCase();b.isMobile=-1!==h.indexOf("mobile")||-1!==h.indexOf("android");b.platform=b.isMobile?b.MOBILE_BROWSER:b.DESKTOP_BROWSER;var k=e.language,k=(k=k?k:e.browserLanguage)?k.split("-")[0]:b.LANGUAGE_ENGLISH;b.language=k;var k=b.BROWSER_TYPE_UNKNOWN,m=h.match(/sogou|qzone|liebao|micromessenger|qqbrowser|ucbrowser|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|trident|oupeng|opera|miuibrowser|firefox/i)||
h.match(/chrome|safari/i);m&&0<m.length?(k=m[0],"micromessenger"===k?k=b.BROWSER_TYPE_WECHAT:"safari"===k&&h.match(/android.*applewebkit/)?k=b.BROWSER_TYPE_ANDROID:"trident"===k?k=b.BROWSER_TYPE_IE:"360 aphone"===k&&(k=b.BROWSER_TYPE_360)):h.indexOf("iphone")&&h.indexOf("mobile")&&(k="safari");b.browserType=k;k=h.match(/(iPad|iPhone|iPod)/i)?!0:!1;h=h.match(/android/i)||e.platform.match(/android/i)?!0:!1;m=b.OS_UNKNOWN;-1!==e.appVersion.indexOf("Win")?m=b.OS_WINDOWS:k?m=b.OS_IOS:-1!==e.appVersion.indexOf("Mac")?
m=b.OS_OSX:-1!==e.appVersion.indexOf("X11")&&-1===e.appVersion.indexOf("Linux")?m=b.OS_UNIX:h?m=b.OS_ANDROID:-1!==e.appVersion.indexOf("Linux")&&(m=b.OS_LINUX);b.os=m;b._supportMultipleAudio=-1<[b.BROWSER_TYPE_BAIDU,b.BROWSER_TYPE_OPERA,b.BROWSER_TYPE_FIREFOX,b.BROWSER_TYPE_CHROME,b.BROWSER_TYPE_BAIDU_APP,b.BROWSER_TYPE_SAFARI,b.BROWSER_TYPE_UC,b.BROWSER_TYPE_QQ,b.BROWSER_TYPE_MOBILE_QQ,b.BROWSER_TYPE_IE].indexOf(b.browserType);(function(a,b){var e=b[c.renderMode]-0;(isNaN(e)||2<e||0>e)&&(e=0);var f=
[a.OS_ANDROID],g=[],h=cc.newElement("canvas");cc._renderType=cc._RENDER_TYPE_CANVAS;cc._supportRender=!1;var k=d.WebGLRenderingContext;if(2===e||0===e&&k&&-1===f.indexOf(a.os)&&-1===g.indexOf(a.browserType))try{cc.create3DContext(h,{stencil:!0,preserveDrawingBuffer:!0})&&(cc._renderType=cc._RENDER_TYPE_WEBGL,cc._supportRender=!0)}catch(m){}if(1===e||0===e&&!1===cc._supportRender)try{h.getContext("2d"),cc._renderType=cc._RENDER_TYPE_CANVAS,cc._supportRender=!0}catch(n){}})(b,a);b._canUseCanvasNewBlendModes=
function(){var a=document.createElement("canvas");a.width=1;a.height=1;a=a.getContext("2d");a.fillStyle="#000";a.fillRect(0,0,1,1);a.globalCompositeOperation="multiply";var c=document.createElement("canvas");c.width=1;c.height=1;var b=c.getContext("2d");return b.fillStyle="#fff",b.fillRect(0,0,1,1),a.drawImage(c,0,0,1,1),0===a.getImageData(0,0,1,1).data[0]};b._supportCanvasNewBlendModes=b._canUseCanvasNewBlendModes();try{b._supportWebAudio=!!(d.AudioContext||d.webkitAudioContext||d.mozAudioContext)}catch(n){b._supportWebAudio=
!1}try{var p=b.localStorage=d.localStorage;p.setItem("storage","");p.removeItem("storage");p=null}catch(q){"SECURITY_ERR"!==q.name&&"QuotaExceededError"!==q.name||cc.warn("Warning: localStorage isn't enabled. Please confirm browser cookie or privacy option"),b.localStorage=function(){}}p=b.capabilities={canvas:!0};cc._renderType===cc._RENDER_TYPE_WEBGL&&(p.opengl=!0);(void 0!==g.ontouchstart||void 0!==f.ontouchstart||e.msPointerEnabled)&&(p.touches=!0);void 0!==g.onmouseup&&(p.mouse=!0);void 0!==
g.onkeyup&&(p.keyboard=!0);(d.DeviceMotionEvent||d.DeviceOrientationEvent)&&(p.accelerometer=!0);b.garbageCollect=function(){};b.dumpRoot=function(){};b.restartVM=function(){};b.cleanScript=function(a){};b.isObjectValid=function(a){return a?!0:!1};b.dump=function(){var a;a=""+("isMobile : "+this.isMobile+"\r\n");a+="language : "+this.language+"\r\n";a+="browserType : "+this.browserType+"\r\n";a+="capabilities : "+JSON.stringify(this.capabilities)+"\r\n";a+="os : "+this.os+"\r\n";a+="platform : "+
this.platform+"\r\n";cc.log(a)};b.openURL=function(a){window.open(a)}};cc.ORIENTATION_PORTRAIT=0;cc.ORIENTATION_PORTRAIT_UPSIDE_DOWN=1;cc.ORIENTATION_LANDSCAPE_LEFT=2;cc.ORIENTATION_LANDSCAPE_RIGHT=3;cc._drawingUtil=null;cc._renderContext=null;cc._canvas=null;cc._gameDiv=null;cc._rendererInitialized=!1;cc._setupCalled=!1;
cc._setup=function(a,c,b){if(!cc._setupCalled){cc._setupCalled=!0;var d,e,f,g=window;a=cc.$(a)||cc.$("#"+a);if(cc.game._setAnimFrame(),"CANVAS"===a.tagName?(c=c||a.width,b=b||a.height,e=cc.container=cc.newElement("DIV"),d=cc._canvas=a,d.parentNode.insertBefore(e,d),d.appendTo(e),e.setAttribute("id","Cocos2dGameContainer")):("DIV"!==a.tagName&&cc.log("Warning: target element is not a DIV or CANVAS"),c=c||a.clientWidth,b=b||a.clientHeight,e=cc.container=a,d=cc._canvas=cc.$(cc.newElement("CANVAS")),
a.appendChild(d)),d.addClass("gameCanvas"),d.setAttribute("width",c||480),d.setAttribute("height",b||320),d.setAttribute("tabindex",99),d.style.outline="none",f=e.style,f.width=(c||480)+"px",f.height=(b||320)+"px",f.margin="0 auto",f.position="relative",f.overflow="hidden",e.top="100%",cc._renderType===cc._RENDER_TYPE_WEBGL&&(cc._renderContext=cc.webglContext=cc.create3DContext(d,{stencil:!0,preserveDrawingBuffer:!0,antialias:!cc.sys.isMobile,alpha:!1})),cc._renderContext?(g.gl=cc._renderContext,
cc._drawingUtil=new cc.DrawingPrimitiveWebGL(cc._renderContext),cc._rendererInitialized=!0,cc.textureCache._initializingRenderer(),cc.shaderCache._init()):(cc._renderContext=new cc.CanvasContextWrapper(d.getContext("2d")),cc._drawingUtil=cc.DrawingPrimitiveCanvas?new cc.DrawingPrimitiveCanvas(cc._renderContext):null),cc._gameDiv=e,cc.log(cc.ENGINE_VERSION),cc._setContextMenuEnable(!1),cc.sys.isMobile)c=cc.newElement("style"),c.type="text/css",document.body.appendChild(c),c.textContent="body,canvas,div{ -moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;-khtml-user-select: none;-webkit-tap-highlight-color:rgba(0,0,0,0);}";
cc.view=cc.EGLView._getInstance();cc.inputManager.registerSystemEvent(cc._canvas);cc.director=cc.Director._getInstance();cc.director.setOpenGLView&&cc.director.setOpenGLView(cc.view);cc.winSize=cc.director.getWinSize();cc.saxParser=new cc.SAXParser;cc.plistParser=new cc.PlistParser}};cc._checkWebGLRenderMode=function(){if(cc._renderType!==cc._RENDER_TYPE_WEBGL)throw"This feature supports WebGL render mode only.";};cc._isContextMenuEnable=!1;
cc._setContextMenuEnable=function(a){cc._isContextMenuEnable=a;cc._canvas.oncontextmenu=function(){return cc._isContextMenuEnable?void 0:!1}};
cc.game={DEBUG_MODE_NONE:0,DEBUG_MODE_INFO:1,DEBUG_MODE_WARN:2,DEBUG_MODE_ERROR:3,DEBUG_MODE_INFO_FOR_WEB_PAGE:4,DEBUG_MODE_WARN_FOR_WEB_PAGE:5,DEBUG_MODE_ERROR_FOR_WEB_PAGE:6,EVENT_HIDE:"game_on_hide",EVENT_SHOW:"game_on_show",_eventHide:null,_eventShow:null,_onBeforeStartArr:[],CONFIG_KEY:{engineDir:"engineDir",dependencies:"dependencies",debugMode:"debugMode",showFPS:"showFPS",frameRate:"frameRate",id:"id",renderMode:"renderMode",jsList:"jsList",classReleaseMode:"classReleaseMode"},_prepareCalled:!1,
_prepared:!1,_paused:!0,_intervalId:null,_lastTime:null,_frameTime:null,config:null,onStart:null,onStop:null,setFrameRate:function(a){this.config[this.CONFIG_KEY.frameRate]=a;this._intervalId&&window.cancelAnimationFrame(this._intervalId);this._paused=!0;this._setAnimFrame();this._runMainLoop()},_setAnimFrame:function(){this._lastTime=new Date;this._frameTime=1E3/cc.game.config[cc.game.CONFIG_KEY.frameRate];cc.sys.os===cc.sys.OS_IOS&&cc.sys.browserType===cc.sys.BROWSER_TYPE_WECHAT||60!==cc.game.config[cc.game.CONFIG_KEY.frameRate]?
(window.requestAnimFrame=this._stTime,window.cancelAnimationFrame=this._ctTime):(window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||this._stTime,window.cancelAnimationFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||
window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame||this._ctTime)},_stTime:function(a){var c=(new Date).getTime(),b=Math.max(0,cc.game._frameTime-(c-cc.game._lastTime)),d=window.setTimeout(function(){a()},b);return cc.game._lastTime=c+b,d},_ctTime:function(a){window.clearTimeout(a)},_runMainLoop:function(){var a,c=this,b=cc.director;b.setDisplayStats(c.config[c.CONFIG_KEY.showFPS]);a=function(){c._paused||(b.mainLoop(),c._intervalId&&
window.cancelAnimationFrame(c._intervalId),c._intervalId=window.requestAnimFrame(a))};window.requestAnimFrame(a);c._paused=!1},restart:function(){cc.director.popToSceneStackLevel(0);cc.audioEngine&&cc.audioEngine.end();cc.game.onStart()},run:function(a){var c=this,b=function(){a&&(c.config[c.CONFIG_KEY.id]=a);c._prepareCalled||c.prepare(function(){c._prepared=!0});cc._supportRender&&(c._checkPrepare=setInterval(function(){c._prepared&&(cc._setup(c.config[c.CONFIG_KEY.id]),c._runMainLoop(),c._eventHide=
c._eventHide||new cc.EventCustom(c.EVENT_HIDE),c._eventHide.setUserData(c),c._eventShow=c._eventShow||new cc.EventCustom(c.EVENT_SHOW),c._eventShow.setUserData(c),c.onStart(),clearInterval(c._checkPrepare))},10))};document.body?b():cc._addEventListener(window,"load",function(){this.removeEventListener("load",arguments.callee,!1);b()},!1)},_initConfig:function(){var a=this.CONFIG_KEY,c=function(c){return c[a.engineDir]=c[a.engineDir]||"frameworks/cocos2d-html5",null==c[a.debugMode]&&(c[a.debugMode]=
0),c[a.frameRate]=c[a.frameRate]||60,null==c[a.renderMode]&&(c[a.renderMode]=1),c};if(document.ccConfig)this.config=c(document.ccConfig);else try{for(var b=document.getElementsByTagName("script"),d=0;d<b.length;d++){var e=b[d].getAttribute("cocos");if(""===e||e)break}var f,g,h;d<b.length&&(f=b[d].src,f&&(h=/(.*)\//.exec(f)[0],cc.loader.resPath=h,f=cc.path.join(h,"project.json")),g=cc.loader._loadTxtSync(f));g||(g=cc.loader._loadTxtSync("project.json"));var k=JSON.parse(g);this.config=c(k||{})}catch(m){cc.log("Failed to read or parse project.json"),
this.config=c({})}cc._initSys(this.config,a)},_jsAddedCache:{},_getJsListOfModule:function(a,c,b){var d=this._jsAddedCache;if(d[c])return null;b=b||"";var e=[],f=a[c];if(!f)throw"can not find module ["+c+"]";c=cc.path;for(var g=0,h=f.length;h>g;g++){var k=f[g];if(!d[k]){var m=c.extname(k);m?".js"===m.toLowerCase()&&e.push(c.join(b,k)):(m=this._getJsListOfModule(a,k,b))&&(e=e.concat(m));d[k]=1}}return e},prepare:function(a){var c=this,b=c.config,d=c.CONFIG_KEY,e=b[d.engineDir],f=cc.loader;if(!cc._supportRender)throw"The renderer doesn't support the renderMode "+
b[d.renderMode];c._prepareCalled=!0;var g=b[d.jsList]||[];cc.Class?f.loadJsWithImg("",g,function(b){if(b)throw b;c._prepared=!0;a&&a()}):(d=cc.path.join(e,"moduleConfig.json"),f.loadJson(d,function(d,f){if(d)throw d;var m=b.modules||[],n=f.module,p=[];cc._renderType===cc._RENDER_TYPE_WEBGL?m.splice(0,0,"shaders"):0>m.indexOf("core")&&m.splice(0,0,"core");for(var q=0,r=m.length;r>q;q++){var u=c._getJsListOfModule(n,m[q],e);u&&(p=p.concat(u))}p=p.concat(g);cc.loader.loadJsWithImg(p,function(b){if(b)throw b;
c._prepared=!0;a&&a()})}))}};cc.game._initConfig();Function.prototype.bind=Function.prototype.bind||function(a){if(!cc.isFunction(this))throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var c=Array.prototype.slice.call(arguments,1),b=this,d=function(){},e=function(){return b.apply(this instanceof d&&a?this:a,c.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e};cc=cc||{};cc._loadingImage="data:image/gif;base64,R0lGODlhEAAQALMNAD8/P7+/vyoqKlVVVX9/fxUVFUBAQGBgYMDAwC8vL5CQkP///wAAAP///wAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFAAANACwAAAAAEAAQAAAEO5DJSau9OOvNex0IMnDIsiCkiW6g6BmKYlBFkhSUEgQKlQCARG6nEBwOgl+QApMdCIRD7YZ5RjlGpCUCACH5BAUAAA0ALAAAAgAOAA4AAAQ6kLGB0JA4M7QW0hrngRllkYyhKAYqKUGguAws0ypLS8JxCLQDgXAIDg+FRKIA6v0SAECCBpXSkstMBAAh+QQFAAANACwAAAAACgAQAAAEOJDJORAac6K1kDSKYmydpASBUl0mqmRfaGTCcQgwcxDEke+9XO2WkxQSiUIuAQAkls0n7JgsWq8RACH5BAUAAA0ALAAAAAAOAA4AAAQ6kMlplDIzTxWC0oxwHALnDQgySAdBHNWFLAvCukc215JIZihVIZEogDIJACBxnCSXTcmwGK1ar1hrBAAh+QQFAAANACwAAAAAEAAKAAAEN5DJKc4RM+tDyNFTkSQF5xmKYmQJACTVpQSBwrpJNteZSGYoFWjIGCAQA2IGsVgglBOmEyoxIiMAIfkEBQAADQAsAgAAAA4ADgAABDmQSVZSKjPPBEDSGucJxyGA1XUQxAFma/tOpDlnhqIYN6MEAUXvF+zldrMBAjHoIRYLhBMqvSmZkggAIfkEBQAADQAsBgAAAAoAEAAABDeQyUmrnSWlYhMASfeFVbZdjHAcgnUQxOHCcqWylKEohqUEAYVkgEAMfkEJYrFA6HhKJsJCNFoiACH5BAUAAA0ALAIAAgAOAA4AAAQ3kMlJq704611SKloCAEk4lln3DQgyUMJxCBKyLAh1EMRR3wiDQmHY9SQslyIQUMRmlmVTIyRaIgA7";
cc._fpsImage="data:image/png;base64,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";
cc._loaderImage="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAAlAAD/4QMpaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MCA2MS4xMzQ3NzcsIDIwMTAvMDIvMTItMTc6MzI6MDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjM4MDBEMDY2QTU1MjExRTFBQTAzQjEzMUNFNzMxRkQwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjM4MDBEMDY1QTU1MjExRTFBQTAzQjEzMUNFNzMxRkQwIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUgV2luZG93cyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU2RTk0OEM4OERCNDExRTE5NEUyRkE3M0M3QkE1NTlEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU2RTk0OEM5OERCNDExRTE5NEUyRkE3M0M3QkE1NTlEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+/+4ADkFkb2JlAGTAAAAAAf/bAIQADQkJCQoJDQoKDRMMCwwTFhENDREW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";
cc.loader.loadBinary=function(a,c){var b=this,d=this.getXMLHttpRequest(),e="load "+a+" failed!";d.open("GET",a,!0);/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?(d.setRequestHeader("Accept-Charset","x-user-defined"),d.onreadystatechange=function(){if(4===d.readyState&&200===d.status){var a=cc._convertResponseBodyToText(d.responseBody);c(null,b._str2Uint8Array(a))}else c(e)}):(d.overrideMimeType&&d.overrideMimeType("text/plain; charset=x-user-defined"),d.onload=function(){4===
d.readyState&&200===d.status?c(null,b._str2Uint8Array(d.responseText)):c(e)});d.send(null)};cc.loader._str2Uint8Array=function(a){if(!a)return null;for(var c=new Uint8Array(a.length),b=0;b<a.length;b++)c[b]=255&a.charCodeAt(b);return c};
cc.loader.loadBinarySync=function(a){var c=this.getXMLHttpRequest(),b="load "+a+" failed!";c.open("GET",a,!1);a=null;if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){if(c.setRequestHeader("Accept-Charset","x-user-defined"),c.send(null),200!==c.status)return cc.log(b),null;(c=cc._convertResponseBodyToText(c.responseBody))&&(a=this._str2Uint8Array(c))}else{if(c.overrideMimeType&&c.overrideMimeType("text/plain; charset=x-user-defined"),c.send(null),200!==c.status)return cc.log(b),
null;a=this._str2Uint8Array(c.responseText)}return a};var Uint8Array=Uint8Array||Array;
if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){var IEBinaryToArray_ByteStr_Script='\x3c!-- IEBinaryToArray_ByteStr --\x3e\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = ""\r\n   End If\r\nEnd Function\r\n',myVBScript=
cc.newElement("script");myVBScript.type="text/vbscript";myVBScript.textContent=IEBinaryToArray_ByteStr_Script;document.body.appendChild(myVBScript);cc._convertResponseBodyToText=function(a){for(var c={},b=0;256>b;b++)for(var d=0;256>d;d++)c[String.fromCharCode(b+256*d)]=String.fromCharCode(b)+String.fromCharCode(d);b=IEBinaryToArray_ByteStr(a);a=IEBinaryToArray_ByteStr_Last(a);return b.replace(/[\s\S]/g,function(a){return c[a]})+a}}
var cc=cc||{},ClassManager={id:0|998*Math.random(),instanceId:0|998*Math.random(),compileSuper:function(a,c,b){a=a.toString();var d=a.indexOf("("),e=a.indexOf(")"),d=a.substring(d+1,e),d=d.trim(),e=a.indexOf("{"),f=a.lastIndexOf("}");for(a=a.substring(e+1,f);-1!==a.indexOf("this._super");){var e=a.indexOf("this._super"),f=a.indexOf("(",e),g=a.indexOf(")",f),g=a.substring(f+1,g),g=(g=g.trim())?",":"";a=a.substring(0,e)+"ClassManager["+b+"]."+c+".call(this"+g+a.substring(f+1)}return Function(d,a)},
getNewID:function(){return this.id++},getNewInstanceId:function(){return this.instanceId++}};
switch(ClassManager.compileSuper.ClassManager=ClassManager,function(){var a=/\b_super\b/,c=cc.game.config[cc.game.CONFIG_KEY.classReleaseMode];c&&console.log("release Mode");cc.Class=function(){};cc.Class.extend=function(b){function d(){this.__instanceId=ClassManager.getNewInstanceId();this.ctor&&this.ctor.apply(this,arguments)}var e=this.prototype,f=Object.create(e),g=ClassManager.getNewID();ClassManager[g]=e;var h={writable:!0,enumerable:!1,configurable:!0};f.__instanceId=null;d.id=g;h.value=g;
Object.defineProperty(f,"__pid",h);d.prototype=f;h.value=d;Object.defineProperty(d.prototype,"constructor",h);this.__getters__&&(d.__getters__=cc.clone(this.__getters__));this.__setters__&&(d.__setters__=cc.clone(this.__setters__));for(var k=0,m=arguments.length;m>k;++k){var n=arguments[k],p;for(p in n){var q="function"==typeof n[p],r="function"==typeof e[p],u=a.test(n[p]);if(c&&q&&r&&u?(h.value=ClassManager.compileSuper(n[p],p,g),Object.defineProperty(f,p,h)):q&&r&&u?(h.value=function(a,c){return function(){var b=
this._super;this._super=e[a];var d=c.apply(this,arguments);return this._super=b,d}}(p,n[p]),Object.defineProperty(f,p,h)):q?(h.value=n[p],Object.defineProperty(f,p,h)):f[p]=n[p],q){var t,v;if(this.__getters__&&this.__getters__[p]){var q=this.__getters__[p],w;for(w in this.__setters__)if(this.__setters__[w]===q){v=w;break}cc.defineGetterSetter(f,q,n[p],n[v]?n[v]:f[v],p,v)}if(this.__setters__&&this.__setters__[p]){q=this.__setters__[p];for(w in this.__getters__)if(this.__getters__[w]===q){t=w;break}cc.defineGetterSetter(f,
q,n[t]?n[t]:f[t],n[p],t,p)}}}}return d.extend=cc.Class.extend,d.implement=function(a){for(var c in a)f[c]=a[c]},d}}(),cc.defineGetterSetter=function(a,c,b,d,e,f){if(a.__defineGetter__)b&&a.__defineGetter__(c,b),d&&a.__defineSetter__(c,d);else{if(!Object.defineProperty)throw Error("browser does not support getters");var g={enumerable:!1,configurable:!0};b&&(g.get=b);d&&(g.set=d);Object.defineProperty(a,c,g)}if(!e&&!f)for(var g=null!=b,h=void 0!=d,k=Object.getOwnPropertyNames(a),m=0;m<k.length;m++){var n=
k[m];if((a.__lookupGetter__?!a.__lookupGetter__(n):!Object.getOwnPropertyDescriptor(a,n))&&"function"==typeof a[n]){var p=a[n];if(g&&p===b&&(e=n,!h||f))break;if(h&&p===d&&(f=n,!g||e))break}}a=a.constructor;e&&(a.__getters__||(a.__getters__={}),a.__getters__[e]=c);f&&(a.__setters__||(a.__setters__={}),a.__setters__[f]=c)},cc.clone=function(a){var c=a.constructor?new a.constructor:{},b;for(b in a){var d=a[b];"object"!=typeof d||!d||d instanceof cc.Node||d instanceof HTMLElement?c[b]=d:c[b]=cc.clone(d)}return c},
cc.inject=function(a,c){for(var b in a)c[b]=a[b]},cc.Point=function(a,c){this.x=a||0;this.y=c||0},cc.p=function(a,c){return void 0===a?{x:0,y:0}:void 0===c?{x:a.x,y:a.y}:{x:a,y:c}},cc.pointEqualToPoint=function(a,c){return a&&c&&a.x===c.x&&a.y===c.y},cc.Size=function(a,c){this.width=a||0;this.height=c||0},cc.size=function(a,c){return void 0===a?{width:0,height:0}:void 0===c?{width:a.width,height:a.height}:{width:a,height:c}},cc.sizeEqualToSize=function(a,c){return a&&c&&a.width===c.width&&a.height===
c.height},cc.Rect=function(a,c,b,d){this.x=a||0;this.y=c||0;this.width=b||0;this.height=d||0},cc.rect=function(a,c,b,d){return void 0===a?{x:0,y:0,width:0,height:0}:void 0===c?{x:a.x,y:a.y,width:a.width,height:a.height}:{x:a,y:c,width:b,height:d}},cc.rectEqualToRect=function(a,c){return a&&c&&a.x===c.x&&a.y===c.y&&a.width===c.width&&a.height===c.height},cc._rectEqualToZero=function(a){return a&&0===a.x&&0===a.y&&0===a.width&&0===a.height},cc.rectContainsRect=function(a,c){return a&&c?!(a.x>=c.x||
a.y>=c.y||a.x+a.width<=c.x+c.width||a.y+a.height<=c.y+c.height):!1},cc.rectGetMaxX=function(a){return a.x+a.width},cc.rectGetMidX=function(a){return a.x+a.width/2},cc.rectGetMinX=function(a){return a.x},cc.rectGetMaxY=function(a){return a.y+a.height},cc.rectGetMidY=function(a){return a.y+a.height/2},cc.rectGetMinY=function(a){return a.y},cc.rectContainsPoint=function(a,c){return c.x>=cc.rectGetMinX(a)&&c.x<=cc.rectGetMaxX(a)&&c.y>=cc.rectGetMinY(a)&&c.y<=cc.rectGetMaxY(a)},cc.rectIntersectsRect=function(a,
c){var b=a.y+a.height,d=c.x+c.width,e=c.y+c.height;return!(a.x+a.width<c.x||d<a.x||b<c.y||e<a.y)},cc.rectOverlapsRect=function(a,c){return!(a.x+a.width<c.x||c.x+c.width<a.x||a.y+a.height<c.y||c.y+c.height<a.y)},cc.rectUnion=function(a,c){var b=cc.rect(0,0,0,0);return b.x=Math.min(a.x,c.x),b.y=Math.min(a.y,c.y),b.width=Math.max(a.x+a.width,c.x+c.width)-b.x,b.height=Math.max(a.y+a.height,c.y+c.height)-b.y,b},cc.rectIntersection=function(a,c){var b=cc.rect(Math.max(cc.rectGetMinX(a),cc.rectGetMinX(c)),
Math.max(cc.rectGetMinY(a),cc.rectGetMinY(c)),0,0);return b.width=Math.min(cc.rectGetMaxX(a),cc.rectGetMaxX(c))-cc.rectGetMinX(b),b.height=Math.min(cc.rectGetMaxY(a),cc.rectGetMaxY(c))-cc.rectGetMinY(b),b},cc.SAXParser=cc.Class.extend({_parser:null,_isSupportDOMParser:null,ctor:function(){window.DOMParser?(this._isSupportDOMParser=!0,this._parser=new DOMParser):this._isSupportDOMParser=!1},parse:function(a){return this._parseXML(a)},_parseXML:function(a){var c;return this._isSupportDOMParser?c=this._parser.parseFromString(a,
"text/xml"):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(a)),c}}),cc.PlistParser=cc.SAXParser.extend({parse:function(a){a=this._parseXML(a).documentElement;if("plist"!==a.tagName)throw"Not a plist file!";for(var c=null,b=0,d=a.childNodes.length;d>b&&(c=a.childNodes[b],1!==c.nodeType);b++);return this._parseNode(c)},_parseNode:function(a){var c=null,b=a.tagName;if("dict"===b)c=this._parseDict(a);else if("array"===b)c=this._parseArray(a);else if("string"===b)if(1===a.childNodes.length)c=
a.firstChild.nodeValue;else for(c="",b=0;b<a.childNodes.length;b++)c+=a.childNodes[b].nodeValue;else"false"===b?c=!1:"true"===b?c=!0:"real"===b?c=parseFloat(a.firstChild.nodeValue):"integer"===b&&(c=parseInt(a.firstChild.nodeValue,10));return c},_parseArray:function(a){for(var c=[],b=0,d=a.childNodes.length;d>b;b++){var e=a.childNodes[b];1===e.nodeType&&c.push(this._parseNode(e))}return c},_parseDict:function(a){for(var c={},b=null,d=0,e=a.childNodes.length;e>d;d++){var f=a.childNodes[d];1===f.nodeType&&
("key"===f.tagName?b=f.firstChild.nodeValue:c[b]=this._parseNode(f))}return c}}),cc._txtLoader={load:function(a,c,b,d){cc.loader.loadTxt(a,d)}},cc.loader.register(["txt","xml","vsh","fsh","atlas"],cc._txtLoader),cc._jsonLoader={load:function(a,c,b,d){cc.loader.loadJson(a,d)}},cc.loader.register(["json","ExportJson"],cc._jsonLoader),cc._jsLoader={load:function(a,c,b,d){cc.loader.loadJs(a,d)}},cc.loader.register(["js"],cc._jsLoader),cc._imgLoader={load:function(a,c,b,d){cc.loader.cache[c]=cc.loader.loadImg(a,
function(a,b){return a?d(a):(cc.textureCache.handleLoadedTexture(c),void d(null,b))})}},cc.loader.register("png jpg bmp jpeg gif ico".split(" "),cc._imgLoader),cc._serverImgLoader={load:function(a,c,b,d){cc.loader.cache[c]=cc.loader.loadImg(b.src,function(a,b){return a?d(a):(cc.textureCache.handleLoadedTexture(c),void d(null,b))})}},cc.loader.register(["serverImg"],cc._serverImgLoader),cc._plistLoader={load:function(a,c,b,d){cc.loader.loadTxt(a,function(a,c){return a?d(a):void d(null,cc.plistParser.parse(c))})}},
cc.loader.register(["plist"],cc._plistLoader),cc._fontLoader={TYPE:{".eot":"embedded-opentype",".ttf":"truetype",".woff":"woff",".svg":"svg"},_loadFont:function(a,c,b){var d=document,e=cc.path,f=this.TYPE,g=cc.newElement("style");g.type="text/css";d.body.appendChild(g);var h="@font-face { font-family:"+a+"; src:";if(c instanceof Array)for(var k=0,m=c.length;m>k;k++)b=e.extname(c[k]).toLowerCase(),h+="url('"+c[k]+"') format('"+f[b]+"')",h+=k===m-1?";":",";else h+="url('"+c+"') format('"+f[b]+"');";
g.textContent+=h+"};";c=cc.newElement("div");b=c.style;b.fontFamily=a;c.innerHTML=".";b.position="absolute";b.left="-100px";b.top="-100px";d.body.appendChild(c)},load:function(a,c,b,d){a=b.type;c=b.name;var e=b.srcs;cc.isString(b)?(a=cc.path.extname(b),c=cc.path.basename(b,a),this._loadFont(c,b,a)):this._loadFont(c,e);d(null,!0)}},cc.loader.register(["font","eot","ttf","woff","svg"],cc._fontLoader),cc._binaryLoader={load:function(a,c,b,d){cc.loader.loadBinary(a,d)}},cc._csbLoader={load:function(a,
c,b,d){cc.loader.loadCsb(a,d)}},cc.loader.register(["csb"],cc._csbLoader),window.CocosEngine=cc.ENGINE_VERSION="Cocos2d-JS v3.6",cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL=0,cc.DIRECTOR_STATS_POSITION=cc.p(0,0),cc.DIRECTOR_FPS_INTERVAL=.5,cc.COCOSNODE_RENDER_SUBPIXEL=1,cc.SPRITEBATCHNODE_RENDER_SUBPIXEL=1,cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA=0,cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP=0,cc.TEXTURE_ATLAS_USE_VAO=0,cc.TEXTURE_NPOT_SUPPORT=0,cc.RETINA_DISPLAY_SUPPORT=1,cc.RETINA_DISPLAY_FILENAME_SUFFIX=
"-hd",cc.USE_LA88_LABELS=1,cc.SPRITE_DEBUG_DRAW=0,cc.SPRITEBATCHNODE_DEBUG_DRAW=0,cc.LABELBMFONT_DEBUG_DRAW=0,cc.LABELATLAS_DEBUG_DRAW=0,cc.IS_RETINA_DISPLAY_SUPPORTED=1,cc.DEFAULT_ENGINE=cc.ENGINE_VERSION+"-canvas",cc.ENABLE_STACKABLE_ACTIONS=1,cc.ENABLE_GL_STATE_CACHE=1,cc.$=function(a){var c=this===cc?document:this;a=a instanceof HTMLElement?a:c.querySelector(a);return a&&(a.find=a.find||cc.$,a.hasClass=a.hasClass||function(a){return this.className.match(new RegExp("(\\s|^)"+a+"(\\s|$)"))},a.addClass=
a.addClass||function(a){return this.hasClass(a)||(this.className&&(this.className+=" "),this.className+=a),this},a.removeClass=a.removeClass||function(a){return this.hasClass(a)&&(this.className=this.className.replace(a,"")),this},a.remove=a.remove||function(){return this.parentNode&&this.parentNode.removeChild(this),this},a.appendTo=a.appendTo||function(a){return a.appendChild(this),this},a.prependTo=a.prependTo||function(a){return a.childNodes[0]?a.insertBefore(this,a.childNodes[0]):a.appendChild(this),
this},a.transforms=a.transforms||function(){return this.style[cc.$.trans]=cc.$.translate(this.position)+cc.$.rotate(this.rotation)+cc.$.scale(this.scale)+cc.$.skew(this.skew),this},a.position=a.position||{x:0,y:0},a.rotation=a.rotation||0,a.scale=a.scale||{x:1,y:1},a.skew=a.skew||{x:0,y:0},a.translates=function(a,c){return this.position.x=a,this.position.y=c,this.transforms(),this},a.rotate=function(a){return this.rotation=a,this.transforms(),this},a.resize=function(a,c){return this.scale.x=a,this.scale.y=
c,this.transforms(),this},a.setSkew=function(a,c){return this.skew.x=a,this.skew.y=c,this.transforms(),this}),a},cc.sys.browserType){case cc.sys.BROWSER_TYPE_FIREFOX:cc.$.pfx="Moz";cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_CHROME:case cc.sys.BROWSER_TYPE_SAFARI:cc.$.pfx="webkit";cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_OPERA:cc.$.pfx="O";cc.$.hd=!1;break;case cc.sys.BROWSER_TYPE_IE:cc.$.pfx="ms";cc.$.hd=!1;break;default:cc.$.pfx="webkit",cc.$.hd=!0}cc.$.trans=cc.$.pfx+"Transform";
cc.$.translate=cc.$.hd?function(a){return"translate3d("+a.x+"px, "+a.y+"px, 0) "}:function(a){return"translate("+a.x+"px, "+a.y+"px) "};cc.$.rotate=cc.$.hd?function(a){return"rotateZ("+a+"deg) "}:function(a){return"rotate("+a+"deg) "};cc.$.scale=function(a){return"scale("+a.x+", "+a.y+") "};cc.$.skew=function(a){return"skewX("+-a.x+"deg) skewY("+a.y+"deg)"};cc.$new=function(a){return cc.$(document.createElement(a))};
cc.$.findpos=function(a){var c=0,b=0;do c+=a.offsetLeft,b+=a.offsetTop;while(a=a.offsetParent);return{x:c,y:b}};cc.INVALID_INDEX=-1;cc.PI=Math.PI;cc.FLT_MAX=parseFloat("3.402823466e+38F");cc.FLT_MIN=parseFloat("1.175494351e-38F");cc.RAD=cc.PI/180;cc.DEG=180/cc.PI;cc.UINT_MAX=4294967295;cc.swap=function(a,c,b){if(!cc.isObject(b)||cc.isUndefined(b.x)||cc.isUndefined(b.y))cc.log(cc._LogInfos.swap);else{var d=b[a];b[a]=b[c];b[c]=d}};cc.lerp=function(a,c,b){return a+(c-a)*b};
cc.rand=function(){return 16777215*Math.random()};cc.randomMinus1To1=function(){return 2*(Math.random()-.5)};cc.random0To1=Math.random;cc.degreesToRadians=function(a){return a*cc.RAD};cc.radiansToDegrees=function(a){return a*cc.DEG};cc.radiansToDegress=function(a){return cc.log(cc._LogInfos.radiansToDegress),a*cc.DEG};cc.REPEAT_FOREVER=Number.MAX_VALUE-1;cc.BLEND_SRC=cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA?1:770;cc.BLEND_DST=771;
cc.nodeDrawSetup=function(a){a._shaderProgram&&(a._shaderProgram.use(),a._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4())};cc.enableDefaultGLStates=function(){};cc.disableDefaultGLStates=function(){};cc.incrementGLDraws=function(a){cc.g_NumberOfDraws+=a};cc.FLT_EPSILON=1.192092896E-7;cc.contentScaleFactor=cc.IS_RETINA_DISPLAY_SUPPORTED?function(){return cc.director.getContentScaleFactor()}:function(){return 1};
cc.pointPointsToPixels=function(a){var c=cc.contentScaleFactor();return cc.p(a.x*c,a.y*c)};cc.pointPixelsToPoints=function(a){var c=cc.contentScaleFactor();return cc.p(a.x/c,a.y/c)};cc._pointPixelsToPointsOut=function(a,c){var b=cc.contentScaleFactor();c.x=a.x/b;c.y=a.y/b};cc.sizePointsToPixels=function(a){var c=cc.contentScaleFactor();return cc.size(a.width*c,a.height*c)};cc.sizePixelsToPoints=function(a){var c=cc.contentScaleFactor();return cc.size(a.width/c,a.height/c)};
cc._sizePixelsToPointsOut=function(a,c){var b=cc.contentScaleFactor();c.width=a.width/b;c.height=a.height/b};cc.rectPixelsToPoints=cc.IS_RETINA_DISPLAY_SUPPORTED?function(a){var c=cc.contentScaleFactor();return cc.rect(a.x/c,a.y/c,a.width/c,a.height/c)}:function(a){return a};cc.rectPointsToPixels=cc.IS_RETINA_DISPLAY_SUPPORTED?function(a){var c=cc.contentScaleFactor();return cc.rect(a.x*c,a.y*c,a.width*c,a.height*c)}:function(a){return a};cc.ONE=1;cc.ZERO=0;cc.SRC_ALPHA=770;
cc.SRC_ALPHA_SATURATE=776;cc.SRC_COLOR=768;cc.DST_ALPHA=772;cc.DST_COLOR=774;cc.ONE_MINUS_SRC_ALPHA=771;cc.ONE_MINUS_SRC_COLOR=769;cc.ONE_MINUS_DST_ALPHA=773;cc.ONE_MINUS_DST_COLOR=775;cc.ONE_MINUS_CONSTANT_ALPHA=32772;cc.ONE_MINUS_CONSTANT_COLOR=32770;cc.LINEAR=9729;cc.REPEAT=10497;cc.CLAMP_TO_EDGE=33071;cc.MIRRORED_REPEAT=33648;cc.checkGLErrorDebug=function(){if(cc.renderMode===cc._RENDER_TYPE_WEBGL){var a=cc._renderContext.getError();a&&cc.log(cc._LogInfos.checkGLErrorDebug,a)}};
cc.DEVICE_ORIENTATION_PORTRAIT=0;cc.DEVICE_ORIENTATION_LANDSCAPE_LEFT=1;cc.DEVICE_ORIENTATION_PORTRAIT_UPSIDE_DOWN=2;cc.DEVICE_ORIENTATION_LANDSCAPE_RIGHT=3;cc.DEVICE_MAX_ORIENTATIONS=2;cc.VERTEX_ATTRIB_FLAG_NONE=0;cc.VERTEX_ATTRIB_FLAG_POSITION=1;cc.VERTEX_ATTRIB_FLAG_COLOR=2;cc.VERTEX_ATTRIB_FLAG_TEX_COORDS=4;cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX=cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_COLOR|cc.VERTEX_ATTRIB_FLAG_TEX_COORDS;cc.GL_ALL=0;cc.VERTEX_ATTRIB_POSITION=0;
cc.VERTEX_ATTRIB_COLOR=1;cc.VERTEX_ATTRIB_TEX_COORDS=2;cc.VERTEX_ATTRIB_MAX=3;cc.UNIFORM_PMATRIX=0;cc.UNIFORM_MVMATRIX=1;cc.UNIFORM_MVPMATRIX=2;cc.UNIFORM_TIME=3;cc.UNIFORM_SINTIME=4;cc.UNIFORM_COSTIME=5;cc.UNIFORM_RANDOM01=6;cc.UNIFORM_SAMPLER=7;cc.UNIFORM_MAX=8;cc.SHADER_POSITION_TEXTURECOLOR="ShaderPositionTextureColor";cc.SHADER_POSITION_TEXTURECOLORALPHATEST="ShaderPositionTextureColorAlphaTest";cc.SHADER_POSITION_COLOR="ShaderPositionColor";cc.SHADER_POSITION_TEXTURE="ShaderPositionTexture";
cc.SHADER_POSITION_TEXTURE_UCOLOR="ShaderPositionTexture_uColor";cc.SHADER_POSITION_TEXTUREA8COLOR="ShaderPositionTextureA8Color";cc.SHADER_POSITION_UCOLOR="ShaderPosition_uColor";cc.SHADER_POSITION_LENGTHTEXTURECOLOR="ShaderPositionLengthTextureColor";cc.UNIFORM_PMATRIX_S="CC_PMatrix";cc.UNIFORM_MVMATRIX_S="CC_MVMatrix";cc.UNIFORM_MVPMATRIX_S="CC_MVPMatrix";cc.UNIFORM_TIME_S="CC_Time";cc.UNIFORM_SINTIME_S="CC_SinTime";cc.UNIFORM_COSTIME_S="CC_CosTime";cc.UNIFORM_RANDOM01_S="CC_Random01";
cc.UNIFORM_SAMPLER_S="CC_Texture0";cc.UNIFORM_ALPHA_TEST_VALUE_S="CC_alpha_value";cc.ATTRIBUTE_NAME_COLOR="a_color";cc.ATTRIBUTE_NAME_POSITION="a_position";cc.ATTRIBUTE_NAME_TEX_COORD="a_texCoord";cc.ITEM_SIZE=32;cc.CURRENT_ITEM=3233828865;cc.ZOOM_ACTION_TAG=3233828866;cc.NORMAL_TAG=8801;cc.SELECTED_TAG=8802;cc.DISABLE_TAG=8803;cc.arrayVerifyType=function(a,c){if(a&&0<a.length)for(var b=0;b<a.length;b++)if(!(a[b]instanceof c))return cc.log("element type is wrong!"),!1;return!0};
cc.arrayRemoveObject=function(a,c){for(var b=0,d=a.length;d>b;b++)if(a[b]===c){a.splice(b,1);break}};cc.arrayRemoveArray=function(a,c){for(var b=0,d=c.length;d>b;b++)cc.arrayRemoveObject(a,c[b])};cc.arrayAppendObjectsToIndex=function(a,c,b){return a.splice.apply(a,[b,0].concat(c)),a};cc.copyArray=function(a){var c,b=a.length,d=Array(b);for(c=0;b>c;c+=1)d[c]=a[c];return d};
cc._tmp.PrototypeColor=function(){var a=cc.color;a._getWhite=function(){return a(255,255,255)};a._getYellow=function(){return a(255,255,0)};a._getBlue=function(){return a(0,0,255)};a._getGreen=function(){return a(0,255,0)};a._getRed=function(){return a(255,0,0)};a._getMagenta=function(){return a(255,0,255)};a._getBlack=function(){return a(0,0,0)};a._getOrange=function(){return a(255,127,0)};a._getGray=function(){return a(166,166,166)};a.WHITE;cc.defineGetterSetter(a,"WHITE",a._getWhite);a.YELLOW;
cc.defineGetterSetter(a,"YELLOW",a._getYellow);a.BLUE;cc.defineGetterSetter(a,"BLUE",a._getBlue);a.GREEN;cc.defineGetterSetter(a,"GREEN",a._getGreen);a.RED;cc.defineGetterSetter(a,"RED",a._getRed);a.MAGENTA;cc.defineGetterSetter(a,"MAGENTA",a._getMagenta);a.BLACK;cc.defineGetterSetter(a,"BLACK",a._getBlack);a.ORANGE;cc.defineGetterSetter(a,"ORANGE",a._getOrange);a.GRAY;cc.defineGetterSetter(a,"GRAY",a._getGray);cc.BlendFunc._disable=function(){return new cc.BlendFunc(cc.ONE,cc.ZERO)};cc.BlendFunc._alphaPremultiplied=
function(){return new cc.BlendFunc(cc.ONE,cc.ONE_MINUS_SRC_ALPHA)};cc.BlendFunc._alphaNonPremultiplied=function(){return new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA)};cc.BlendFunc._additive=function(){return new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE)};cc.BlendFunc.DISABLE;cc.defineGetterSetter(cc.BlendFunc,"DISABLE",cc.BlendFunc._disable);cc.BlendFunc.ALPHA_PREMULTIPLIED;cc.defineGetterSetter(cc.BlendFunc,"ALPHA_PREMULTIPLIED",cc.BlendFunc._alphaPremultiplied);cc.BlendFunc.ALPHA_NON_PREMULTIPLIED;
cc.defineGetterSetter(cc.BlendFunc,"ALPHA_NON_PREMULTIPLIED",cc.BlendFunc._alphaNonPremultiplied);cc.BlendFunc.ADDITIVE;cc.defineGetterSetter(cc.BlendFunc,"ADDITIVE",cc.BlendFunc._additive)};cc=cc||{};
switch(cc._tmp=cc._tmp||{},cc._tmp.WebGLColor=function(){cc.color=function(a,b,d,e,f,g){return void 0===a?new cc.Color(0,0,0,255,f,g):cc.isString(a)?(a=cc.hexToColor(a),new cc.Color(a.r,a.g,a.b,a.a)):cc.isObject(a)?new cc.Color(a.r,a.g,a.b,a.a,a.arrayBuffer,a.offset):new cc.Color(a,b,d,e,f,g)};cc.Color=function(a,b,d,e,f,g){this._arrayBuffer=f||new ArrayBuffer(cc.Color.BYTES_PER_ELEMENT);this._offset=g||0;f=this._arrayBuffer;g=this._offset;var h=Uint8Array.BYTES_PER_ELEMENT;this._rU8=new Uint8Array(f,
g,1);this._gU8=new Uint8Array(f,g+h,1);this._bU8=new Uint8Array(f,g+2*h,1);this._aU8=new Uint8Array(f,g+3*h,1);this._rU8[0]=a||0;this._gU8[0]=b||0;this._bU8[0]=d||0;this._aU8[0]=null==e?255:e;void 0===e&&(this.a_undefined=!0)};cc.Color.BYTES_PER_ELEMENT=4;var a=cc.Color.prototype;a._getR=function(){return this._rU8[0]};a._setR=function(a){this._rU8[0]=0>a?0:a};a._getG=function(){return this._gU8[0]};a._setG=function(a){this._gU8[0]=0>a?0:a};a._getB=function(){return this._bU8[0]};a._setB=function(a){this._bU8[0]=
0>a?0:a};a._getA=function(){return this._aU8[0]};a._setA=function(a){this._aU8[0]=0>a?0:a};a.r;cc.defineGetterSetter(a,"r",a._getR,a._setR);a.g;cc.defineGetterSetter(a,"g",a._getG,a._setG);a.b;cc.defineGetterSetter(a,"b",a._getB,a._setB);a.a;cc.defineGetterSetter(a,"a",a._getA,a._setA);cc.Vertex2F=function(a,b,d,e){this._arrayBuffer=d||new ArrayBuffer(cc.Vertex2F.BYTES_PER_ELEMENT);this._offset=e||0;this._xF32=new Float32Array(this._arrayBuffer,this._offset,1);this._yF32=new Float32Array(this._arrayBuffer,
this._offset+4,1);this._xF32[0]=a||0;this._yF32[0]=b||0};cc.Vertex2F.BYTES_PER_ELEMENT=8;a=cc.Vertex2F.prototype;a._getX=function(){return this._xF32[0]};a._setX=function(a){this._xF32[0]=a};a._getY=function(){return this._yF32[0]};a._setY=function(a){this._yF32[0]=a};a.x;cc.defineGetterSetter(a,"x",a._getX,a._setX);a.y;cc.defineGetterSetter(a,"y",a._getY,a._setY);cc.Vertex3F=function(a,b,d,e,f){this._arrayBuffer=e||new ArrayBuffer(cc.Vertex3F.BYTES_PER_ELEMENT);this._offset=f||0;e=this._arrayBuffer;
f=this._offset;this._xF32=new Float32Array(e,f,1);this._xF32[0]=a||0;this._yF32=new Float32Array(e,f+Float32Array.BYTES_PER_ELEMENT,1);this._yF32[0]=b||0;this._zF32=new Float32Array(e,f+2*Float32Array.BYTES_PER_ELEMENT,1);this._zF32[0]=d||0};cc.Vertex3F.BYTES_PER_ELEMENT=12;a=cc.Vertex3F.prototype;a._getX=function(){return this._xF32[0]};a._setX=function(a){this._xF32[0]=a};a._getY=function(){return this._yF32[0]};a._setY=function(a){this._yF32[0]=a};a._getZ=function(){return this._zF32[0]};a._setZ=
function(a){this._zF32[0]=a};a.x;cc.defineGetterSetter(a,"x",a._getX,a._setX);a.y;cc.defineGetterSetter(a,"y",a._getY,a._setY);a.z;cc.defineGetterSetter(a,"z",a._getZ,a._setZ);cc.Tex2F=function(a,b,d,e){this._arrayBuffer=d||new ArrayBuffer(cc.Tex2F.BYTES_PER_ELEMENT);this._offset=e||0;this._uF32=new Float32Array(this._arrayBuffer,this._offset,1);this._vF32=new Float32Array(this._arrayBuffer,this._offset+4,1);this._uF32[0]=a||0;this._vF32[0]=b||0};cc.Tex2F.BYTES_PER_ELEMENT=8;a=cc.Tex2F.prototype;
a._getU=function(){return this._uF32[0]};a._setU=function(a){this._uF32[0]=a};a._getV=function(){return this._vF32[0]};a._setV=function(a){this._vF32[0]=a};a.u;cc.defineGetterSetter(a,"u",a._getU,a._setU);a.v;cc.defineGetterSetter(a,"v",a._getV,a._setV);cc.Quad2=function(a,b,d,e,f,g){this._arrayBuffer=f||new ArrayBuffer(cc.Quad2.BYTES_PER_ELEMENT);this._offset=g||0;f=this._arrayBuffer;g=cc.Vertex2F.BYTES_PER_ELEMENT;this._tl=a?new cc.Vertex2F(a.x,a.y,f,0):new cc.Vertex2F(0,0,f,0);this._tr=b?new cc.Vertex2F(b.x,
b.y,f,g):new cc.Vertex2F(0,0,f,g);this._bl=d?new cc.Vertex2F(d.x,d.y,f,2*g):new cc.Vertex2F(0,0,f,2*g);this._br=e?new cc.Vertex2F(e.x,e.y,f,3*g):new cc.Vertex2F(0,0,f,3*g)};cc.Quad2.BYTES_PER_ELEMENT=32;a=cc.Quad2.prototype;a._getTL=function(){return this._tl};a._setTL=function(a){this._tl.x=a.x;this._tl.y=a.y};a._getTR=function(){return this._tr};a._setTR=function(a){this._tr.x=a.x;this._tr.y=a.y};a._getBL=function(){return this._bl};a._setBL=function(a){this._bl.x=a.x;this._bl.y=a.y};a._getBR=function(){return this._br};
a._setBR=function(a){this._br.x=a.x;this._br.y=a.y};a.tl;cc.defineGetterSetter(a,"tl",a._getTL,a._setTL);a.tr;cc.defineGetterSetter(a,"tr",a._getTR,a._setTR);a.bl;cc.defineGetterSetter(a,"bl",a._getBL,a._setBL);a.br;cc.defineGetterSetter(a,"br",a._getBR,a._setBR);cc.Quad3=function(a,b,d,e){this.bl=a||new cc.Vertex3F(0,0,0);this.br=b||new cc.Vertex3F(0,0,0);this.tl=d||new cc.Vertex3F(0,0,0);this.tr=e||new cc.Vertex3F(0,0,0)};cc.V3F_C4B_T2F=function(a,b,d,e,f){this._arrayBuffer=e||new ArrayBuffer(cc.V3F_C4B_T2F.BYTES_PER_ELEMENT);
this._offset=f||0;e=this._arrayBuffer;f=this._offset;var g=cc.Vertex3F.BYTES_PER_ELEMENT;this._vertices=a?new cc.Vertex3F(a.x,a.y,a.z,e,f):new cc.Vertex3F(0,0,0,e,f);this._colors=b?cc.color(b.r,b.g,b.b,b.a,e,f+g):cc.color(0,0,0,0,e,f+g);this._texCoords=d?new cc.Tex2F(d.u,d.v,e,f+g+cc.Color.BYTES_PER_ELEMENT):new cc.Tex2F(0,0,e,f+g+cc.Color.BYTES_PER_ELEMENT)};cc.V3F_C4B_T2F.BYTES_PER_ELEMENT=24;a=cc.V3F_C4B_T2F.prototype;a._getVertices=function(){return this._vertices};a._setVertices=function(a){var b=
this._vertices;b.x=a.x;b.y=a.y;b.z=a.z};a._getColor=function(){return this._colors};a._setColor=function(a){var b=this._colors;b.r=a.r;b.g=a.g;b.b=a.b;b.a=a.a};a._getTexCoords=function(){return this._texCoords};a._setTexCoords=function(a){this._texCoords.u=a.u;this._texCoords.v=a.v};a.vertices;cc.defineGetterSetter(a,"vertices",a._getVertices,a._setVertices);a.colors;cc.defineGetterSetter(a,"colors",a._getColor,a._setColor);a.texCoords;cc.defineGetterSetter(a,"texCoords",a._getTexCoords,a._setTexCoords);
cc.V3F_C4B_T2F_Quad=function(a,b,d,e,f,g){this._arrayBuffer=f||new ArrayBuffer(cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT);this._offset=g||0;f=this._arrayBuffer;g=this._offset;var h=cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;this._tl=a?new cc.V3F_C4B_T2F(a.vertices,a.colors,a.texCoords,f,g):new cc.V3F_C4B_T2F(null,null,null,f,g);this._bl=b?new cc.V3F_C4B_T2F(b.vertices,b.colors,b.texCoords,f,g+h):new cc.V3F_C4B_T2F(null,null,null,f,g+h);this._tr=d?new cc.V3F_C4B_T2F(d.vertices,d.colors,d.texCoords,f,g+2*h):new cc.V3F_C4B_T2F(null,
null,null,f,g+2*h);this._br=e?new cc.V3F_C4B_T2F(e.vertices,e.colors,e.texCoords,f,g+3*h):new cc.V3F_C4B_T2F(null,null,null,f,g+3*h)};cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT=96;a=cc.V3F_C4B_T2F_Quad.prototype;a._getTL=function(){return this._tl};a._setTL=function(a){var b=this._tl;b.vertices=a.vertices;b.colors=a.colors;b.texCoords=a.texCoords};a._getBL=function(){return this._bl};a._setBL=function(a){var b=this._bl;b.vertices=a.vertices;b.colors=a.colors;b.texCoords=a.texCoords};a._getTR=function(){return this._tr};
a._setTR=function(a){var b=this._tr;b.vertices=a.vertices;b.colors=a.colors;b.texCoords=a.texCoords};a._getBR=function(){return this._br};a._setBR=function(a){var b=this._br;b.vertices=a.vertices;b.colors=a.colors;b.texCoords=a.texCoords};a._getArrayBuffer=function(){return this._arrayBuffer};a.tl;cc.defineGetterSetter(a,"tl",a._getTL,a._setTL);a.tr;cc.defineGetterSetter(a,"tr",a._getTR,a._setTR);a.bl;cc.defineGetterSetter(a,"bl",a._getBL,a._setBL);a.br;cc.defineGetterSetter(a,"br",a._getBR,a._setBR);
a.arrayBuffer;cc.defineGetterSetter(a,"arrayBuffer",a._getArrayBuffer,null);cc.V3F_C4B_T2F_QuadZero=function(){return new cc.V3F_C4B_T2F_Quad};cc.V3F_C4B_T2F_QuadCopy=function(a){if(!a)return cc.V3F_C4B_T2F_QuadZero();var b=a.tl,d=a.bl,e=a.tr;a=a.br;return{tl:{vertices:{x:b.vertices.x,y:b.vertices.y,z:b.vertices.z},colors:{r:b.colors.r,g:b.colors.g,b:b.colors.b,a:b.colors.a},texCoords:{u:b.texCoords.u,v:b.texCoords.v}},bl:{vertices:{x:d.vertices.x,y:d.vertices.y,z:d.vertices.z},colors:{r:d.colors.r,
g:d.colors.g,b:d.colors.b,a:d.colors.a},texCoords:{u:d.texCoords.u,v:d.texCoords.v}},tr:{vertices:{x:e.vertices.x,y:e.vertices.y,z:e.vertices.z},colors:{r:e.colors.r,g:e.colors.g,b:e.colors.b,a:e.colors.a},texCoords:{u:e.texCoords.u,v:e.texCoords.v}},br:{vertices:{x:a.vertices.x,y:a.vertices.y,z:a.vertices.z},colors:{r:a.colors.r,g:a.colors.g,b:a.colors.b,a:a.colors.a},texCoords:{u:a.texCoords.u,v:a.texCoords.v}}}};cc.V3F_C4B_T2F_QuadsCopy=function(a){if(!a)return[];for(var b=[],d=0;d<a.length;d++)b.push(cc.V3F_C4B_T2F_QuadCopy(a[d]));
return b};cc.V2F_C4B_T2F=function(a,b,d,e,f){this._arrayBuffer=e||new ArrayBuffer(cc.V2F_C4B_T2F.BYTES_PER_ELEMENT);this._offset=f||0;e=this._arrayBuffer;f=this._offset;var g=cc.Vertex2F.BYTES_PER_ELEMENT;this._vertices=a?new cc.Vertex2F(a.x,a.y,e,f):new cc.Vertex2F(0,0,e,f);this._colors=b?cc.color(b.r,b.g,b.b,b.a,e,f+g):cc.color(0,0,0,0,e,f+g);this._texCoords=d?new cc.Tex2F(d.u,d.v,e,f+g+cc.Color.BYTES_PER_ELEMENT):new cc.Tex2F(0,0,e,f+g+cc.Color.BYTES_PER_ELEMENT)};cc.V2F_C4B_T2F.BYTES_PER_ELEMENT=
20;a=cc.V2F_C4B_T2F.prototype;a._getVertices=function(){return this._vertices};a._setVertices=function(a){this._vertices.x=a.x;this._vertices.y=a.y};a._getColor=function(){return this._colors};a._setColor=function(a){var b=this._colors;b.r=a.r;b.g=a.g;b.b=a.b;b.a=a.a};a._getTexCoords=function(){return this._texCoords};a._setTexCoords=function(a){this._texCoords.u=a.u;this._texCoords.v=a.v};a.vertices;cc.defineGetterSetter(a,"vertices",a._getVertices,a._setVertices);a.colors;cc.defineGetterSetter(a,
"colors",a._getColor,a._setColor);a.texCoords;cc.defineGetterSetter(a,"texCoords",a._getTexCoords,a._setTexCoords);cc.V2F_C4B_T2F_Triangle=function(a,b,d,e,f){this._arrayBuffer=e||new ArrayBuffer(cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT);this._offset=f||0;e=this._arrayBuffer;f=this._offset;var g=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;this._a=a?new cc.V2F_C4B_T2F(a.vertices,a.colors,a.texCoords,e,f):new cc.V2F_C4B_T2F(null,null,null,e,f);this._b=b?new cc.V2F_C4B_T2F(b.vertices,b.colors,b.texCoords,e,f+
g):new cc.V2F_C4B_T2F(null,null,null,e,f+g);this._c=d?new cc.V2F_C4B_T2F(d.vertices,d.colors,d.texCoords,e,f+2*g):new cc.V2F_C4B_T2F(null,null,null,e,f+2*g)};cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT=60;a=cc.V2F_C4B_T2F_Triangle.prototype;a._getA=function(){return this._a};a._setA=function(a){var b=this._a;b.vertices=a.vertices;b.colors=a.colors;b.texCoords=a.texCoords};a._getB=function(){return this._b};a._setB=function(a){var b=this._b;b.vertices=a.vertices;b.colors=a.colors;b.texCoords=a.texCoords};
a._getC=function(){return this._c};a._setC=function(a){var b=this._c;b.vertices=a.vertices;b.colors=a.colors;b.texCoords=a.texCoords};a.a;cc.defineGetterSetter(a,"a",a._getA,a._setA);a.b;cc.defineGetterSetter(a,"b",a._getB,a._setB);a.c;cc.defineGetterSetter(a,"c",a._getC,a._setC)},cc.Color=function(a,c,b,d){this.r=a||0;this.g=c||0;this.b=b||0;this.a=null==d?255:d},cc.color=function(a,c,b,d){return void 0===a?{r:0,g:0,b:0,a:255}:cc.isString(a)?cc.hexToColor(a):cc.isObject(a)?{r:a.r,g:a.g,b:a.b,a:null==
a.a?255:a.a}:{r:a,g:c,b:b,a:null==d?255:d}},cc.colorEqual=function(a,c){return a.r===c.r&&a.g===c.g&&a.b===c.b},cc.Acceleration=function(a,c,b,d){this.x=a||0;this.y=c||0;this.z=b||0;this.timestamp=d||0},cc.Vertex2F=function(a,c){this.x=a||0;this.y=c||0},cc.vertex2=function(a,c){return new cc.Vertex2F(a,c)},cc.Vertex3F=function(a,c,b){this.x=a||0;this.y=c||0;this.z=b||0},cc.vertex3=function(a,c,b){return new cc.Vertex3F(a,c,b)},cc.Tex2F=function(a,c){this.u=a||0;this.v=c||0},cc.tex2=function(a,c){return new cc.Tex2F(a,
c)},cc.BlendFunc=function(a,c){this.src=a;this.dst=c},cc.blendFuncDisable=function(){return new cc.BlendFunc(cc.ONE,cc.ZERO)},cc.hexToColor=function(a){a=a.replace(/^#?/,"0x");a=parseInt(a);return cc.color(a>>16,(a>>8)%256,a%256)},cc.colorToHex=function(a){var c=a.r.toString(16),b=a.g.toString(16),d=a.b.toString(16);return"#"+(16>a.r?"0"+c:c)+(16>a.g?"0"+b:b)+(16>a.b?"0"+d:d)},cc.TEXT_ALIGNMENT_LEFT=0,cc.TEXT_ALIGNMENT_CENTER=1,cc.TEXT_ALIGNMENT_RIGHT=2,cc.VERTICAL_TEXT_ALIGNMENT_TOP=0,cc.VERTICAL_TEXT_ALIGNMENT_CENTER=
1,cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM=2,cc._Dictionary=cc.Class.extend({_keyMapTb:null,_valueMapTb:null,__currId:0,ctor:function(){this._keyMapTb={};this._valueMapTb={};this.__currId=2<<(0|10*Math.random())},__getKey:function(){return this.__currId++,"key_"+this.__currId},setObject:function(a,c){if(null!=c){var b=this.__getKey();this._keyMapTb[b]=c;this._valueMapTb[b]=a}},objectForKey:function(a){if(null==a)return null;var c=this._keyMapTb,b;for(b in c)if(c[b]===a)return this._valueMapTb[b];return null},
valueForKey:function(a){return this.objectForKey(a)},removeObjectForKey:function(a){if(null!=a){var c=this._keyMapTb,b;for(b in c)if(c[b]===a)return delete this._valueMapTb[b],void delete c[b]}},removeObjectsForKeys:function(a){if(null!=a)for(var c=0;c<a.length;c++)this.removeObjectForKey(a[c])},allKeys:function(){var a=[],c=this._keyMapTb,b;for(b in c)a.push(c[b]);return a},removeAllObjects:function(){this._keyMapTb={};this._valueMapTb={}},count:function(){return this.allKeys().length}}),cc.FontDefinition=
function(a){if(this.fontName="Arial",this.fontSize=12,this.textAlign=cc.TEXT_ALIGNMENT_CENTER,this.verticalAlign=cc.VERTICAL_TEXT_ALIGNMENT_TOP,this.fillStyle=cc.color(255,255,255,255),this.boundingWidth=0,this.boundingHeight=0,this.strokeEnabled=!1,this.strokeStyle=cc.color(255,255,255,255),this.lineWidth=1,this.lineHeight="normal",this.fontStyle="normal",this.fontWeight="normal",this.shadowEnabled=!1,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0,this.shadowOpacity=1,a&&a instanceof
Object)for(var c in a)this[c]=a[c]},cc.FontDefinition.prototype._getCanvasFontStr=function(){return this.fontStyle+" "+this.fontWeight+" "+this.fontSize+"px/"+(this.lineHeight.charAt?this.lineHeight:this.lineHeight+"px")+" '"+this.fontName+"'"},cc._renderType===cc._RENDER_TYPE_WEBGL&&(cc.assert(cc.isFunction(cc._tmp.WebGLColor),cc._LogInfos.MissingFile,"CCTypesWebGL.js"),cc._tmp.WebGLColor(),delete cc._tmp.WebGLColor),cc.assert(cc.isFunction(cc._tmp.PrototypeColor),cc._LogInfos.MissingFile,"CCTypesPropertyDefine.js"),
cc._tmp.PrototypeColor(),delete cc._tmp.PrototypeColor,cc.Touches=[],cc.TouchesIntergerDict={},cc.DENSITYDPI_DEVICE="device-dpi",cc.DENSITYDPI_HIGH="high-dpi",cc.DENSITYDPI_MEDIUM="medium-dpi",cc.DENSITYDPI_LOW="low-dpi",cc.__BrowserGetter={init:function(){this.html=document.getElementsByTagName("html")[0]},availWidth:function(a){return a&&a!==this.html?a.clientWidth:window.innerWidth},availHeight:function(a){return a&&a!==this.html?a.clientHeight:window.innerHeight},meta:{width:"device-width","user-scalable":"no"},
adaptationType:cc.sys.browserType},-1<window.navigator.userAgent.indexOf("OS 8_1_")&&(cc.__BrowserGetter.adaptationType=cc.sys.BROWSER_TYPE_MIUI),cc.sys.os===cc.sys.OS_IOS&&(cc.__BrowserGetter.adaptationType=cc.sys.BROWSER_TYPE_SAFARI),cc.__BrowserGetter.adaptationType){case cc.sys.BROWSER_TYPE_SAFARI:cc.__BrowserGetter.meta["minimal-ui"]="true";cc.__BrowserGetter.availWidth=function(a){return a.clientWidth};cc.__BrowserGetter.availHeight=function(a){return a.clientHeight};break;case cc.sys.BROWSER_TYPE_CHROME:cc.__BrowserGetter.__defineGetter__("target-densitydpi",
function(){return cc.view._targetDensityDPI});case cc.sys.BROWSER_TYPE_SOUGOU:case cc.sys.BROWSER_TYPE_UC:cc.__BrowserGetter.availWidth=function(a){return a.clientWidth};cc.__BrowserGetter.availHeight=function(a){return a.clientHeight};break;case cc.sys.BROWSER_TYPE_MIUI:cc.__BrowserGetter.init=function(a){if(!a.__resizeWithBrowserSize){var c=function(){a.setDesignResolutionSize(a._designResolutionSize.width,a._designResolutionSize.height,a._resolutionPolicy);window.removeEventListener("resize",c,
!1)};window.addEventListener("resize",c,!1)}}}
if(cc.EGLView=cc.Class.extend({_delegate:null,_frameSize:null,_designResolutionSize:null,_originalDesignResolutionSize:null,_viewPortRect:null,_visibleRect:null,_retinaEnabled:!1,_autoFullScreen:!0,_devicePixelRatio:1,_viewName:"",_resizeCallback:null,_scaleX:1,_originalScaleX:1,_scaleY:1,_originalScaleY:1,_indexBitsUsed:0,_maxTouches:5,_resolutionPolicy:null,_rpExactFit:null,_rpShowAll:null,_rpNoBorder:null,_rpFixedHeight:null,_rpFixedWidth:null,_initialized:!1,_captured:!1,_wnd:null,_hDC:null,_hRC:null,
_supportTouch:!1,_contentTranslateLeftTop:null,_frame:null,_frameZoomFactor:1,__resizeWithBrowserSize:!1,_isAdjustViewPort:!0,_targetDensityDPI:null,ctor:function(){var a=document,c=cc.ContainerStrategy,b=cc.ContentStrategy;cc.__BrowserGetter.init(this);this._frame=cc.container.parentNode===a.body?a.documentElement:cc.container.parentNode;this._frameSize=cc.size(0,0);this._initFrameSize();var a=cc._canvas.width,d=cc._canvas.height;this._designResolutionSize=cc.size(a,d);this._originalDesignResolutionSize=
cc.size(a,d);this._viewPortRect=cc.rect(0,0,a,d);this._visibleRect=cc.rect(0,0,a,d);this._contentTranslateLeftTop={left:0,top:0};this._viewName="Cocos2dHTML5";a=cc.sys;this.enableRetina(a.os===a.OS_IOS||a.os===a.OS_OSX);cc.visibleRect&&cc.visibleRect.init(this._visibleRect);this._rpExactFit=new cc.ResolutionPolicy(c.EQUAL_TO_FRAME,b.EXACT_FIT);this._rpShowAll=new cc.ResolutionPolicy(c.PROPORTION_TO_FRAME,b.SHOW_ALL);this._rpNoBorder=new cc.ResolutionPolicy(c.EQUAL_TO_FRAME,b.NO_BORDER);this._rpFixedHeight=
new cc.ResolutionPolicy(c.EQUAL_TO_FRAME,b.FIXED_HEIGHT);this._rpFixedWidth=new cc.ResolutionPolicy(c.EQUAL_TO_FRAME,b.FIXED_WIDTH);this._hDC=cc._canvas;this._hRC=cc._renderContext;this._targetDensityDPI=cc.DENSITYDPI_HIGH},_resizeEvent:function(){var a;a=this.setDesignResolutionSize?this:cc.view;var c=a._frameSize.width,b=a._frameSize.height;if(a._initFrameSize(),a._frameSize.width!==c||a._frameSize.height!==b)a._resizeCallback&&a._resizeCallback.call(),c=a._originalDesignResolutionSize.width,b=
a._originalDesignResolutionSize.height,0<c&&a.setDesignResolutionSize(c,b,a._resolutionPolicy)},setTargetDensityDPI:function(a){this._targetDensityDPI=a;this._setViewPortMeta()},getTargetDensityDPI:function(){return this._targetDensityDPI},resizeWithBrowserSize:function(a){a?this.__resizeWithBrowserSize||(this.__resizeWithBrowserSize=!0,cc._addEventListener(window,"resize",this._resizeEvent),cc._addEventListener(window,"orientationchange",this._resizeEvent)):this.__resizeWithBrowserSize&&(this.__resizeWithBrowserSize=
!1,window.removeEventListener("resize",this._resizeEvent),window.removeEventListener("orientationchange",this._resizeEvent))},setResizeCallback:function(a){(cc.isFunction(a)||null==a)&&(this._resizeCallback=a)},_initFrameSize:function(){var a=this._frameSize;a.width=cc.__BrowserGetter.availWidth(this._frame);a.height=cc.__BrowserGetter.availHeight(this._frame)},_adjustSizeKeepCanvasSize:function(){var a=this._originalDesignResolutionSize.width,c=this._originalDesignResolutionSize.height;0<a&&this.setDesignResolutionSize(a,
c,this._resolutionPolicy)},_setViewPortMeta:function(){if(this._isAdjustViewPort){var a=document.getElementById("cocosMetaElement");a&&document.head.removeChild(a);var c,b,d=(a=document.getElementsByName("viewport"))?a[0]:null,a=cc.newElement("meta");a.id="cocosMetaElement";a.name="viewport";a.content="";c=cc.__BrowserGetter.meta;b=d?d.content:"";for(var e in c)(new RegExp(e)).test(b)||(b+=","+e+"="+c[e]);/^,/.test(b)&&(b=b.substr(1));a.content=b;d&&(d.content=b);document.head.appendChild(a)}},_setScaleXYForRenderTexture:function(){var a=
cc.contentScaleFactor();this._scaleY=this._scaleX=a},_resetScale:function(){this._scaleX=this._originalScaleX;this._scaleY=this._originalScaleY},_adjustSizeToBrowser:function(){},initialize:function(){this._initialized=!0},adjustViewPort:function(a){this._isAdjustViewPort=a},enableRetina:function(a){this._retinaEnabled=a?!0:!1},isRetinaEnabled:function(){return this._retinaEnabled},enableAutoFullScreen:function(a){this._autoFullScreen=a?!0:!1},isAutoFullScreenEnabled:function(){return this._autoFullScreen},
end:function(){},isOpenGLReady:function(){return null!==this._hDC&&null!==this._hRC},setFrameZoomFactor:function(a){this._frameZoomFactor=a;this.centerWindow();cc.director.setProjection(cc.director.getProjection())},swapBuffers:function(){},setIMEKeyboardState:function(a){},setContentTranslateLeftTop:function(a,c){this._contentTranslateLeftTop={left:a,top:c}},getContentTranslateLeftTop:function(){return this._contentTranslateLeftTop},getFrameSize:function(){return cc.size(this._frameSize.width,this._frameSize.height)},
setFrameSize:function(a,c){this._frameSize.width=a;this._frameSize.height=c;this._frame.style.width=a+"px";this._frame.style.height=c+"px";this._resizeEvent();cc.director.setProjection(cc.director.getProjection())},centerWindow:function(){},getVisibleSize:function(){return cc.size(this._visibleRect.width,this._visibleRect.height)},getVisibleOrigin:function(){return cc.p(this._visibleRect.x,this._visibleRect.y)},canSetContentScaleFactor:function(){return!0},getResolutionPolicy:function(){return this._resolutionPolicy},
setResolutionPolicy:function(a){if(a instanceof cc.ResolutionPolicy)this._resolutionPolicy=a;else{var c=cc.ResolutionPolicy;a===c.EXACT_FIT&&(this._resolutionPolicy=this._rpExactFit);a===c.SHOW_ALL&&(this._resolutionPolicy=this._rpShowAll);a===c.NO_BORDER&&(this._resolutionPolicy=this._rpNoBorder);a===c.FIXED_HEIGHT&&(this._resolutionPolicy=this._rpFixedHeight);a===c.FIXED_WIDTH&&(this._resolutionPolicy=this._rpFixedWidth)}},setDesignResolutionSize:function(a,c,b){if(!(0<a||0<c))return void cc.log(cc._LogInfos.EGLView_setDesignResolutionSize);
this.setResolutionPolicy(b);b=this._resolutionPolicy;if(!b)return void cc.log(cc._LogInfos.EGLView_setDesignResolutionSize_2);b.preApply(this);cc.sys.isMobile&&this._setViewPortMeta();this._initFrameSize();this._originalDesignResolutionSize.width=this._designResolutionSize.width=a;this._originalDesignResolutionSize.height=this._designResolutionSize.height=c;var d=b.apply(this,this._designResolutionSize);if(d.scale&&2===d.scale.length&&(this._scaleX=d.scale[0],this._scaleY=d.scale[1]),d.viewport)a=
this._viewPortRect,c=this._visibleRect,d=d.viewport,a.x=d.x,a.y=d.y,a.width=d.width,a.height=d.height,c.x=-a.x/this._scaleX,c.y=-a.y/this._scaleY,c.width=cc._canvas.width/this._scaleX,c.height=cc._canvas.height/this._scaleY,cc._renderContext.setOffset&&cc._renderContext.setOffset(a.x,-a.y);a=cc.director;a._winSizeInPoints.width=this._designResolutionSize.width;a._winSizeInPoints.height=this._designResolutionSize.height;b.postApply(this);cc.winSize.width=a._winSizeInPoints.width;cc.winSize.height=
a._winSizeInPoints.height;cc._renderType===cc._RENDER_TYPE_WEBGL&&(a._createStatsLabel(),a.setGLDefaultValues());this._originalScaleX=this._scaleX;this._originalScaleY=this._scaleY;cc.DOM&&cc.DOM._resetEGLViewDiv();cc.visibleRect&&cc.visibleRect.init(this._visibleRect)},getDesignResolutionSize:function(){return cc.size(this._designResolutionSize.width,this._designResolutionSize.height)},setViewPortInPoints:function(a,c,b,d){var e=this._frameZoomFactor,f=this._scaleX,g=this._scaleY;cc._renderContext.viewport(a*
f*e+this._viewPortRect.x*e,c*g*e+this._viewPortRect.y*e,b*f*e,d*g*e)},setScissorInPoints:function(a,c,b,d){var e=this._frameZoomFactor,f=this._scaleX,g=this._scaleY;cc._renderContext.scissor(a*f*e+this._viewPortRect.x*e,c*g*e+this._viewPortRect.y*e,b*f*e,d*g*e)},isScissorEnabled:function(){var a=cc._renderContext;return a.isEnabled(a.SCISSOR_TEST)},getScissorRect:function(){var a=cc._renderContext,c=this._scaleX,b=this._scaleY,a=a.getParameter(a.SCISSOR_BOX);return cc.rect((a[0]-this._viewPortRect.x)/
c,(a[1]-this._viewPortRect.y)/b,a[2]/c,a[3]/b)},setViewName:function(a){null!=a&&0<a.length&&(this._viewName=a)},getViewName:function(){return this._viewName},getViewPortRect:function(){return this._viewPortRect},getScaleX:function(){return this._scaleX},getScaleY:function(){return this._scaleY},getDevicePixelRatio:function(){return this._devicePixelRatio},convertToLocationInView:function(a,c,b){return{x:this._devicePixelRatio*(a-b.left),y:this._devicePixelRatio*(b.top+b.height-c)}},_convertMouseToLocationInView:function(a,
c){var b=this._viewPortRect;a.x=(this._devicePixelRatio*(a.x-c.left)-b.x)/this._scaleX;a.y=(this._devicePixelRatio*(c.top+c.height-a.y)-b.y)/this._scaleY},_convertTouchesWithScale:function(a){for(var c,b,d,e=this._viewPortRect,f=this._scaleX,g=this._scaleY,h=0;h<a.length;h++)c=a[h],b=c._point,d=c._prevPoint,c._setPoint((b.x-e.x)/f,(b.y-e.y)/g),c._setPrevPoint((d.x-e.x)/f,(d.y-e.y)/g)}}),cc.EGLView._getInstance=function(){return this._instance||(this._instance=this._instance||new cc.EGLView,this._instance.initialize()),
this._instance},cc.ContainerStrategy=cc.Class.extend({preApply:function(a){},apply:function(a,c){},postApply:function(a){},_setupContainer:function(a,c,b){var d=a._frame;cc.view._autoFullScreen&&cc.sys.isMobile&&d===document.documentElement&&cc.screen.autoFullScreen(d);var d=cc._canvas,e=cc.container;e.style.width=d.style.width=c+"px";e.style.height=d.style.height=b+"px";e=a._devicePixelRatio=1;a.isRetinaEnabled()&&(e=a._devicePixelRatio=window.devicePixelRatio||1);d.width=c*e;d.height=b*e;cc._renderContext.resetCache&&
cc._renderContext.resetCache();var f;(a=document.body)&&(f=a.style)&&(f.paddingTop=f.paddingTop||"0px",f.paddingRight=f.paddingRight||"0px",f.paddingBottom=f.paddingBottom||"0px",f.paddingLeft=f.paddingLeft||"0px",f.borderTop=f.borderTop||"0px",f.borderRight=f.borderRight||"0px",f.borderBottom=f.borderBottom||"0px",f.borderLeft=f.borderLeft||"0px",f.marginTop=f.marginTop||"0px",f.marginRight=f.marginRight||"0px",f.marginBottom=f.marginBottom||"0px",f.marginLeft=f.marginLeft||"0px")},_fixContainer:function(){document.body.insertBefore(cc.container,
document.body.firstChild);var a=document.body.style;a.width=window.innerWidth+"px";a.height=window.innerHeight+"px";a.overflow="hidden";a=cc.container.style;a.position="fixed";a.left=a.top="0px";document.body.scrollTop=0}}),cc.ContentStrategy=cc.Class.extend({_result:{scale:[1,1],viewport:null},_buildResult:function(a,c,b,d,e,f){2>Math.abs(a-b)&&(b=a);2>Math.abs(c-d)&&(d=c);a=cc.rect(Math.round((a-b)/2),Math.round((c-d)/2),b,d);return cc._renderType===cc._RENDER_TYPE_CANVAS,this._result.scale=[e,
f],this._result.viewport=a,this._result},preApply:function(a){},apply:function(a,c){return{scale:[1,1]}},postApply:function(a){}}),function(){var a=cc.ContainerStrategy.extend({apply:function(a){this._setupContainer(a,a._frameSize.width,a._frameSize.height)}}),c=cc.ContainerStrategy.extend({apply:function(a,c){var b,d,e=a._frameSize.width,n=a._frameSize.height,p=cc.container.style,q=c.width,r=c.height,u=e/q,t=n/r;t>u?(b=e,d=r*u):(b=q*t,d=n);b=Math.round((e-b)/2);d=Math.round((n-d)/2);this._setupContainer(a,
e-2*b,n-2*d);p.marginLeft=b+"px";p.marginRight=b+"px";p.marginTop=d+"px";p.marginBottom=d+"px"}}),b=(a.extend({preApply:function(a){this._super(a);a._frame=document.documentElement},apply:function(a){this._super(a);this._fixContainer()}}),c.extend({preApply:function(a){this._super(a);a._frame=document.documentElement},apply:function(a,c){this._super(a,c);this._fixContainer()}}),cc.ContainerStrategy.extend({apply:function(a){this._setupContainer(a,cc._canvas.width,cc._canvas.height)}}));cc.ContainerStrategy.EQUAL_TO_FRAME=
new a;cc.ContainerStrategy.PROPORTION_TO_FRAME=new c;cc.ContainerStrategy.ORIGINAL_CONTAINER=new b;var a=cc.ContentStrategy.extend({apply:function(a,c){var b=cc._canvas.width,d=cc._canvas.height;return this._buildResult(b,d,b,d,b/c.width,d/c.height)}}),c=cc.ContentStrategy.extend({apply:function(a,c){var b,d,e=cc._canvas.width,n=cc._canvas.height,p=c.width,q=c.height,r=e/p,u=n/q,t=0;return u>r?(t=r,b=e,d=q*t):(t=u,b=p*t,d=n),this._buildResult(e,n,b,d,t,t)}}),b=cc.ContentStrategy.extend({apply:function(a,
c){var b,d,e,n=cc._canvas.width,p=cc._canvas.height,q=c.width,r=c.height,u=n/q,t=p/r;return t>u?(b=t,d=q*b,e=p):(b=u,d=n,e=r*b),this._buildResult(n,p,d,e,b,b)}}),d=cc.ContentStrategy.extend({apply:function(a,c){var b=cc._canvas.width,d=cc._canvas.height,e=d/c.height;return this._buildResult(b,d,b,d,e,e)},postApply:function(a){cc.director._winSizeInPoints=a.getVisibleSize()}}),e=cc.ContentStrategy.extend({apply:function(a,c){var b=cc._canvas.width,d=cc._canvas.height,e=b/c.width;return this._buildResult(b,
d,b,d,e,e)},postApply:function(a){cc.director._winSizeInPoints=a.getVisibleSize()}});cc.ContentStrategy.EXACT_FIT=new a;cc.ContentStrategy.SHOW_ALL=new c;cc.ContentStrategy.NO_BORDER=new b;cc.ContentStrategy.FIXED_HEIGHT=new d;cc.ContentStrategy.FIXED_WIDTH=new e}(),cc.ResolutionPolicy=cc.Class.extend({_containerStrategy:null,_contentStrategy:null,ctor:function(a,c){this.setContainerStrategy(a);this.setContentStrategy(c)},preApply:function(a){this._containerStrategy.preApply(a);this._contentStrategy.preApply(a)},
apply:function(a,c){return this._containerStrategy.apply(a,c),this._contentStrategy.apply(a,c)},postApply:function(a){this._containerStrategy.postApply(a);this._contentStrategy.postApply(a)},setContainerStrategy:function(a){a instanceof cc.ContainerStrategy&&(this._containerStrategy=a)},setContentStrategy:function(a){a instanceof cc.ContentStrategy&&(this._contentStrategy=a)}}),cc.ResolutionPolicy.EXACT_FIT=0,cc.ResolutionPolicy.NO_BORDER=1,cc.ResolutionPolicy.SHOW_ALL=2,cc.ResolutionPolicy.FIXED_HEIGHT=
3,cc.ResolutionPolicy.FIXED_WIDTH=4,cc.ResolutionPolicy.UNKNOWN=5,cc.screen={_supportsFullScreen:!1,_preOnFullScreenChange:null,_touchEvent:"",_fn:null,_fnMap:[["requestFullscreen","exitFullscreen","fullscreenchange","fullscreenEnabled","fullscreenElement"],["requestFullScreen","exitFullScreen","fullScreenchange","fullScreenEnabled","fullScreenElement"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange","webkitIsFullScreen","webkitCurrentFullScreenElement"],["mozRequestFullScreen",
"mozCancelFullScreen","mozfullscreenchange","mozFullScreen","mozFullScreenElement"],["msRequestFullscreen","msExitFullscreen","MSFullscreenChange","msFullscreenEnabled","msFullscreenElement"]],init:function(){this._fn={};var a,c,b,d=this._fnMap;a=0;for(l=d.length;a<l;a++)if(c=d[a],c&&c[1]in document){a=0;for(b=c.length;b>a;a++)this._fn[d[0][a]]=c[a];break}this._supportsFullScreen="undefined"!=typeof this._fn.requestFullscreen;this._touchEvent="ontouchstart"in window?"touchstart":"mousedown"},fullScreen:function(){return this._supportsFullScreen&&
document[this._fn.fullscreenElement]},requestFullScreen:function(a,c){if(this._supportsFullScreen){if(a=a||document.documentElement,c){var b=this._fn.fullscreenchange;this._preOnFullScreenChange&&document.removeEventListener(b,this._preOnFullScreenChange);this._preOnFullScreenChange=c;cc._addEventListener(document,b,c,!1)}return a[this._fn.requestFullscreen]()}},exitFullScreen:function(){return this._supportsFullScreen?document[this._fn.exitFullscreen]():!0},autoFullScreen:function(a,c){function b(){e.requestFullScreen(a,
c);d.removeEventListener(e._touchEvent,b)}a=a||document.body;var d=cc._canvas||a,e=this;this.requestFullScreen(a,c);cc._addEventListener(d,this._touchEvent,b)}},cc.screen.init(),cc.visibleRect={topLeft:cc.p(0,0),topRight:cc.p(0,0),top:cc.p(0,0),bottomLeft:cc.p(0,0),bottomRight:cc.p(0,0),bottom:cc.p(0,0),center:cc.p(0,0),left:cc.p(0,0),right:cc.p(0,0),width:0,height:0,init:function(a){var c=this.width=a.width,b=this.height=a.height,d=a.x;a=a.y;var e=a+b,f=d+c;this.topLeft.x=d;this.topLeft.y=e;this.topRight.x=
f;this.topRight.y=e;this.top.x=d+c/2;this.top.y=e;this.bottomLeft.x=d;this.bottomLeft.y=a;this.bottomRight.x=f;this.bottomRight.y=a;this.bottom.x=d+c/2;this.bottom.y=a;this.center.x=d+c/2;this.center.y=a+b/2;this.left.x=d;this.left.y=a+b/2;this.right.x=f;this.right.y=a+b/2}},cc.UIInterfaceOrientationLandscapeLeft=-90,cc.UIInterfaceOrientationLandscapeRight=90,cc.UIInterfaceOrientationPortraitUpsideDown=180,cc.UIInterfaceOrientationPortrait=0,cc.inputManager={_mousePressed:!1,_isRegisterEvent:!1,_preTouchPoint:cc.p(0,
0),_prevMousePoint:cc.p(0,0),_preTouchPool:[],_preTouchPoolPointer:0,_touches:[],_touchesIntegerDict:{},_indexBitsUsed:0,_maxTouches:5,_accelEnabled:!1,_accelInterval:1/30,_accelMinus:1,_accelCurTime:0,_acceleration:null,_accelDeviceEvent:null,_getUnUsedIndex:function(){for(var a=this._indexBitsUsed,c=0;c<this._maxTouches;c++){if(!(1&a))return this._indexBitsUsed|=1<<c,c;a>>=1}return-1},_removeUsedIndexBit:function(a){0>a||a>=this._maxTouches||(a=~(1<<a),this._indexBitsUsed&=a)},_glView:null,handleTouchesBegin:function(a){for(var c,
b,d,e,f=[],g=this._touchesIntegerDict,h=0,k=a.length;k>h;h++)if(c=a[h],e=c.getID(),b=g[e],null==b){var m=this._getUnUsedIndex();-1===m?cc.log(cc._LogInfos.inputManager_handleTouchesBegin,m):(d=this._touches[m]=new cc.Touch(c._point.x,c._point.y,c.getID()),d._setPrevPoint(c._prevPoint),g[e]=m,f.push(d))}0<f.length&&(this._glView._convertTouchesWithScale(f),a=new cc.EventTouch(f),a._eventCode=cc.EventTouch.EventCode.BEGAN,cc.eventManager.dispatchEvent(a))},handleTouchesMove:function(a){for(var c,b,
d=[],e=this._touches,f=0,g=a.length;g>f;f++)c=a[f],b=c.getID(),b=this._touchesIntegerDict[b],null!=b&&e[b]&&(e[b]._setPoint(c._point),e[b]._setPrevPoint(c._prevPoint),d.push(e[b]));0<d.length&&(this._glView._convertTouchesWithScale(d),a=new cc.EventTouch(d),a._eventCode=cc.EventTouch.EventCode.MOVED,cc.eventManager.dispatchEvent(a))},handleTouchesEnd:function(a){a=this.getSetOfTouchesEndOrCancel(a);0<a.length&&(this._glView._convertTouchesWithScale(a),a=new cc.EventTouch(a),a._eventCode=cc.EventTouch.EventCode.ENDED,
cc.eventManager.dispatchEvent(a))},handleTouchesCancel:function(a){a=this.getSetOfTouchesEndOrCancel(a);0<a.length&&(this._glView._convertTouchesWithScale(a),a=new cc.EventTouch(a),a._eventCode=cc.EventTouch.EventCode.CANCELLED,cc.eventManager.dispatchEvent(a))},getSetOfTouchesEndOrCancel:function(a){for(var c,b,d,e=[],f=this._touches,g=this._touchesIntegerDict,h=0,k=a.length;k>h;h++)c=a[h],d=c.getID(),b=g[d],null!=b&&f[b]&&(f[b]._setPoint(c._point),f[b]._setPrevPoint(c._prevPoint),e.push(f[b]),this._removeUsedIndexBit(b),
delete g[d]);return e},getHTMLElementPosition:function(a){var c=document.documentElement,b=window,d=null;return d=cc.isFunction(a.getBoundingClientRect)?a.getBoundingClientRect():a instanceof HTMLCanvasElement?{left:0,top:0,width:a.width,height:a.height}:{left:0,top:0,width:parseInt(a.style.width),height:parseInt(a.style.height)},{left:d.left+b.pageXOffset-c.clientLeft,top:d.top+b.pageYOffset-c.clientTop,width:d.width,height:d.height}},getPreTouch:function(a){for(var c=null,b=this._preTouchPool,d=
a.getID(),e=b.length-1;0<=e;e--)if(b[e].getID()===d){c=b[e];break}return c||(c=a),c},setPreTouch:function(a){for(var c=!1,b=this._preTouchPool,d=a.getID(),e=b.length-1;0<=e;e--)if(b[e].getID()===d){b[e]=a;c=!0;break}c||(50>=b.length?b.push(a):(b[this._preTouchPoolPointer]=a,this._preTouchPoolPointer=(this._preTouchPoolPointer+1)%50))},getTouchByXY:function(a,c,b){var d=this._preTouchPoint;a=this._glView.convertToLocationInView(a,c,b);c=new cc.Touch(a.x,a.y);return c._setPrevPoint(d.x,d.y),d.x=a.x,
d.y=a.y,c},getMouseEvent:function(a,c,b){var d=this._prevMousePoint;this._glView._convertMouseToLocationInView(a,c);c=new cc.EventMouse(b);return c.setLocation(a.x,a.y),c._setPrevCursor(d.x,d.y),d.x=a.x,d.y=a.y,c},getPointByEvent:function(a,c){return null!=a.pageX?{x:a.pageX,y:a.pageY}:(c.left-=document.body.scrollLeft,c.top-=document.body.scrollTop,{x:a.clientX,y:a.clientY})},getTouchesByEvent:function(a,c){for(var b,d,e,f=[],g=this._glView,h=this._preTouchPoint,k=a.changedTouches.length,m=0;k>m;m++)if(b=
a.changedTouches[m]){var n;n=cc.sys.BROWSER_TYPE_FIREFOX===cc.sys.browserType?g.convertToLocationInView(b.pageX,b.pageY,c):g.convertToLocationInView(b.clientX,b.clientY,c);null!=b.identifier?(d=new cc.Touch(n.x,n.y,b.identifier),e=this.getPreTouch(d).getLocation(),d._setPrevPoint(e.x,e.y),this.setPreTouch(d)):(d=new cc.Touch(n.x,n.y),d._setPrevPoint(h.x,h.y));h.x=n.x;h.y=n.y;f.push(d)}return f},registerSystemEvent:function(a){if(!this._isRegisterEvent){var c=(this._glView=cc.view,this),b="mouse"in
cc.sys.capabilities,d="touches"in cc.sys.capabilities,e=!1;if(cc.sys.isMobile&&(e=!0),b&&(cc._addEventListener(window,"mousedown",function(){c._mousePressed=!0},!1),cc._addEventListener(window,"mouseup",function(b){if(!e){var d=c._mousePressed;if(c._mousePressed=!1,d){var d=c.getHTMLElementPosition(a),f=c.getPointByEvent(b,d);cc.rectContainsPoint(new cc.Rect(d.left,d.top,d.width,d.height),f)||(c.handleTouchesEnd([c.getTouchByXY(f.x,f.y,d)]),d=c.getMouseEvent(f,d,cc.EventMouse.UP),d.setButton(b.button),
cc.eventManager.dispatchEvent(d))}}},!1),cc._addEventListener(a,"mousedown",function(b){if(!e){c._mousePressed=!0;var d=c.getHTMLElementPosition(a),f=c.getPointByEvent(b,d);c.handleTouchesBegin([c.getTouchByXY(f.x,f.y,d)]);d=c.getMouseEvent(f,d,cc.EventMouse.DOWN);d.setButton(b.button);cc.eventManager.dispatchEvent(d);b.stopPropagation();b.preventDefault();a.focus()}},!1),cc._addEventListener(a,"mouseup",function(b){if(!e){c._mousePressed=!1;var d=c.getHTMLElementPosition(a),f=c.getPointByEvent(b,
d);c.handleTouchesEnd([c.getTouchByXY(f.x,f.y,d)]);d=c.getMouseEvent(f,d,cc.EventMouse.UP);d.setButton(b.button);cc.eventManager.dispatchEvent(d);b.stopPropagation();b.preventDefault()}},!1),cc._addEventListener(a,"mousemove",function(b){if(!e){var d=c.getHTMLElementPosition(a),f=c.getPointByEvent(b,d);c.handleTouchesMove([c.getTouchByXY(f.x,f.y,d)]);d=c.getMouseEvent(f,d,cc.EventMouse.MOVE);d.setButton(c._mousePressed?b.button:null);cc.eventManager.dispatchEvent(d);b.stopPropagation();b.preventDefault()}},
!1),cc._addEventListener(a,"mousewheel",function(b){var d=c.getHTMLElementPosition(a),e=c.getPointByEvent(b,d),d=c.getMouseEvent(e,d,cc.EventMouse.SCROLL);d.setButton(b.button);d.setScrollData(0,b.wheelDelta);cc.eventManager.dispatchEvent(d);b.stopPropagation();b.preventDefault()},!1),cc._addEventListener(a,"DOMMouseScroll",function(b){var d=c.getHTMLElementPosition(a),e=c.getPointByEvent(b,d),d=c.getMouseEvent(e,d,cc.EventMouse.SCROLL);d.setButton(b.button);d.setScrollData(0,-120*b.detail);cc.eventManager.dispatchEvent(d);
b.stopPropagation();b.preventDefault()},!1)),window.navigator.msPointerEnabled){var b={MSPointerDown:c.handleTouchesBegin,MSPointerMove:c.handleTouchesMove,MSPointerUp:c.handleTouchesEnd,MSPointerCancel:c.handleTouchesCancel},f;for(f in b)!function(b,d){cc._addEventListener(a,b,function(b){var e=c.getHTMLElementPosition(a);e.left-=document.documentElement.scrollLeft;e.top-=document.documentElement.scrollTop;d.call(c,[c.getTouchByXY(b.clientX,b.clientY,e)]);b.stopPropagation()},!1)}(f,b[f])}d&&(cc._addEventListener(a,
"touchstart",function(b){if(b.changedTouches){var d=c.getHTMLElementPosition(a);d.left-=document.body.scrollLeft;d.top-=document.body.scrollTop;c.handleTouchesBegin(c.getTouchesByEvent(b,d));b.stopPropagation();b.preventDefault();a.focus()}},!1),cc._addEventListener(a,"touchmove",function(b){if(b.changedTouches){var d=c.getHTMLElementPosition(a);d.left-=document.body.scrollLeft;d.top-=document.body.scrollTop;c.handleTouchesMove(c.getTouchesByEvent(b,d));b.stopPropagation();b.preventDefault()}},!1),
cc._addEventListener(a,"touchend",function(b){if(b.changedTouches){var d=c.getHTMLElementPosition(a);d.left-=document.body.scrollLeft;d.top-=document.body.scrollTop;c.handleTouchesEnd(c.getTouchesByEvent(b,d));b.stopPropagation();b.preventDefault()}},!1),cc._addEventListener(a,"touchcancel",function(b){if(b.changedTouches){var d=c.getHTMLElementPosition(a);d.left-=document.body.scrollLeft;d.top-=document.body.scrollTop;c.handleTouchesCancel(c.getTouchesByEvent(b,d));b.stopPropagation();b.preventDefault()}},
!1));this._registerKeyboardEvent();this._registerAccelerometerEvent();this._isRegisterEvent=!0}},_registerKeyboardEvent:function(){},_registerAccelerometerEvent:function(){},update:function(a){this._accelCurTime>this._accelInterval&&(this._accelCurTime-=this._accelInterval,cc.eventManager.dispatchEvent(new cc.EventAcceleration(this._acceleration)));this._accelCurTime+=a}},cc.AffineTransform=function(a,c,b,d,e,f){this.a=a;this.b=c;this.c=b;this.d=d;this.tx=e;this.ty=f},cc.affineTransformMake=function(a,
c,b,d,e,f){return{a:a,b:c,c:b,d:d,tx:e,ty:f}},cc.pointApplyAffineTransform=function(a,c,b){var d,e;return void 0===b?(b=c,d=a.x,e=a.y):(d=a,e=c),{x:b.a*d+b.c*e+b.tx,y:b.b*d+b.d*e+b.ty}},cc._pointApplyAffineTransform=function(a,c,b){return cc.pointApplyAffineTransform(a,c,b)},cc.sizeApplyAffineTransform=function(a,c){return{width:c.a*a.width+c.c*a.height,height:c.b*a.width+c.d*a.height}},cc.affineTransformMakeIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.affineTransformIdentity=function(){return{a:1,
b:0,c:0,d:1,tx:0,ty:0}},cc.rectApplyAffineTransform=function(a,c){var b=cc.rectGetMinY(a),d=cc.rectGetMinX(a),e=cc.rectGetMaxX(a),f=cc.rectGetMaxY(a),g=cc.pointApplyAffineTransform(d,b,c),b=cc.pointApplyAffineTransform(e,b,c),d=cc.pointApplyAffineTransform(d,f,c),h=cc.pointApplyAffineTransform(e,f,c),e=Math.min(g.x,b.x,d.x,h.x),f=Math.max(g.x,b.x,d.x,h.x),k=Math.min(g.y,b.y,d.y,h.y),g=Math.max(g.y,b.y,d.y,h.y);return cc.rect(e,k,f-e,g-k)},cc._rectApplyAffineTransformIn=function(a,c){var b=cc.rectGetMinY(a),
d=cc.rectGetMinX(a),e=cc.rectGetMaxX(a),f=cc.rectGetMaxY(a),g=cc.pointApplyAffineTransform(d,b,c),b=cc.pointApplyAffineTransform(e,b,c),d=cc.pointApplyAffineTransform(d,f,c),h=cc.pointApplyAffineTransform(e,f,c),e=Math.min(g.x,b.x,d.x,h.x),f=Math.max(g.x,b.x,d.x,h.x),k=Math.min(g.y,b.y,d.y,h.y),g=Math.max(g.y,b.y,d.y,h.y);return a.x=e,a.y=k,a.width=f-e,a.height=g-k,a},cc.affineTransformTranslate=function(a,c,b){return{a:a.a,b:a.b,c:a.c,d:a.d,tx:a.tx+a.a*c+a.c*b,ty:a.ty+a.b*c+a.d*b}},cc.affineTransformScale=
function(a,c,b){return{a:a.a*c,b:a.b*c,c:a.c*b,d:a.d*b,tx:a.tx,ty:a.ty}},cc.affineTransformRotate=function(a,c){var b=Math.sin(c),d=Math.cos(c);return{a:a.a*d+a.c*b,b:a.b*d+a.d*b,c:a.c*d-a.a*b,d:a.d*d-a.b*b,tx:a.tx,ty:a.ty}},cc.affineTransformConcat=function(a,c){return{a:a.a*c.a+a.b*c.c,b:a.a*c.b+a.b*c.d,c:a.c*c.a+a.d*c.c,d:a.c*c.b+a.d*c.d,tx:a.tx*c.a+a.ty*c.c+c.tx,ty:a.tx*c.b+a.ty*c.d+c.ty}},cc.affineTransformEqualToTransform=function(a,c){return a.a===c.a&&a.b===c.b&&a.c===c.c&&a.d===c.d&&a.tx===
c.tx&&a.ty===c.ty},cc.affineTransformInvert=function(a){var c=1/(a.a*a.d-a.b*a.c);return{a:c*a.d,b:-c*a.b,c:-c*a.c,d:c*a.a,tx:c*(a.c*a.ty-a.d*a.tx),ty:c*(a.b*a.tx-a.a*a.ty)}},cc.POINT_EPSILON=parseFloat("1.192092896e-07F"),cc.pNeg=function(a){return cc.p(-a.x,-a.y)},cc.pAdd=function(a,c){return cc.p(a.x+c.x,a.y+c.y)},cc.pSub=function(a,c){return cc.p(a.x-c.x,a.y-c.y)},cc.pMult=function(a,c){return cc.p(a.x*c,a.y*c)},cc.pMidpoint=function(a,c){return cc.pMult(cc.pAdd(a,c),.5)},cc.pDot=function(a,c){return a.x*
c.x+a.y*c.y},cc.pCross=function(a,c){return a.x*c.y-a.y*c.x},cc.pPerp=function(a){return cc.p(-a.y,a.x)},cc.pRPerp=function(a){return cc.p(a.y,-a.x)},cc.pProject=function(a,c){return cc.pMult(c,cc.pDot(a,c)/cc.pDot(c,c))},cc.pRotate=function(a,c){return cc.p(a.x*c.x-a.y*c.y,a.x*c.y+a.y*c.x)},cc.pUnrotate=function(a,c){return cc.p(a.x*c.x+a.y*c.y,a.y*c.x-a.x*c.y)},cc.pLengthSQ=function(a){return cc.pDot(a,a)},cc.pDistanceSQ=function(a,c){return cc.pLengthSQ(cc.pSub(a,c))},cc.pLength=function(a){return Math.sqrt(cc.pLengthSQ(a))},
cc.pDistance=function(a,c){return cc.pLength(cc.pSub(a,c))},cc.pNormalize=function(a){var c=cc.pLength(a);return 0===c?cc.p(a):cc.pMult(a,1/c)},cc.pForAngle=function(a){return cc.p(Math.cos(a),Math.sin(a))},cc.pToAngle=function(a){return Math.atan2(a.y,a.x)},cc.clampf=function(a,c,b){if(c>b){var d=c;c=b;b=d}return c>a?c:b>a?a:b},cc.pClamp=function(a,c,b){return cc.p(cc.clampf(a.x,c.x,b.x),cc.clampf(a.y,c.y,b.y))},cc.pFromSize=function(a){return cc.p(a.width,a.height)},cc.pCompOp=function(a,c){return cc.p(c(a.x),
c(a.y))},cc.pLerp=function(a,c,b){return cc.pAdd(cc.pMult(a,1-b),cc.pMult(c,b))},cc.pFuzzyEqual=function(a,c,b){return a.x-b<=c.x&&c.x<=a.x+b&&a.y-b<=c.y&&c.y<=a.y+b?!0:!1},cc.pCompMult=function(a,c){return cc.p(a.x*c.x,a.y*c.y)},cc.pAngleSigned=function(a,c){var b=cc.pNormalize(a),d=cc.pNormalize(c),b=Math.atan2(b.x*d.y-b.y*d.x,cc.pDot(b,d));return Math.abs(b)<cc.POINT_EPSILON?0:b},cc.pAngle=function(a,c){var b=Math.acos(cc.pDot(cc.pNormalize(a),cc.pNormalize(c)));return Math.abs(b)<cc.POINT_EPSILON?
0:b},cc.pRotateByAngle=function(a,c,b){a=cc.pSub(a,c);var d=Math.cos(b);b=Math.sin(b);var e=a.x;return a.x=e*d-a.y*b+c.x,a.y=e*b+a.y*d+c.y,a},cc.pLineIntersect=function(a,c,b,d,e){if(a.x===c.x&&a.y===c.y||b.x===d.x&&b.y===d.y)return!1;var f=c.x-a.x;c=c.y-a.y;var g=d.x-b.x;d=d.y-b.y;var h=a.x-b.x;a=a.y-b.y;b=d*f-g*c;return e.x=g*a-d*h,e.y=f*a-c*h,0===b?0===e.x||0===e.y?!0:!1:(e.x/=b,e.y/=b,!0)},cc.pSegmentIntersect=function(a,c,b,d){var e=cc.p(0,0);return cc.pLineIntersect(a,c,b,d,e)&&0<=e.x&&1>=e.x&&
0<=e.y&&1>=e.y?!0:!1},cc.pIntersectPoint=function(a,c,b,d){var e=cc.p(0,0);return cc.pLineIntersect(a,c,b,d,e)?(b=cc.p(0,0),b.x=a.x+e.x*(c.x-a.x),b.y=a.y+e.x*(c.y-a.y),b):cc.p(0,0)},cc.pSameAs=function(a,c){return null!=a&&null!=c?a.x===c.x&&a.y===c.y:!1},cc.pZeroIn=function(a){a.x=0;a.y=0},cc.pIn=function(a,c){a.x=c.x;a.y=c.y},cc.pMultIn=function(a,c){a.x*=c;a.y*=c},cc.pSubIn=function(a,c){a.x-=c.x;a.y-=c.y},cc.pAddIn=function(a,c){a.x+=c.x;a.y+=c.y},cc.pNormalizeIn=function(a){cc.pMultIn(a,1/Math.sqrt(a.x*
a.x+a.y*a.y))},cc.Touch=cc.Class.extend({_point:null,_prevPoint:null,_id:0,_startPointCaptured:!1,_startPoint:null,ctor:function(a,c,b){this._point=cc.p(a||0,c||0);this._id=b||0},getLocation:function(){return{x:this._point.x,y:this._point.y}},getLocationX:function(){return this._point.x},getLocationY:function(){return this._point.y},getPreviousLocation:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocation:function(){return{x:this._startPoint.x,y:this._startPoint.y}},getDelta:function(){return cc.pSub(this._point,
this._prevPoint)},getLocationInView:function(){return{x:this._point.x,y:this._point.y}},getPreviousLocationInView:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocationInView:function(){return{x:this._startPoint.x,y:this._startPoint.y}},getID:function(){return this._id},getId:function(){return cc.log("getId is deprecated. Please use getID instead."),this._id},setTouchInfo:function(a,c,b){this._prevPoint=this._point;this._point=cc.p(c||0,b||0);this._id=a;this._startPointCaptured||
(this._startPoint=cc.p(this._point),this._startPointCaptured=!0)},_setPoint:function(a,c){void 0===c?(this._point.x=a.x,this._point.y=a.y):(this._point.x=a,this._point.y=c)},_setPrevPoint:function(a,c){void 0===c?this._prevPoint=cc.p(a.x,a.y):this._prevPoint=cc.p(a||0,c||0)}}),cc.Event=cc.Class.extend({_type:0,_isStopped:!1,_currentTarget:null,_setCurrentTarget:function(a){this._currentTarget=a},ctor:function(a){this._type=a},getType:function(){return this._type},stopPropagation:function(){this._isStopped=
!0},isStopped:function(){return this._isStopped},getCurrentTarget:function(){return this._currentTarget}}),cc.Event.TOUCH=0,cc.Event.KEYBOARD=1,cc.Event.ACCELERATION=2,cc.Event.MOUSE=3,cc.Event.FOCUS=4,cc.Event.CUSTOM=6,cc.EventCustom=cc.Event.extend({_eventName:null,_userData:null,ctor:function(a){cc.Event.prototype.ctor.call(this,cc.Event.CUSTOM);this._eventName=a},setUserData:function(a){this._userData=a},getUserData:function(){return this._userData},getEventName:function(){return this._eventName}}),
cc.EventMouse=cc.Event.extend({_eventType:0,_button:0,_x:0,_y:0,_prevX:0,_prevY:0,_scrollX:0,_scrollY:0,ctor:function(a){cc.Event.prototype.ctor.call(this,cc.Event.MOUSE);this._eventType=a},setScrollData:function(a,c){this._scrollX=a;this._scrollY=c},getScrollX:function(){return this._scrollX},getScrollY:function(){return this._scrollY},setLocation:function(a,c){this._x=a;this._y=c},getLocation:function(){return{x:this._x,y:this._y}},getLocationInView:function(){return{x:this._x,y:cc.view._designResolutionSize.height-
this._y}},_setPrevCursor:function(a,c){this._prevX=a;this._prevY=c},getDelta:function(){return{x:this._x-this._prevX,y:this._y-this._prevY}},getDeltaX:function(){return this._x-this._prevX},getDeltaY:function(){return this._y-this._prevY},setButton:function(a){this._button=a},getButton:function(){return this._button},getLocationX:function(){return this._x},getLocationY:function(){return this._y}}),cc.EventMouse.NONE=0,cc.EventMouse.DOWN=1,cc.EventMouse.UP=2,cc.EventMouse.MOVE=3,cc.EventMouse.SCROLL=
4,cc.EventMouse.BUTTON_LEFT=0,cc.EventMouse.BUTTON_RIGHT=2,cc.EventMouse.BUTTON_MIDDLE=1,cc.EventMouse.BUTTON_4=3,cc.EventMouse.BUTTON_5=4,cc.EventMouse.BUTTON_6=5,cc.EventMouse.BUTTON_7=6,cc.EventMouse.BUTTON_8=7,cc.EventTouch=cc.Event.extend({_eventCode:0,_touches:null,ctor:function(a){cc.Event.prototype.ctor.call(this,cc.Event.TOUCH);this._touches=a||[]},getEventCode:function(){return this._eventCode},getTouches:function(){return this._touches},_setEventCode:function(a){this._eventCode=a},_setTouches:function(a){this._touches=
a}}),cc.EventTouch.MAX_TOUCHES=5,cc.EventTouch.EventCode={BEGAN:0,MOVED:1,ENDED:2,CANCELLED:3},cc.EventFocus=cc.Event.extend({_widgetGetFocus:null,_widgetLoseFocus:null,ctor:function(a,c){cc.Event.prototype.ctor.call(this,cc.Event.FOCUS);this._widgetGetFocus=c;this._widgetLoseFocus=a}}),cc.EventListener=cc.Class.extend({_onEvent:null,_type:0,_listenerID:null,_registered:!1,_fixedPriority:0,_node:null,_paused:!0,_isEnabled:!0,ctor:function(a,c,b){this._onEvent=b;this._type=a||0;this._listenerID=c||
""},_setPaused:function(a){this._paused=a},_isPaused:function(){return this._paused},_setRegistered:function(a){this._registered=a},_isRegistered:function(){return this._registered},_getType:function(){return this._type},_getListenerID:function(){return this._listenerID},_setFixedPriority:function(a){this._fixedPriority=a},_getFixedPriority:function(){return this._fixedPriority},_setSceneGraphPriority:function(a){this._node=a},_getSceneGraphPriority:function(){return this._node},checkAvailable:function(){return null!==
this._onEvent},clone:function(){return null},setEnabled:function(a){this._isEnabled=a},isEnabled:function(){return this._isEnabled},retain:function(){},release:function(){}}),cc.EventListener.UNKNOWN=0,cc.EventListener.TOUCH_ONE_BY_ONE=1,cc.EventListener.TOUCH_ALL_AT_ONCE=2,cc.EventListener.KEYBOARD=3,cc.EventListener.MOUSE=4,cc.EventListener.ACCELERATION=5,cc.EventListener.ACCELERATION=6,cc.EventListener.CUSTOM=8,cc.EventListener.FOCUS=7,cc._EventListenerCustom=cc.EventListener.extend({_onCustomEvent:null,
ctor:function(a,c){this._onCustomEvent=c;var b=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.CUSTOM,a,function(a){null!==b._onCustomEvent&&b._onCustomEvent(a)})},checkAvailable:function(){return cc.EventListener.prototype.checkAvailable.call(this)&&null!==this._onCustomEvent},clone:function(){return new cc._EventListenerCustom(this._listenerID,this._onCustomEvent)}}),cc._EventListenerCustom.create=function(a,c){return new cc._EventListenerCustom(a,c)},cc._EventListenerMouse=cc.EventListener.extend({onMouseDown:null,
onMouseUp:null,onMouseMove:null,onMouseScroll:null,ctor:function(){var a=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.MOUSE,cc._EventListenerMouse.LISTENER_ID,function(c){var b=cc.EventMouse;switch(c._eventType){case b.DOWN:a.onMouseDown&&a.onMouseDown(c);break;case b.UP:a.onMouseUp&&a.onMouseUp(c);break;case b.MOVE:a.onMouseMove&&a.onMouseMove(c);break;case b.SCROLL:a.onMouseScroll&&a.onMouseScroll(c)}})},clone:function(){var a=new cc._EventListenerMouse;return a.onMouseDown=this.onMouseDown,
a.onMouseUp=this.onMouseUp,a.onMouseMove=this.onMouseMove,a.onMouseScroll=this.onMouseScroll,a},checkAvailable:function(){return!0}}),cc._EventListenerMouse.LISTENER_ID="__cc_mouse",cc._EventListenerMouse.create=function(){return new cc._EventListenerMouse},cc._EventListenerTouchOneByOne=cc.EventListener.extend({_claimedTouches:null,swallowTouches:!1,onTouchBegan:null,onTouchMoved:null,onTouchEnded:null,onTouchCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ONE_BY_ONE,
cc._EventListenerTouchOneByOne.LISTENER_ID,null);this._claimedTouches=[]},setSwallowTouches:function(a){this.swallowTouches=a},isSwallowTouches:function(){return this.swallowTouches},clone:function(){var a=new cc._EventListenerTouchOneByOne;return a.onTouchBegan=this.onTouchBegan,a.onTouchMoved=this.onTouchMoved,a.onTouchEnded=this.onTouchEnded,a.onTouchCancelled=this.onTouchCancelled,a.swallowTouches=this.swallowTouches,a},checkAvailable:function(){return this.onTouchBegan?!0:(cc.log(cc._LogInfos._EventListenerTouchOneByOne_checkAvailable),
!1)}}),cc._EventListenerTouchOneByOne.LISTENER_ID="__cc_touch_one_by_one",cc._EventListenerTouchOneByOne.create=function(){return new cc._EventListenerTouchOneByOne},cc._EventListenerTouchAllAtOnce=cc.EventListener.extend({onTouchesBegan:null,onTouchesMoved:null,onTouchesEnded:null,onTouchesCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ALL_AT_ONCE,cc._EventListenerTouchAllAtOnce.LISTENER_ID,null)},clone:function(){var a=new cc._EventListenerTouchAllAtOnce;
return a.onTouchesBegan=this.onTouchesBegan,a.onTouchesMoved=this.onTouchesMoved,a.onTouchesEnded=this.onTouchesEnded,a.onTouchesCancelled=this.onTouchesCancelled,a},checkAvailable:function(){return null===this.onTouchesBegan&&null===this.onTouchesMoved&&null===this.onTouchesEnded&&null===this.onTouchesCancelled?(cc.log(cc._LogInfos._EventListenerTouchAllAtOnce_checkAvailable),!1):!0}}),cc._EventListenerTouchAllAtOnce.LISTENER_ID="__cc_touch_all_at_once",cc._EventListenerTouchAllAtOnce.create=function(){return new cc._EventListenerTouchAllAtOnce},
cc.EventListener.create=function(a){cc.assert(a&&a.event,cc._LogInfos.EventListener_create);var c=a.event;delete a.event;var b=null;c===cc.EventListener.TOUCH_ONE_BY_ONE?b=new cc._EventListenerTouchOneByOne:c===cc.EventListener.TOUCH_ALL_AT_ONCE?b=new cc._EventListenerTouchAllAtOnce:c===cc.EventListener.MOUSE?b=new cc._EventListenerMouse:c===cc.EventListener.CUSTOM?(b=new cc._EventListenerCustom(a.eventName,a.callback),delete a.eventName,delete a.callback):c===cc.EventListener.KEYBOARD?b=new cc._EventListenerKeyboard:
c===cc.EventListener.ACCELERATION?(b=new cc._EventListenerAcceleration(a.callback),delete a.callback):c===cc.EventListener.FOCUS&&(b=new cc._EventListenerFocus);for(var d in a)b[d]=a[d];return b},cc._EventListenerFocus=cc.EventListener.extend({clone:function(){var a=new cc._EventListenerFocus;return a.onFocusChanged=this.onFocusChanged,a},checkAvailable:function(){return this.onFocusChanged?!0:(cc.log("Invalid EventListenerFocus!"),!1)},onFocusChanged:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,
cc.EventListener.FOCUS,cc._EventListenerFocus.LISTENER_ID,function(a){this.onFocusChanged&&this.onFocusChanged(a._widgetLoseFocus,a._widgetGetFocus)})}}),cc._EventListenerFocus.LISTENER_ID="__cc_focus_event",cc._EventListenerVector=cc.Class.extend({_fixedListeners:null,_sceneGraphListeners:null,gt0Index:0,ctor:function(){this._fixedListeners=[];this._sceneGraphListeners=[]},size:function(){return this._fixedListeners.length+this._sceneGraphListeners.length},empty:function(){return 0===this._fixedListeners.length&&
0===this._sceneGraphListeners.length},push:function(a){0===a._getFixedPriority()?this._sceneGraphListeners.push(a):this._fixedListeners.push(a)},clearSceneGraphListeners:function(){this._sceneGraphListeners.length=0},clearFixedListeners:function(){this._fixedListeners.length=0},clear:function(){this._sceneGraphListeners.length=0;this._fixedListeners.length=0},getFixedPriorityListeners:function(){return this._fixedListeners},getSceneGraphPriorityListeners:function(){return this._sceneGraphListeners}}),
cc.__getListenerID=function(a){var c=cc.Event,b=a.getType();return b===c.ACCELERATION?cc._EventListenerAcceleration.LISTENER_ID:b===c.CUSTOM?a.getEventName():b===c.KEYBOARD?cc._EventListenerKeyboard.LISTENER_ID:b===c.MOUSE?cc._EventListenerMouse.LISTENER_ID:b===c.FOCUS?cc._EventListenerFocus.LISTENER_ID:(b===c.TOUCH&&cc.log(cc._LogInfos.__getListenerID),"")},cc.eventManager={DIRTY_NONE:0,DIRTY_FIXED_PRIORITY:1,DIRTY_SCENE_GRAPH_PRIORITY:2,DIRTY_ALL:3,_listenersMap:{},_priorityDirtyFlagMap:{},_nodeListenersMap:{},
_nodePriorityMap:{},_globalZOrderNodeMap:{},_toAddedListeners:[],_dirtyNodes:[],_inDispatch:0,_isEnabled:!1,_nodePriorityIndex:0,_internalCustomListenerIDs:[cc.game.EVENT_HIDE,cc.game.EVENT_SHOW],_setDirtyForNode:function(a){null!=this._nodeListenersMap[a.__instanceId]&&this._dirtyNodes.push(a);a=a.getChildren();for(var c=0,b=a.length;b>c;c++)this._setDirtyForNode(a[c])},pauseTarget:function(a,c){var b,d,e=this._nodeListenersMap[a.__instanceId];if(e)for(b=0,d=e.length;d>b;b++)e[b]._setPaused(!0);
if(!0===c)for(e=a.getChildren(),b=0,d=e.length;d>b;b++)this.pauseTarget(e[b],!0)},resumeTarget:function(a,c){var b,d,e=this._nodeListenersMap[a.__instanceId];if(e)for(b=0,d=e.length;d>b;b++)e[b]._setPaused(!1);if(this._setDirtyForNode(a),!0===c)for(e=a.getChildren(),b=0,d=e.length;d>b;b++)this.resumeTarget(e[b],!0)},_addListener:function(a){0===this._inDispatch?this._forceAddEventListener(a):this._toAddedListeners.push(a)},_forceAddEventListener:function(a){var c=a._getListenerID(),b=this._listenersMap[c];
(b||(b=new cc._EventListenerVector,this._listenersMap[c]=b),b.push(a),0===a._getFixedPriority())?(this._setDirty(c,this.DIRTY_SCENE_GRAPH_PRIORITY),c=a._getSceneGraphPriority(),null===c&&cc.log(cc._LogInfos.eventManager__forceAddEventListener),this._associateNodeAndEventListener(c,a),c.isRunning()&&this.resumeTarget(c)):this._setDirty(c,this.DIRTY_FIXED_PRIORITY)},_getListeners:function(a){return this._listenersMap[a]},_updateDirtyFlagForSceneGraph:function(){if(0!==this._dirtyNodes.length){for(var a,
c,b=this._dirtyNodes,d=this._nodeListenersMap,e=0,f=b.length;f>e;e++)if(a=d[b[e].__instanceId])for(var g=0,h=a.length;h>g;g++)(c=a[g])&&this._setDirty(c._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY);this._dirtyNodes.length=0}},_removeAllListenersInVector:function(a){if(a)for(var c,b=0;b<a.length;)c=a[b],c._setRegistered(!1),null!=c._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(c._getSceneGraphPriority(),c),c._setSceneGraphPriority(null)),0===this._inDispatch?cc.arrayRemoveObject(a,
c):++b},_removeListenersForListenerID:function(a){var c;if(c=this._listenersMap[a]){var b=c.getFixedPriorityListeners(),d=c.getSceneGraphPriorityListeners();this._removeAllListenersInVector(d);this._removeAllListenersInVector(b);delete this._priorityDirtyFlagMap[a];this._inDispatch||(c.clear(),delete this._listenersMap[a])}d=this._toAddedListeners;for(c=0;c<d.length;)(b=d[c])&&b._getListenerID()===a?cc.arrayRemoveObject(d,b):++c},_sortEventListeners:function(a){var c=this.DIRTY_NONE,b=this._priorityDirtyFlagMap;
if(b[a]&&(c=b[a]),c!==this.DIRTY_NONE&&(b[a]=this.DIRTY_NONE,c&this.DIRTY_FIXED_PRIORITY&&this._sortListenersOfFixedPriority(a),c&this.DIRTY_SCENE_GRAPH_PRIORITY))(c=cc.director.getRunningScene())?this._sortListenersOfSceneGraphPriority(a,c):b[a]=this.DIRTY_SCENE_GRAPH_PRIORITY},_sortListenersOfSceneGraphPriority:function(a,c){var b=this._getListeners(a);if(b){var d=b.getSceneGraphPriorityListeners();d&&0!==d.length&&(this._nodePriorityIndex=0,this._nodePriorityMap={},this._visitTarget(c,!0),b.getSceneGraphPriorityListeners().sort(this._sortEventListenersOfSceneGraphPriorityDes))}},
_sortEventListenersOfSceneGraphPriorityDes:function(a,c){var b=cc.eventManager._nodePriorityMap,d=a._getSceneGraphPriority(),e=c._getSceneGraphPriority();return a&&c&&d&&e&&b[d.__instanceId]&&b[e.__instanceId]?b[c._getSceneGraphPriority().__instanceId]-b[a._getSceneGraphPriority().__instanceId]:-1},_sortListenersOfFixedPriority:function(a){if(a=this._listenersMap[a]){var c=a.getFixedPriorityListeners();if(c&&0!==c.length){c.sort(this._sortListenersOfFixedPriorityAsc);for(var b=0,d=c.length;d>b&&!(0<=
c[b]._getFixedPriority());)++b;a.gt0Index=b}}},_sortListenersOfFixedPriorityAsc:function(a,c){return a._getFixedPriority()-c._getFixedPriority()},_onUpdateListeners:function(a){if(a=this._listenersMap[a]){var c,b,d=a.getFixedPriorityListeners(),e=a.getSceneGraphPriorityListeners();if(e)for(c=0;c<e.length;)b=e[c],b._isRegistered()?++c:cc.arrayRemoveObject(e,b);if(d)for(c=0;c<d.length;)b=d[c],b._isRegistered()?++c:cc.arrayRemoveObject(d,b);e&&0===e.length&&a.clearSceneGraphListeners();d&&0===d.length&&
a.clearFixedListeners()}},_updateListeners:function(a){var c=this._inDispatch;if(cc.assert(0<c,cc._LogInfos.EventManager__updateListeners),!(1<c)){a.getType()===cc.Event.TOUCH?(this._onUpdateListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),this._onUpdateListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID)):this._onUpdateListeners(cc.__getListenerID(a));cc.assert(1===c,cc._LogInfos.EventManager__updateListeners_2);a=this._listenersMap;var c=this._priorityDirtyFlagMap,b;for(b in a)a[b].empty()&&
(delete c[b],delete a[b]);b=this._toAddedListeners;if(0!==b.length){a=0;for(c=b.length;c>a;a++)this._forceAddEventListener(b[a]);this._toAddedListeners.length=0}}},_onTouchEventCallback:function(a,c){if(!a._isRegistered)return!1;var b=c.event,d=c.selTouch;b._setCurrentTarget(a._node);var e,f=!1,g=b.getEventCode(),h=cc.EventTouch.EventCode;return g===h.BEGAN?a.onTouchBegan&&(f=a.onTouchBegan(d,b),f&&a._registered&&a._claimedTouches.push(d)):0<a._claimedTouches.length&&-1!==(e=a._claimedTouches.indexOf(d))&&
(f=!0,g===h.MOVED&&a.onTouchMoved?a.onTouchMoved(d,b):g===h.ENDED?(a.onTouchEnded&&a.onTouchEnded(d,b),a._registered&&a._claimedTouches.splice(e,1)):g===h.CANCELLED&&(a.onTouchCancelled&&a.onTouchCancelled(d,b),a._registered&&a._claimedTouches.splice(e,1))),b.isStopped()?(cc.eventManager._updateListeners(b),!0):f&&a._registered&&a.swallowTouches?(c.needsMutableSet&&c.touches.splice(d,1),!0):!1},_dispatchTouchEvent:function(a){this._sortEventListeners(cc._EventListenerTouchOneByOne.LISTENER_ID);this._sortEventListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);
var c=this._getListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),b=this._getListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);if(null!==c||null!==b){var d=a.getTouches(),e=cc.copyArray(d),f={event:a,needsMutableSet:c&&b,touches:e,selTouch:null};if(c)for(var g=0;g<d.length;g++)if(f.selTouch=d[g],this._dispatchEventToListeners(c,this._onTouchEventCallback,f),a.isStopped())return;b&&0<e.length&&(this._dispatchEventToListeners(b,this._onTouchesEventCallback,{event:a,touches:e}),a.isStopped())||
this._updateListeners(a)}},_onTouchesEventCallback:function(a,c){if(!a._registered)return!1;var b=cc.EventTouch.EventCode,d=c.event,e=c.touches,f=d.getEventCode();return d._setCurrentTarget(a._node),f===b.BEGAN&&a.onTouchesBegan?a.onTouchesBegan(e,d):f===b.MOVED&&a.onTouchesMoved?a.onTouchesMoved(e,d):f===b.ENDED&&a.onTouchesEnded?a.onTouchesEnded(e,d):f===b.CANCELLED&&a.onTouchesCancelled&&a.onTouchesCancelled(e,d),d.isStopped()?(cc.eventManager._updateListeners(d),!0):!1},_associateNodeAndEventListener:function(a,
c){var b=this._nodeListenersMap[a.__instanceId];b||(b=[],this._nodeListenersMap[a.__instanceId]=b);b.push(c)},_dissociateNodeAndEventListener:function(a,c){var b=this._nodeListenersMap[a.__instanceId];b&&(cc.arrayRemoveObject(b,c),0===b.length&&delete this._nodeListenersMap[a.__instanceId])},_dispatchEventToListeners:function(a,c,b){var d,e=!1,f=a.getFixedPriorityListeners(),g=a.getSceneGraphPriorityListeners(),h=0;if(f&&0!==f.length)for(;h<a.gt0Index;++h)if(d=f[h],d.isEnabled()&&!d._isPaused()&&
d._isRegistered()&&c(d,b)){e=!0;break}if(g&&!e)for(a=0;a<g.length;a++)if(d=g[a],d.isEnabled()&&!d._isPaused()&&d._isRegistered()&&c(d,b)){e=!0;break}if(f&&!e)for(;h<f.length&&(d=f[h],!d.isEnabled()||d._isPaused()||!d._isRegistered()||!c(d,b));++h);},_setDirty:function(a,c){var b=this._priorityDirtyFlagMap;null==b[a]?b[a]=c:b[a]|=c},_visitTarget:function(a,c){var b=a.getChildren(),d=0,e=b.length,f=this._globalZOrderNodeMap,g=this._nodeListenersMap;if(0<e){for(var h;e>d&&(h=b[d],h&&0>h.getLocalZOrder());d++)this._visitTarget(h,
!1);for(null!=g[a.__instanceId]&&(f[a.getGlobalZOrder()]||(f[a.getGlobalZOrder()]=[]),f[a.getGlobalZOrder()].push(a.__instanceId));e>d;d++)(h=b[d])&&this._visitTarget(h,!1)}else null!=g[a.__instanceId]&&(f[a.getGlobalZOrder()]||(f[a.getGlobalZOrder()]=[]),f[a.getGlobalZOrder()].push(a.__instanceId));if(c){var b=[],k;for(k in f)b.push(k);b.sort(this._sortNumberAsc);g=b.length;h=this._nodePriorityMap;for(d=0;g>d;d++)for(k=f[b[d]],e=0;e<k.length;e++)h[k[e]]=++this._nodePriorityIndex;this._globalZOrderNodeMap=
{}}},_sortNumberAsc:function(a,c){return a-c},addListener:function(a,c){if(cc.assert(a&&c,cc._LogInfos.eventManager_addListener_2),a instanceof cc.EventListener){if(a._isRegistered())return void cc.log(cc._LogInfos.eventManager_addListener_4)}else cc.assert(!cc.isNumber(c),cc._LogInfos.eventManager_addListener_3),a=cc.EventListener.create(a);if(a.checkAvailable()){if(cc.isNumber(c)){if(0===c)return void cc.log(cc._LogInfos.eventManager_addListener);a._setSceneGraphPriority(null);a._setFixedPriority(c);
a._setRegistered(!0);a._setPaused(!1)}else a._setSceneGraphPriority(c),a._setFixedPriority(0),a._setRegistered(!0);this._addListener(a);return a}},addCustomListener:function(a,c){var b=new cc._EventListenerCustom(a,c);return this.addListener(b,1),b},removeListener:function(a){if(null!=a){var c,b=this._listenersMap,d;for(d in b){var e=b[d],f=e.getFixedPriorityListeners(),g=e.getSceneGraphPriorityListeners();if(c=this._removeListenerInVector(g,a),c?this._setDirty(a._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY):
(c=this._removeListenerInVector(f,a),c&&this._setDirty(a._getListenerID(),this.DIRTY_FIXED_PRIORITY)),e.empty()&&(delete this._priorityDirtyFlagMap[a._getListenerID()],delete b[d]),c)break}if(!c)for(c=this._toAddedListeners,b=0,d=c.length;d>b;b++)if(e=c[b],e===a){cc.arrayRemoveObject(c,e);e._setRegistered(!1);break}}},_removeListenerInVector:function(a,c){if(null==a)return!1;for(var b=0,d=a.length;d>b;b++){var e=a[b];if(e===c)return e._setRegistered(!1),null!=e._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(e._getSceneGraphPriority(),
e),e._setSceneGraphPriority(null)),0===this._inDispatch&&cc.arrayRemoveObject(a,e),!0}return!1},removeListeners:function(a,c){if(a instanceof cc.Node){delete this._nodePriorityMap[a.__instanceId];cc.arrayRemoveObject(this._dirtyNodes,a);var b;if(b=this._nodeListenersMap[a.__instanceId]){var d=cc.copyArray(b);for(b=0;b<d.length;b++)this.removeListener(d[b]);d.length=0}d=this._toAddedListeners;for(b=0;b<d.length;){var e=d[b];e._getSceneGraphPriority()===a?(e._setSceneGraphPriority(null),e._setRegistered(!1),
d.splice(b,1)):++b}if(!0===c)for(e=a.getChildren(),b=0,d=e.length;d>b;b++)this.removeListeners(e[b],!0)}else a===cc.EventListener.TOUCH_ONE_BY_ONE?this._removeListenersForListenerID(cc._EventListenerTouchOneByOne.LISTENER_ID):a===cc.EventListener.TOUCH_ALL_AT_ONCE?this._removeListenersForListenerID(cc._EventListenerTouchAllAtOnce.LISTENER_ID):a===cc.EventListener.MOUSE?this._removeListenersForListenerID(cc._EventListenerMouse.LISTENER_ID):a===cc.EventListener.ACCELERATION?this._removeListenersForListenerID(cc._EventListenerAcceleration.LISTENER_ID):
a===cc.EventListener.KEYBOARD?this._removeListenersForListenerID(cc._EventListenerKeyboard.LISTENER_ID):cc.log(cc._LogInfos.eventManager_removeListeners)},removeCustomListeners:function(a){this._removeListenersForListenerID(a)},removeAllListeners:function(){var a=this._listenersMap,c=this._internalCustomListenerIDs,b;for(b in a)-1===c.indexOf(b)&&this._removeListenersForListenerID(b)},setPriority:function(a,c){if(null!=a){var b=this._listenersMap,d;for(d in b){var e=b[d].getFixedPriorityListeners();
if(e&&-1!==e.indexOf(a))return null!=a._getSceneGraphPriority()&&cc.log(cc._LogInfos.eventManager_setPriority),void(a._getFixedPriority()!==c&&(a._setFixedPriority(c),this._setDirty(a._getListenerID(),this.DIRTY_FIXED_PRIORITY)))}}},setEnabled:function(a){this._isEnabled=a},isEnabled:function(){return this._isEnabled},dispatchEvent:function(a){if(this._isEnabled){if(this._updateDirtyFlagForSceneGraph(),this._inDispatch++,!a||!a.getType)throw"event is undefined";if(a.getType()===cc.Event.TOUCH)return this._dispatchTouchEvent(a),
void this._inDispatch--;var c=cc.__getListenerID(a);this._sortEventListeners(c);c=this._listenersMap[c];null!=c&&this._dispatchEventToListeners(c,this._onListenerCallback,a);this._updateListeners(a);this._inDispatch--}},_onListenerCallback:function(a,c){return c._setCurrentTarget(a._getSceneGraphPriority()),a._onEvent(c),c.isStopped()},dispatchCustomEvent:function(a,c){var b=new cc.EventCustom(a);b.setUserData(c);this.dispatchEvent(b)}},cc.EventHelper=function(){},cc.EventHelper.prototype={constructor:cc.EventHelper,
apply:function(a){a.addEventListener=cc.EventHelper.prototype.addEventListener;a.hasEventListener=cc.EventHelper.prototype.hasEventListener;a.removeEventListener=cc.EventHelper.prototype.removeEventListener;a.dispatchEvent=cc.EventHelper.prototype.dispatchEvent},addEventListener:function(a,c,b){if("load"===a&&this._textureLoaded)return void setTimeout(function(){c.call(b)},0);void 0===this._listeners&&(this._listeners={});var d=this._listeners;void 0===d[a]&&(d[a]=[]);this.hasEventListener(a,c,b)||
d[a].push({callback:c,eventTarget:b})},hasEventListener:function(a,c,b){if(void 0===this._listeners)return!1;var d=this._listeners;if(void 0!==d[a]){a=0;for(var e=d.length;e>a;a++){var f=d[a];if(f.callback===c&&f.eventTarget===b)return!0}}return!1},removeEventListener:function(a,c){if(void 0!==this._listeners){var b=this._listeners[a];if(void 0!==b)for(var d=0;d<b.length;)b[d].eventTarget===c?b.splice(d,1):d++}},dispatchEvent:function(a,c){if(void 0!==this._listeners){null==c&&(c=!0);var b=this._listeners[a];
if(void 0!==b){for(var d=[],e=b.length,f=0;e>f;f++)d[f]=b[f];for(f=0;e>f;f++)d[f].callback.call(d[f].eventTarget,this);c&&(b.length=0)}}}},cc._tmp.PrototypeCCNode=function(){var a=cc.Node.prototype;cc.defineGetterSetter(a,"x",a.getPositionX,a.setPositionX);cc.defineGetterSetter(a,"y",a.getPositionY,a.setPositionY);a.width;cc.defineGetterSetter(a,"width",a._getWidth,a._setWidth);a.height;cc.defineGetterSetter(a,"height",a._getHeight,a._setHeight);a.anchorX;cc.defineGetterSetter(a,"anchorX",a._getAnchorX,
a._setAnchorX);a.anchorY;cc.defineGetterSetter(a,"anchorY",a._getAnchorY,a._setAnchorY);a.skewX;cc.defineGetterSetter(a,"skewX",a.getSkewX,a.setSkewX);a.skewY;cc.defineGetterSetter(a,"skewY",a.getSkewY,a.setSkewY);a.zIndex;cc.defineGetterSetter(a,"zIndex",a.getLocalZOrder,a.setLocalZOrder);a.vertexZ;cc.defineGetterSetter(a,"vertexZ",a.getVertexZ,a.setVertexZ);a.rotation;cc.defineGetterSetter(a,"rotation",a.getRotation,a.setRotation);a.rotationX;cc.defineGetterSetter(a,"rotationX",a.getRotationX,a.setRotationX);
a.rotationY;cc.defineGetterSetter(a,"rotationY",a.getRotationY,a.setRotationY);a.scale;cc.defineGetterSetter(a,"scale",a.getScale,a.setScale);a.scaleX;cc.defineGetterSetter(a,"scaleX",a.getScaleX,a.setScaleX);a.scaleY;cc.defineGetterSetter(a,"scaleY",a.getScaleY,a.setScaleY);a.children;cc.defineGetterSetter(a,"children",a.getChildren);a.childrenCount;cc.defineGetterSetter(a,"childrenCount",a.getChildrenCount);a.parent;cc.defineGetterSetter(a,"parent",a.getParent,a.setParent);a.visible;cc.defineGetterSetter(a,
"visible",a.isVisible,a.setVisible);a.running;cc.defineGetterSetter(a,"running",a.isRunning);a.ignoreAnchor;cc.defineGetterSetter(a,"ignoreAnchor",a.isIgnoreAnchorPointForPosition,a.ignoreAnchorPointForPosition);a.tag;a.userData;a.userObject;a.arrivalOrder;a.actionManager;cc.defineGetterSetter(a,"actionManager",a.getActionManager,a.setActionManager);a.scheduler;cc.defineGetterSetter(a,"scheduler",a.getScheduler,a.setScheduler);a.shaderProgram;cc.defineGetterSetter(a,"shaderProgram",a.getShaderProgram,
a.setShaderProgram);a.opacity;cc.defineGetterSetter(a,"opacity",a.getOpacity,a.setOpacity);a.opacityModifyRGB;cc.defineGetterSetter(a,"opacityModifyRGB",a.isOpacityModifyRGB);a.cascadeOpacity;cc.defineGetterSetter(a,"cascadeOpacity",a.isCascadeOpacityEnabled,a.setCascadeOpacityEnabled);a.color;cc.defineGetterSetter(a,"color",a.getColor,a.setColor);a.cascadeColor;cc.defineGetterSetter(a,"cascadeColor",a.isCascadeColorEnabled,a.setCascadeColorEnabled)},cc.NODE_TAG_INVALID=-1,cc.s_globalOrderOfArrival=
1,cc.Node=cc.Class.extend({_localZOrder:0,_globalZOrder:0,_vertexZ:0,_rotationX:0,_rotationY:0,_scaleX:1,_scaleY:1,_position:null,_normalizedPosition:null,_usingNormalizedPosition:!1,_normalizedPositionDirty:!1,_skewX:0,_skewY:0,_children:null,_visible:!0,_anchorPoint:null,_contentSize:null,_running:!1,_parent:null,_ignoreAnchorPointForPosition:!1,tag:cc.NODE_TAG_INVALID,userData:null,userObject:null,_reorderChildDirty:!1,_shaderProgram:null,arrivalOrder:0,_actionManager:null,_scheduler:null,_eventDispatcher:null,
_additionalTransformDirty:!1,_additionalTransform:null,_componentContainer:null,_isTransitionFinished:!1,_className:"Node",_showNode:!1,_name:"",_realOpacity:255,_realColor:null,_cascadeColorEnabled:!1,_cascadeOpacityEnabled:!1,_renderCmd:null,_camera:null,ctor:function(){this._initNode();this._initRendererCmd()},_initNode:function(){this._anchorPoint=cc.p(0,0);this._contentSize=cc.size(0,0);this._position=cc.p(0,0);this._normalizedPosition=cc.p(0,0);this._children=[];var a=cc.director;this._actionManager=
a.getActionManager();this._scheduler=a.getScheduler();this._additionalTransform=cc.affineTransformMakeIdentity();cc.ComponentContainer&&(this._componentContainer=new cc.ComponentContainer(this));this._realOpacity=255;this._realColor=cc.color(255,255,255,255);this._cascadeOpacityEnabled=this._cascadeColorEnabled=!1},init:function(){return!0},_arrayMakeObjectsPerformSelector:function(a,c){if(a&&0!==a.length){var b,d,e=a.length;b=cc.Node._stateCallbackType;switch(c){case b.onEnter:for(b=0;e>b;b++)(d=
a[b])&&d.onEnter();break;case b.onExit:for(b=0;e>b;b++)(d=a[b])&&d.onExit();break;case b.onEnterTransitionDidFinish:for(b=0;e>b;b++)(d=a[b])&&d.onEnterTransitionDidFinish();break;case b.cleanup:for(b=0;e>b;b++)(d=a[b])&&d.cleanup();break;case b.updateTransform:for(b=0;e>b;b++)(d=a[b])&&d.updateTransform();break;case b.onExitTransitionDidStart:for(b=0;e>b;b++)(d=a[b])&&d.onExitTransitionDidStart();break;case b.sortAllChildren:for(b=0;e>b;b++)(d=a[b])&&d.sortAllChildren();break;default:cc.assert(0,
cc._LogInfos.Node__arrayMakeObjectsPerformSelector)}}},attr:function(a){for(var c in a)this[c]=a[c]},getSkewX:function(){return this._skewX},setSkewX:function(a){this._skewX=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getSkewY:function(){return this._skewY},setSkewY:function(a){this._skewY=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setLocalZOrder:function(a){this._localZOrder=a;this._parent&&this._parent.reorderChild(this,a);cc.eventManager._setDirtyForNode(this)},
_setLocalZOrder:function(a){this._localZOrder=a},getLocalZOrder:function(){return this._localZOrder},getZOrder:function(){return cc.log(cc._LogInfos.Node_getZOrder),this.getLocalZOrder()},setZOrder:function(a){cc.log(cc._LogInfos.Node_setZOrder);this.setLocalZOrder(a)},setGlobalZOrder:function(a){this._globalZOrder!==a&&(this._globalZOrder=a,cc.eventManager._setDirtyForNode(this))},getGlobalZOrder:function(){return this._globalZOrder},getVertexZ:function(){return this._vertexZ},setVertexZ:function(a){this._vertexZ=
a},getRotation:function(){return this._rotationX!==this._rotationY&&cc.log(cc._LogInfos.Node_getRotation),this._rotationX},setRotation:function(a){this._rotationX=this._rotationY=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getRotationX:function(){return this._rotationX},setRotationX:function(a){this._rotationX=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getRotationY:function(){return this._rotationY},setRotationY:function(a){this._rotationY=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},
getScale:function(){return this._scaleX!==this._scaleY&&cc.log(cc._LogInfos.Node_getScale),this._scaleX},setScale:function(a,c){this._scaleX=a;this._scaleY=c||0===c?c:a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScaleX:function(){return this._scaleX},setScaleX:function(a){this._scaleX=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScaleY:function(){return this._scaleY},setScaleY:function(a){this._scaleY=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},
setPosition:function(a,c){var b=this._position;if(void 0===c){if(b.x===a.x&&b.y===a.y)return;b.x=a.x;b.y=a.y}else{if(b.x===a&&b.y===c)return;b.x=a;b.y=c}this._usingNormalizedPosition=!1;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setNormalizedPosition:function(a,c){var b=this._normalizedPosition;void 0===c?(b.x=a.x,b.y=a.y):(b.x=a,b.y=c);this._normalizedPositionDirty=this._usingNormalizedPosition=!0;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getPosition:function(){return cc.p(this._position)},
getNormalizedPosition:function(){return cc.p(this._normalizedPosition)},getPositionX:function(){return this._position.x},setPositionX:function(a){this._position.x=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getPositionY:function(){return this._position.y},setPositionY:function(a){this._position.y=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getChildrenCount:function(){return this._children.length},getChildren:function(){return this._children},isVisible:function(){return this._visible},
setVisible:function(a){this._visible!==a&&(this._visible=a,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),cc.renderer.childrenOrderDirty=!0)},getAnchorPoint:function(){return cc.p(this._anchorPoint)},setAnchorPoint:function(a,c){var b=this._anchorPoint;if(void 0===c){if(a.x===b.x&&a.y===b.y)return;b.x=a.x;b.y=a.y}else{if(a===b.x&&c===b.y)return;b.x=a;b.y=c}this._renderCmd._updateAnchorPointInPoint()},_getAnchorX:function(){return this._anchorPoint.x},_setAnchorX:function(a){this._anchorPoint.x!==
a&&(this._anchorPoint.x=a,this._renderCmd._updateAnchorPointInPoint())},_getAnchorY:function(){return this._anchorPoint.y},_setAnchorY:function(a){this._anchorPoint.y!==a&&(this._anchorPoint.y=a,this._renderCmd._updateAnchorPointInPoint())},getAnchorPointInPoints:function(){return this._renderCmd.getAnchorPointInPoints()},_getWidth:function(){return this._contentSize.width},_setWidth:function(a){this._contentSize.width=a;this._renderCmd._updateAnchorPointInPoint()},_getHeight:function(){return this._contentSize.height},
_setHeight:function(a){this._contentSize.height=a;this._renderCmd._updateAnchorPointInPoint()},getContentSize:function(){return cc.size(this._contentSize)},setContentSize:function(a,c){var b=this._contentSize;if(void 0===c){if(a.width===b.width&&a.height===b.height)return;b.width=a.width;b.height=a.height}else{if(a===b.width&&c===b.height)return;b.width=a;b.height=c}this._renderCmd._updateAnchorPointInPoint()},isRunning:function(){return this._running},getParent:function(){return this._parent},setParent:function(a){this._parent=
a},isIgnoreAnchorPointForPosition:function(){return this._ignoreAnchorPointForPosition},ignoreAnchorPointForPosition:function(a){a!==this._ignoreAnchorPointForPosition&&(this._ignoreAnchorPointForPosition=a,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty))},getTag:function(){return this.tag},setTag:function(a){this.tag=a},setName:function(a){this._name=a},getName:function(){return this._name},getUserData:function(){return this.userData},setUserData:function(a){this.userData=a},getUserObject:function(){return this.userObject},
setUserObject:function(a){this.userObject!==a&&(this.userObject=a)},getOrderOfArrival:function(){return this.arrivalOrder},setOrderOfArrival:function(a){this.arrivalOrder=a},getActionManager:function(){return this._actionManager||(this._actionManager=cc.director.getActionManager()),this._actionManager},setActionManager:function(a){this._actionManager!==a&&(this.stopAllActions(),this._actionManager=a)},getScheduler:function(){return this._scheduler||(this._scheduler=cc.director.getScheduler()),this._scheduler},
setScheduler:function(a){this._scheduler!==a&&(this.unscheduleAllCallbacks(),this._scheduler=a)},boundingBox:function(){return cc.log(cc._LogInfos.Node_boundingBox),this.getBoundingBox()},getBoundingBox:function(){var a=cc.rect(0,0,this._contentSize.width,this._contentSize.height);return cc._rectApplyAffineTransformIn(a,this.getNodeToParentTransform())},cleanup:function(){this.stopAllActions();this.unscheduleAllCallbacks();cc.eventManager.removeListeners(this);this._arrayMakeObjectsPerformSelector(this._children,
cc.Node._stateCallbackType.cleanup)},getChildByTag:function(a){var c=this._children;if(null!==c)for(var b=0;b<c.length;b++){var d=c[b];if(d&&d.tag===a)return d}return null},getChildByName:function(a){if(!a)return cc.log("Invalid name"),null;for(var c=this._children,b=0,d=c.length;d>b;b++)if(c[b]._name===a)return c[b];return null},addChild:function(a,c,b){c=void 0===c?a._localZOrder:c;var d,e=!1;cc.isUndefined(b)?(b=void 0,d=a._name):cc.isString(b)?(d=b,b=void 0):cc.isNumber(b)&&(e=!0,d="");cc.assert(a,
cc._LogInfos.Node_addChild_3);cc.assert(null===a._parent,"child already added. It can't be added again");this._addChildHelper(a,c,b,d,e)},_addChildHelper:function(a,c,b,d,e){this._children||(this._children=[]);this._insertChild(a,c);e?a.setTag(b):a.setName(d);a.setParent(this);a.setOrderOfArrival(cc.s_globalOrderOfArrival++);this._running&&(a.onEnter(),this._isTransitionFinished&&a.onEnterTransitionDidFinish());this._cascadeColorEnabled&&a._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty);this._cascadeOpacityEnabled&&
a._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},removeFromParent:function(a){this._parent&&(void 0===a&&(a=!0),this._parent.removeChild(this,a))},removeFromParentAndCleanup:function(a){cc.log(cc._LogInfos.Node_removeFromParentAndCleanup);this.removeFromParent(a)},removeChild:function(a,c){0!==this._children.length&&(void 0===c&&(c=!0),-1<this._children.indexOf(a)&&this._detachChild(a,c),cc.renderer.childrenOrderDirty=!0)},removeChildByTag:function(a,c){a===cc.NODE_TAG_INVALID&&cc.log(cc._LogInfos.Node_removeChildByTag);
var b=this.getChildByTag(a);b?this.removeChild(b,c):cc.log(cc._LogInfos.Node_removeChildByTag_2,a)},removeAllChildrenWithCleanup:function(a){this.removeAllChildren(a)},removeAllChildren:function(a){var c=this._children;if(null!==c){void 0===a&&(a=!0);for(var b=0;b<c.length;b++){var d=c[b];d&&(this._running&&(d.onExitTransitionDidStart(),d.onExit()),a&&d.cleanup(),d.parent=null,d._renderCmd.detachFromParent())}this._children.length=0;cc.renderer.childrenOrderDirty=!0}},_detachChild:function(a,c){this._running&&
(a.onExitTransitionDidStart(),a.onExit());c&&a.cleanup();a.parent=null;a._renderCmd.detachFromParent();cc.arrayRemoveObject(this._children,a)},_insertChild:function(a,c){cc.renderer.childrenOrderDirty=this._reorderChildDirty=!0;this._children.push(a);a._setLocalZOrder(c)},setNodeDirty:function(){this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},reorderChild:function(a,c){cc.assert(a,cc._LogInfos.Node_reorderChild);cc.renderer.childrenOrderDirty=this._reorderChildDirty=!0;a.arrivalOrder=
cc.s_globalOrderOfArrival;cc.s_globalOrderOfArrival++;a._setLocalZOrder(c)},sortAllChildren:function(){if(this._reorderChildDirty){var a,c,b,d=this._children,e=d.length;for(a=1;e>a;a++){b=d[a];for(c=a-1;0<=c&&(b._localZOrder<d[c]._localZOrder||b._localZOrder===d[c]._localZOrder&&b.arrivalOrder<d[c].arrivalOrder);)d[c+1]=d[c],c--;d[c+1]=b}this._reorderChildDirty=!1}},draw:function(a){},transformAncestors:function(){null!==this._parent&&(this._parent.transformAncestors(),this._parent.transform())},
onEnter:function(){this._isTransitionFinished=!1;this._running=!0;this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onEnter);this.resume()},onEnterTransitionDidFinish:function(){this._isTransitionFinished=!0;this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onEnterTransitionDidFinish)},onExitTransitionDidStart:function(){this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onExitTransitionDidStart)},onExit:function(){this._running=
!1;this.pause();this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onExit);this.removeAllComponents()},runAction:function(a){return cc.assert(a,cc._LogInfos.Node_runAction),this.actionManager.addAction(a,this,!this._running),a},stopAllActions:function(){this.actionManager&&this.actionManager.removeAllActionsFromTarget(this)},stopAction:function(a){this.actionManager.removeAction(a)},stopActionByTag:function(a){return a===cc.ACTION_TAG_INVALID?void cc.log(cc._LogInfos.Node_stopActionByTag):
void this.actionManager.removeActionByTag(a,this)},getActionByTag:function(a){return a===cc.ACTION_TAG_INVALID?(cc.log(cc._LogInfos.Node_getActionByTag),null):this.actionManager.getActionByTag(a,this)},getNumberOfRunningActions:function(){return this.actionManager.numberOfRunningActionsInTarget(this)},scheduleUpdate:function(){this.scheduleUpdateWithPriority(0)},scheduleUpdateWithPriority:function(a){this.scheduler.scheduleUpdate(this,a,!this._running)},unscheduleUpdate:function(){this.scheduler.unscheduleUpdate(this)},
schedule:function(a,c,b,d,e){var f=arguments.length;"function"==typeof a?1===f?(c=0,b=cc.REPEAT_FOREVER,d=0,e=this.__instanceId):2===f?"number"==typeof c?(b=cc.REPEAT_FOREVER,d=0,e=this.__instanceId):(e=c,c=0,b=cc.REPEAT_FOREVER,d=0):3===f?("string"==typeof b?(e=b,b=cc.REPEAT_FOREVER):e=this.__instanceId,d=0):4===f&&(e=this.__instanceId):1===f?(c=0,b=cc.REPEAT_FOREVER,d=0):2===f&&(b=cc.REPEAT_FOREVER,d=0);cc.assert(a,cc._LogInfos.Node_schedule);cc.assert(0<=c,cc._LogInfos.Node_schedule_2);b=null==
b?cc.REPEAT_FOREVER:b;this.scheduler.schedule(a,this,c||0,b,d||0,!this._running,e)},scheduleOnce:function(a,c,b){void 0===b&&(b=this.__instanceId);this.schedule(a,0,0,c,b)},unschedule:function(a){a&&this.scheduler.unschedule(a,this)},unscheduleAllCallbacks:function(){this.scheduler.unscheduleAllForTarget(this)},resumeSchedulerAndActions:function(){cc.log(cc._LogInfos.Node_resumeSchedulerAndActions);this.resume()},resume:function(){this.scheduler.resumeTarget(this);this.actionManager&&this.actionManager.resumeTarget(this);
cc.eventManager.resumeTarget(this)},pauseSchedulerAndActions:function(){cc.log(cc._LogInfos.Node_pauseSchedulerAndActions);this.pause()},pause:function(){this.scheduler.pauseTarget(this);this.actionManager&&this.actionManager.pauseTarget(this);cc.eventManager.pauseTarget(this)},setAdditionalTransform:function(a){return void 0===a?this._additionalTransformDirty=!1:(this._additionalTransform=a,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),void(this._additionalTransformDirty=!0))},
getParentToNodeTransform:function(){this._renderCmd.getParentToNodeTransform()},parentToNodeTransform:function(){return this.getParentToNodeTransform()},getNodeToWorldTransform:function(){for(var a=this.getNodeToParentTransform(),c=this._parent;null!==c;c=c.parent)a=cc.affineTransformConcat(a,c.getNodeToParentTransform());return a},nodeToWorldTransform:function(){return this.getNodeToWorldTransform()},getWorldToNodeTransform:function(){return cc.affineTransformInvert(this.getNodeToWorldTransform())},
worldToNodeTransform:function(){return this.getWorldToNodeTransform()},convertToNodeSpace:function(a){return cc.pointApplyAffineTransform(a,this.getWorldToNodeTransform())},convertToWorldSpace:function(a){return a=a||cc.p(0,0),cc.pointApplyAffineTransform(a,this.getNodeToWorldTransform())},convertToNodeSpaceAR:function(a){return cc.pSub(this.convertToNodeSpace(a),this._renderCmd.getAnchorPointInPoints())},convertToWorldSpaceAR:function(a){a=a||cc.p(0,0);a=cc.pAdd(a,this._renderCmd.getAnchorPointInPoints());
return this.convertToWorldSpace(a)},_convertToWindowSpace:function(a){a=this.convertToWorldSpace(a);return cc.director.convertToUI(a)},convertTouchToNodeSpace:function(a){a=a.getLocation();return this.convertToNodeSpace(a)},convertTouchToNodeSpaceAR:function(a){a=cc.director.convertToGL(a.getLocation());return this.convertToNodeSpaceAR(a)},update:function(a){this._componentContainer&&!this._componentContainer.isEmpty()&&this._componentContainer.visit(a)},updateTransform:function(){this._arrayMakeObjectsPerformSelector(this._children,
cc.Node._stateCallbackType.updateTransform)},retain:function(){},release:function(){},getComponent:function(a){return this._componentContainer?this._componentContainer.getComponent(a):null},addComponent:function(a){this._componentContainer&&this._componentContainer.add(a)},removeComponent:function(a){return this._componentContainer?this._componentContainer.remove(a):!1},removeAllComponents:function(){this._componentContainer&&this._componentContainer.removeAll()},grid:null,visit:function(a){this._renderCmd.visit(a)},
transform:function(a,c){this._renderCmd.transform(a,c)},nodeToParentTransform:function(){return this.getNodeToParentTransform()},getNodeToParentTransform:function(){return this._renderCmd.getNodeToParentTransform()},getCamera:function(){return this._camera||(this._camera=new cc.Camera),this._camera},getGrid:function(){return this.grid},setGrid:function(a){this.grid=a},getShaderProgram:function(){return this._renderCmd.getShaderProgram()},setShaderProgram:function(a){this._renderCmd.setShaderProgram(a)},
getGLServerState:function(){return 0},setGLServerState:function(a){},getBoundingBoxToWorld:function(){var a=cc.rect(0,0,this._contentSize.width,this._contentSize.height),c=this.getNodeToWorldTransform();if(a=cc.rectApplyAffineTransform(a,c),!this._children)return a;for(var b=this._children,d=0;d<b.length;d++){var e=b[d];e&&e._visible&&(e=e._getBoundingBoxToCurrentNode(c))&&(a=cc.rectUnion(a,e))}return a},_getBoundingBoxToCurrentNode:function(a){var c=cc.rect(0,0,this._contentSize.width,this._contentSize.height);
a=void 0===a?this.getNodeToParentTransform():cc.affineTransformConcat(this.getNodeToParentTransform(),a);if(c=cc.rectApplyAffineTransform(c,a),!this._children)return c;for(var b=this._children,d=0;d<b.length;d++){var e=b[d];e&&e._visible&&(e=e._getBoundingBoxToCurrentNode(a))&&(c=cc.rectUnion(c,e))}return c},getOpacity:function(){return this._realOpacity},getDisplayedOpacity:function(){return this._renderCmd.getDisplayedOpacity()},setOpacity:function(a){this._realOpacity=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},
updateDisplayedOpacity:function(a){this._renderCmd._updateDisplayOpacity(a)},isCascadeOpacityEnabled:function(){return this._cascadeOpacityEnabled},setCascadeOpacityEnabled:function(a){this._cascadeOpacityEnabled!==a&&(this._cascadeOpacityEnabled=a,this._renderCmd.setCascadeOpacityEnabledDirty())},getColor:function(){var a=this._realColor;return cc.color(a.r,a.g,a.b,a.a)},getDisplayedColor:function(){return this._renderCmd.getDisplayedColor()},setColor:function(a){var c=this._realColor;c.r=a.r;c.g=
a.g;c.b=a.b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},updateDisplayedColor:function(a){this._renderCmd._updateDisplayColor(a)},isCascadeColorEnabled:function(){return this._cascadeColorEnabled},setCascadeColorEnabled:function(a){this._cascadeColorEnabled!==a&&(this._cascadeColorEnabled=a,this._renderCmd.setCascadeColorEnabledDirty())},setOpacityModifyRGB:function(a){},isOpacityModifyRGB:function(){return!1},_initRendererCmd:function(){this._renderCmd=cc.renderer.getRenderCmd(this)},
_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.Node.CanvasRenderCmd(this):new cc.Node.WebGLRenderCmd(this)},enumerateChildren:function(a,c){cc.assert(a&&0!=a.length,"Invalid name");cc.assert(null!=c,"Invalid callback function");var b=a.length,d=0,e=b,f=!1;2<b&&"/"===a[0]&&"/"===a[1]&&(f=!0,d=2,e-=2);var g=!1;3<b&&"/"===a[b-3]&&"."===a[b-2]&&"."===a[b-1]&&(g=!0,e-=3);b=a.substr(d,e);g&&(b="[[:alnum:]]+/"+b);f?this.doEnumerateRecursive(this,b,c):this.doEnumerate(b,
c)},doEnumerateRecursive:function(a,c,b){if(!a.doEnumerate(c,b)){var d;a=a.getChildren();for(var e=a.length,f=0;e>f&&(d=a[f],!this.doEnumerateRecursive(d,c,b));f++);}},doEnumerate:function(a,c){var b=a.indexOf("/"),d=a,e=!1;-1!==b&&(d=a.substr(0,b),e=!0);for(var f,b=!1,g=this._children,h=g.length,k=0;h>k;k++)if(f=g[k],-1!==f._name.indexOf(d))if(e){if(b=f.doEnumerate(a,c))break}else if(c(f)){b=!0;break}return b}}),cc.Node.create=function(){return new cc.Node},cc.Node._stateCallbackType={onEnter:1,
onExit:2,cleanup:3,onEnterTransitionDidFinish:4,updateTransform:5,onExitTransitionDidStart:6,sortAllChildren:7},cc.assert(cc.isFunction(cc._tmp.PrototypeCCNode),cc._LogInfos.MissingFile,"BaseNodesPropertyDefine.js"),cc._tmp.PrototypeCCNode(),delete cc._tmp.PrototypeCCNode,cc.CustomRenderCmd=function(a,c){this._needDraw=!0;this._target=a;this._callback=c;this.rendering=function(a,c,e){this._callback&&this._callback.call(this._target,a,c,e)}},cc.Node._dirtyFlags={transformDirty:1,visibleDirty:2,colorDirty:4,
opacityDirty:8,cacheDirty:16,orderDirty:32,textDirty:64,gradientDirty:128,all:255},cc.Node.RenderCmd=function(a){this._dirtyFlag=1;this._node=a;this._needDraw=!1;this._anchorPointInPoints=new cc.Point(0,0);this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0};this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0};this._inverse={a:1,b:0,c:0,d:1,tx:0,ty:0};this._displayedOpacity=255;this._displayedColor=cc.color(255,255,255,255);this._cascadeOpacityEnabledDirty=this._cascadeColorEnabledDirty=!1;this._curLevel=-1},
cc.Node.RenderCmd.prototype={constructor:cc.Node.RenderCmd,getAnchorPointInPoints:function(){return cc.p(this._anchorPointInPoints)},getDisplayedColor:function(){var a=this._displayedColor;return cc.color(a.r,a.g,a.b,a.a)},getDisplayedOpacity:function(){return this._displayedOpacity},setCascadeColorEnabledDirty:function(){this._cascadeColorEnabledDirty=!0;this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},setCascadeOpacityEnabledDirty:function(){this._cascadeOpacityEnabledDirty=!0;this.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},
getParentToNodeTransform:function(){return this._dirtyFlag&cc.Node._dirtyFlags.transformDirty&&(this._inverse=cc.affineTransformInvert(this.getNodeToParentTransform())),this._inverse},detachFromParent:function(){},_updateAnchorPointInPoint:function(){var a=this._anchorPointInPoints,c=this._node._contentSize,b=this._node._anchorPoint;a.x=c.width*b.x;a.y=c.height*b.y;this.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setDirtyFlag:function(a){0===this._dirtyFlag&&0!==a&&cc.renderer.pushDirtyNode(this);
this._dirtyFlag|=a},getParentRenderCmd:function(){return this._node&&this._node._parent&&this._node._parent._renderCmd?this._node._parent._renderCmd:null},_updateDisplayColor:function(a){var c,b,d;c=this._node;var e=this._displayedColor;b=c._realColor;if(this._cascadeColorEnabledDirty&&!c._cascadeColorEnabled){e.r=b.r;e.g=b.g;e.b=b.b;e=new cc.Color(255,255,255,255);a=c._children;c=0;for(b=a.length;b>c;c++)(d=a[c])&&d._renderCmd&&d._renderCmd._updateDisplayColor(e);this._cascadeColorEnabledDirty=!1}else if(void 0===
a&&(a=(a=c._parent)&&a._cascadeColorEnabled?a.getDisplayedColor():cc.color.WHITE),e.r=0|b.r*a.r/255,e.g=0|b.g*a.g/255,e.b=0|b.b*a.b/255,c._cascadeColorEnabled)for(a=c._children,c=0,b=a.length;b>c;c++)(d=a[c])&&d._renderCmd&&(d._renderCmd._updateDisplayColor(e),d._renderCmd._updateColor());this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.colorDirty},_updateDisplayOpacity:function(a){var c,b,d;c=this._node;if(this._cascadeOpacityEnabledDirty&&!c._cascadeOpacityEnabled){this._displayedOpacity=c._realOpacity;
b=c._children;a=0;for(c=b.length;c>a;a++)(d=b[a])&&d._renderCmd&&d._renderCmd._updateDisplayOpacity(255);this._cascadeOpacityEnabledDirty=!1}else if(void 0===a&&(b=c._parent,a=255,b&&b._cascadeOpacityEnabled&&(a=b.getDisplayedOpacity())),this._displayedOpacity=c._realOpacity*a/255,c._cascadeOpacityEnabled)for(b=c._children,a=0,c=b.length;c>a;a++)(d=b[a])&&d._renderCmd&&(d._renderCmd._updateDisplayOpacity(this._displayedOpacity),d._renderCmd._updateColor());this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.opacityDirty},
_syncDisplayColor:function(a){var c=this._node,b=this._displayedColor,d=c._realColor;void 0===a&&(a=(a=c._parent)&&a._cascadeColorEnabled?a.getDisplayedColor():cc.color.WHITE);b.r=0|d.r*a.r/255;b.g=0|d.g*a.g/255;b.b=0|d.b*a.b/255},_syncDisplayOpacity:function(a){var c=this._node;if(void 0===a){var b=c._parent;a=255;b&&b._cascadeOpacityEnabled&&(a=b.getDisplayedOpacity())}this._displayedOpacity=c._realOpacity*a/255},_updateColor:function(){},updateStatus:function(){var a=cc.Node._dirtyFlags,c=this._dirtyFlag,
b=c&a.colorDirty,d=c&a.opacityDirty;b&&this._updateDisplayColor();d&&this._updateDisplayOpacity();(b||d)&&this._updateColor();c&a.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty)}},function(){cc.Node.CanvasRenderCmd=function(a){cc.Node.RenderCmd.call(this,a);this._cachedParent=null;this._cacheDirty=!1};var a=cc.Node.CanvasRenderCmd.prototype=Object.create(cc.Node.RenderCmd.prototype);a.constructor=cc.Node.CanvasRenderCmd;
a.transform=function(a,b){var d=this.getNodeToParentTransform(),e=this._worldTransform;if(this._cacheDirty=!0,a){var f=a._worldTransform;e.a=d.a*f.a+d.b*f.c;e.b=d.a*f.b+d.b*f.d;e.c=d.c*f.a+d.d*f.c;e.d=d.c*f.b+d.d*f.d;e.tx=f.a*d.tx+f.c*d.ty+f.tx;e.ty=f.d*d.ty+f.ty+f.b*d.tx}else e.a=d.a,e.b=d.b,e.c=d.c,e.d=d.d,e.tx=d.tx,e.ty=d.ty;if(b&&(d=this._node._children)&&0!==d.length)for(e=0,f=d.length;f>e;e++)d[e]._renderCmd.transform(this,b)};a.getNodeToParentTransform=function(){var a=this._node,b=!1;a._usingNormalizedPosition&&
a._parent&&(b=a._parent._contentSize,a._position.x=a._normalizedPosition.x*b.width,a._position.y=a._normalizedPosition.y*b.height,a._normalizedPositionDirty=!1,b=!0);if(b||this._dirtyFlag&cc.Node._dirtyFlags.transformDirty){b=this._transform;b.tx=a._position.x;b.ty=a._position.y;var d=1,e=0,f=0,g=1;a._rotationX&&(g=.017453292519943295*a._rotationX,f=Math.sin(g),g=Math.cos(g));a._rotationY&&(e=.017453292519943295*a._rotationY,d=Math.cos(e),e=-Math.sin(e));b.a=d;b.b=e;b.c=f;b.d=g;var h=a._scaleX,k=
a._scaleY,m=this._anchorPointInPoints.x,n=this._anchorPointInPoints.y,p=1E-6>h&&-1E-6<h?1E-6:h,q=1E-6>k&&-1E-6<k?1E-6:k;if((1!==h||1!==k)&&(d=b.a*=p,e=b.b*=p,f=b.c*=q,g=b.d*=q),a._skewX||a._skewY)h=Math.tan(-a._skewX*Math.PI/180),k=Math.tan(-a._skewY*Math.PI/180),h===1/0&&(h=99999999),k===1/0&&(k=99999999),p=n*h,q=m*k,b.a=d-f*k,b.b=e-g*k,b.c=f-d*h,b.d=g-e*h,b.tx+=d*p+f*q,b.ty+=e*p+g*q;b.tx-=d*m+f*n;b.ty-=e*m+g*n;a._ignoreAnchorPointForPosition&&(b.tx+=m,b.ty+=n);a._additionalTransformDirty&&(this._transform=
cc.affineTransformConcat(b,a._additionalTransform))}return this._transform};a.visit=function(a){var b=this._node;if(b._visible){(a=a||this.getParentRenderCmd())&&(this._curLevel=a._curLevel+1);var d,e=b._children;this._syncStatus(a);a=e.length;if(0<a){b.sortAllChildren();for(b=0;a>b&&(d=e[b],0>d._localZOrder);b++)d._renderCmd.visit(this);for(cc.renderer.pushRenderCommand(this);a>b;b++)e[b]._renderCmd.visit(this)}else cc.renderer.pushRenderCommand(this);this._dirtyFlag=0}};a._syncStatus=function(a){var b=
cc.Node._dirtyFlags,d=this._dirtyFlag,e=a?a._node:null;e&&e._cascadeColorEnabled&&a._dirtyFlag&b.colorDirty&&(d|=b.colorDirty);e&&e._cascadeOpacityEnabled&&a._dirtyFlag&b.opacityDirty&&(d|=b.opacityDirty);a&&a._dirtyFlag&b.transformDirty&&(d|=b.transformDirty);var e=d&b.colorDirty,f=d&b.opacityDirty,b=d&b.transformDirty;this._dirtyFlag=d;e&&this._syncDisplayColor();f&&this._syncDisplayOpacity();e&&this._updateColor();b&&this.transform(a)};a.setDirtyFlag=function(a){cc.Node.RenderCmd.prototype.setDirtyFlag.call(this,
a);this._setCacheDirty();this._cachedParent&&this._cachedParent.setDirtyFlag(a)};a._setCacheDirty=function(){if(!1===this._cacheDirty){this._cacheDirty=!0;var a=this._cachedParent;a&&a!==this&&a._setNodeDirtyForCache&&a._setNodeDirtyForCache()}};a._setCachedParent=function(a){if(this._cachedParent!==a){this._cachedParent=a;for(var b=this._node._children,d=0,e=b.length;e>d;d++)b[d]._renderCmd._setCachedParent(a)}};a.detachFromParent=function(){this._cachedParent=null;for(var a,b=this._node._children,
d=0,e=b.length;e>d;d++)(a=b[d])&&a._renderCmd&&a._renderCmd.detachFromParent()};a.setShaderProgram=function(a){};a.getShaderProgram=function(){return null};cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc=function(a){return a?a.src===cc.SRC_ALPHA&&a.dst===cc.ONE||a.src===cc.ONE&&a.dst===cc.ONE?"lighter":a.src===cc.ZERO&&a.dst===cc.SRC_ALPHA?"destination-in":a.src===cc.ZERO&&a.dst===cc.ONE_MINUS_SRC_ALPHA?"destination-out":"source-over":"source-over"}}(),cc._tmp.PrototypeTexture2D=function(){var a=
cc.Texture2D;a.PVRImagesHavePremultipliedAlpha=function(a){cc.PVRHaveAlphaPremultiplied_=a};a.PIXEL_FORMAT_RGBA8888=2;a.PIXEL_FORMAT_RGB888=3;a.PIXEL_FORMAT_RGB565=4;a.PIXEL_FORMAT_A8=5;a.PIXEL_FORMAT_I8=6;a.PIXEL_FORMAT_AI88=7;a.PIXEL_FORMAT_RGBA4444=8;a.PIXEL_FORMAT_RGB5A1=7;a.PIXEL_FORMAT_PVRTC4=9;a.PIXEL_FORMAT_PVRTC2=10;a.PIXEL_FORMAT_DEFAULT=a.PIXEL_FORMAT_RGBA8888;var c=cc.Texture2D._M={};c[a.PIXEL_FORMAT_RGBA8888]="RGBA8888";c[a.PIXEL_FORMAT_RGB888]="RGB888";c[a.PIXEL_FORMAT_RGB565]="RGB565";
c[a.PIXEL_FORMAT_A8]="A8";c[a.PIXEL_FORMAT_I8]="I8";c[a.PIXEL_FORMAT_AI88]="AI88";c[a.PIXEL_FORMAT_RGBA4444]="RGBA4444";c[a.PIXEL_FORMAT_RGB5A1]="RGB5A1";c[a.PIXEL_FORMAT_PVRTC4]="PVRTC4";c[a.PIXEL_FORMAT_PVRTC2]="PVRTC2";c=cc.Texture2D._B={};c[a.PIXEL_FORMAT_RGBA8888]=32;c[a.PIXEL_FORMAT_RGB888]=24;c[a.PIXEL_FORMAT_RGB565]=16;c[a.PIXEL_FORMAT_A8]=8;c[a.PIXEL_FORMAT_I8]=8;c[a.PIXEL_FORMAT_AI88]=16;c[a.PIXEL_FORMAT_RGBA4444]=16;c[a.PIXEL_FORMAT_RGB5A1]=16;c[a.PIXEL_FORMAT_PVRTC4]=4;c[a.PIXEL_FORMAT_PVRTC2]=
3;c=cc.Texture2D.prototype;c.name;cc.defineGetterSetter(c,"name",c.getName);c.pixelFormat;cc.defineGetterSetter(c,"pixelFormat",c.getPixelFormat);c.pixelsWidth;cc.defineGetterSetter(c,"pixelsWidth",c.getPixelsWide);c.pixelsHeight;cc.defineGetterSetter(c,"pixelsHeight",c.getPixelsHigh);c.width;cc.defineGetterSetter(c,"width",c._getWidth);c.height;cc.defineGetterSetter(c,"height",c._getHeight);a.defaultPixelFormat=a.PIXEL_FORMAT_DEFAULT},cc._tmp.PrototypeTextureAtlas=function(){var a=cc.TextureAtlas.prototype;
a.totalQuads;cc.defineGetterSetter(a,"totalQuads",a.getTotalQuads);a.capacity;cc.defineGetterSetter(a,"capacity",a.getCapacity);a.quads;cc.defineGetterSetter(a,"quads",a.getQuads,a.setQuads)},cc._tmp.WebGLTexture2D=function(){cc.Texture2D=cc.Class.extend({_pVRHaveAlphaPremultiplied:!0,_pixelFormat:null,_pixelsWide:0,_pixelsHigh:0,_name:"",_contentSize:null,maxS:0,maxT:0,_hasPremultipliedAlpha:!1,_hasMipmaps:!1,shaderProgram:null,_textureLoaded:!1,_htmlElementObj:null,_webTextureObj:null,url:null,
ctor:function(){this._contentSize=cc.size(0,0);this._pixelFormat=cc.Texture2D.defaultPixelFormat},releaseTexture:function(){this._webTextureObj&&cc._renderContext.deleteTexture(this._webTextureObj);cc.loader.release(this.url)},getPixelFormat:function(){return this._pixelFormat},getPixelsWide:function(){return this._pixelsWide},getPixelsHigh:function(){return this._pixelsHigh},getName:function(){return this._webTextureObj},getContentSize:function(){return cc.size(this._contentSize.width/cc.contentScaleFactor(),
this._contentSize.height/cc.contentScaleFactor())},_getWidth:function(){return this._contentSize.width/cc.contentScaleFactor()},_getHeight:function(){return this._contentSize.height/cc.contentScaleFactor()},getContentSizeInPixels:function(){return this._contentSize},getMaxS:function(){return this.maxS},setMaxS:function(a){this.maxS=a},getMaxT:function(){return this.maxT},setMaxT:function(a){this.maxT=a},getShaderProgram:function(){return this.shaderProgram},setShaderProgram:function(a){this.shaderProgram=
a},hasPremultipliedAlpha:function(){return this._hasPremultipliedAlpha},hasMipmaps:function(){return this._hasMipmaps},description:function(){return"<cc.Texture2D | Name = "+this._name+" | Dimensions = "+this._pixelsWide+" x "+this._pixelsHigh+" | Coordinates = ("+this.maxS+", "+this.maxT+")>"},releaseData:function(a){},keepData:function(a,c){return a},initWithData:function(a,c,b,d,e){var f=cc.Texture2D,g=cc._renderContext,h=g.RGBA,k=g.UNSIGNED_BYTE,m=b*cc.Texture2D._B[c]/8;switch(0===m%8?g.pixelStorei(g.UNPACK_ALIGNMENT,
8):0===m%4?g.pixelStorei(g.UNPACK_ALIGNMENT,4):0===m%2?g.pixelStorei(g.UNPACK_ALIGNMENT,2):g.pixelStorei(g.UNPACK_ALIGNMENT,1),this._webTextureObj=g.createTexture(),cc.glBindTexture2D(this),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),c){case f.PIXEL_FORMAT_RGBA8888:h=g.RGBA;break;case f.PIXEL_FORMAT_RGB888:h=
g.RGB;break;case f.PIXEL_FORMAT_RGBA4444:k=g.UNSIGNED_SHORT_4_4_4_4;break;case f.PIXEL_FORMAT_RGB5A1:k=g.UNSIGNED_SHORT_5_5_5_1;break;case f.PIXEL_FORMAT_RGB565:k=g.UNSIGNED_SHORT_5_6_5;break;case f.PIXEL_FORMAT_AI88:h=g.LUMINANCE_ALPHA;break;case f.PIXEL_FORMAT_A8:h=g.ALPHA;break;case f.PIXEL_FORMAT_I8:h=g.LUMINANCE;break;default:cc.assert(0,cc._LogInfos.Texture2D_initWithData)}return g.texImage2D(g.TEXTURE_2D,0,h,b,d,0,h,k,a),this._contentSize.width=e.width,this._contentSize.height=e.height,this._pixelsWide=
b,this._pixelsHigh=d,this._pixelFormat=c,this.maxS=e.width/b,this.maxT=e.height/d,this._hasPremultipliedAlpha=!1,this._hasMipmaps=!1,this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE),this._textureLoaded=!0,!0},drawAtPoint:function(a){var c=[0,this.maxT,this.maxS,this.maxT,0,0,this.maxS,0],b=this._pixelsWide*this.maxS,d=this._pixelsHigh*this.maxT;a=[a.x,a.y,0,b+a.x,a.y,0,a.x,d+a.y,0,b+a.x,d+a.y,0];cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_TEX_COORDS);
this._shaderProgram.use();this._shaderProgram.setUniformsForBuiltins();cc.glBindTexture2D(this);b=cc._renderContext;b.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,b.FLOAT,!1,0,a);b.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,b.FLOAT,!1,0,c);b.drawArrays(b.TRIANGLE_STRIP,0,4)},drawInRect:function(a){var c=[0,this.maxT,this.maxS,this.maxT,0,0,this.maxS,0];a=[a.x,a.y,a.x+a.width,a.y,a.x,a.y+a.height,a.x+a.width,a.y+a.height];cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_TEX_COORDS);
this._shaderProgram.use();this._shaderProgram.setUniformsForBuiltins();cc.glBindTexture2D(this);var b=cc._renderContext;b.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,b.FLOAT,!1,0,a);b.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,b.FLOAT,!1,0,c);b.drawArrays(b.TRIANGLE_STRIP,0,4)},initWithImage:function(a){if(null==a)return cc.log(cc._LogInfos.Texture2D_initWithImage),!1;var c=a.getWidth(),b=a.getHeight(),d=cc.configuration.getMaxTextureSize();return c>d||b>d?(cc.log(cc._LogInfos.Texture2D_initWithImage_2,
c,b,d,d),!1):(this._textureLoaded=!0,this._initPremultipliedATextureWithImage(a,c,b))},initWithElement:function(a){a&&(this._webTextureObj=cc._renderContext.createTexture(),this._htmlElementObj=a,this._textureLoaded=!0)},getHtmlElementObj:function(){return this._htmlElementObj},isLoaded:function(){return this._textureLoaded},handleLoadedTexture:function(a){a=void 0===a?!1:a;if(cc._rendererInitialized){if(!this._htmlElementObj){var c=cc.loader.getRes(this.url);if(!c)return;this.initWithElement(c)}this._htmlElementObj.width&&
this._htmlElementObj.height&&(c=cc._renderContext,cc.glBindTexture2D(this),c.pixelStorei(c.UNPACK_ALIGNMENT,4),a&&c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,this._htmlElementObj),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),this.shaderProgram=
cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE),cc.glBindTexture2D(null),a&&c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),c=this._htmlElementObj.height,this._pixelsWide=this._contentSize.width=this._htmlElementObj.width,this._pixelsHigh=this._contentSize.height=c,this._pixelFormat=cc.Texture2D.PIXEL_FORMAT_RGBA8888,this.maxT=this.maxS=1,this._hasPremultipliedAlpha=a,this._hasMipmaps=!1,this.dispatchEvent("load"))}},initWithString:function(a,c,b,d,e,f){return cc.log(cc._LogInfos.Texture2D_initWithString),
null},initWithETCFile:function(a){return cc.log(cc._LogInfos.Texture2D_initWithETCFile_2),!1},initWithPVRFile:function(a){return cc.log(cc._LogInfos.Texture2D_initWithPVRFile_2),!1},initWithPVRTCData:function(a,c,b,d,e,f){return cc.log(cc._LogInfos.Texture2D_initWithPVRTCData_2),!1},setTexParameters:function(a,c,b,d){var e=cc._renderContext;void 0!==c&&(a={minFilter:a,magFilter:c,wrapS:b,wrapT:d});cc.assert(this._pixelsWide===cc.NextPOT(this._pixelsWide)&&this._pixelsHigh===cc.NextPOT(this._pixelsHigh)||
a.wrapS===e.CLAMP_TO_EDGE&&a.wrapT===e.CLAMP_TO_EDGE,"WebGLRenderingContext.CLAMP_TO_EDGE should be used in NPOT textures");cc.glBindTexture2D(this);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,a.minFilter);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,a.magFilter);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,a.wrapS);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,a.wrapT)},setAntiAliasTexParameters:function(){var a=cc._renderContext;cc.glBindTexture2D(this);this._hasMipmaps?a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_NEAREST):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR)},setAliasTexParameters:function(){var a=cc._renderContext;cc.glBindTexture2D(this);this._hasMipmaps?a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST_MIPMAP_NEAREST):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST)},generateMipmap:function(){cc.assert(this._pixelsWide===
cc.NextPOT(this._pixelsWide)&&this._pixelsHigh===cc.NextPOT(this._pixelsHigh),"Mimpap texture only works in POT textures");cc.glBindTexture2D(this);cc._renderContext.generateMipmap(cc._renderContext.TEXTURE_2D);this._hasMipmaps=!0},stringForFormat:function(){return cc.Texture2D._M[this._pixelFormat]},bitsPerPixelForFormat:function(a){a=a||this._pixelFormat;var c=cc.Texture2D._B[a];return null!=c?c:(cc.log(cc._LogInfos.Texture2D_bitsPerPixelForFormat,a),-1)},_initPremultipliedATextureWithImage:function(a,
c,b){var d,e=cc.Texture2D,f=a.getData(),g=null,g=null,h=a.hasAlpha(),k=cc.size(a.getWidth(),a.getHeight()),m=e.defaultPixelFormat;d=a.getBitsPerComponent();h||(8<=d?m=e.PIXEL_FORMAT_RGB888:(cc.log(cc._LogInfos.Texture2D__initPremultipliedATextureWithImage),m=e.PIXEL_FORMAT_RGB565));var n=c*b;if(m===e.PIXEL_FORMAT_RGB565)if(h)for(f=new Uint16Array(c*b),g=a.getData(),d=0;n>d;++d)f[d]=(g[d]>>0&255)>>3<<11|(g[d]>>8&255)>>2<<5|(g[d]>>16&255)>>3<<0;else for(f=new Uint16Array(c*b),g=a.getData(),d=0;n>d;++d)f[d]=
(255&g[d])>>3<<11|(255&g[d])>>2<<5|(255&g[d])>>3<<0;else if(m===e.PIXEL_FORMAT_RGBA4444)for(f=new Uint16Array(c*b),g=a.getData(),d=0;n>d;++d)f[d]=(g[d]>>0&255)>>4<<12|(g[d]>>8&255)>>4<<8|(g[d]>>16&255)>>4<<4|(g[d]>>24&255)>>4<<0;else if(m===e.PIXEL_FORMAT_RGB5A1)for(f=new Uint16Array(c*b),g=a.getData(),d=0;n>d;++d)f[d]=(g[d]>>0&255)>>3<<11|(g[d]>>8&255)>>3<<6|(g[d]>>16&255)>>3<<1|(g[d]>>24&255)>>7<<0;else if(m===e.PIXEL_FORMAT_A8)for(f=new Uint8Array(c*b),g=a.getData(),d=0;n>d;++d)f[d]=g>>24&255;
if(h&&m===e.PIXEL_FORMAT_RGB888)for(g=a.getData(),f=new Uint8Array(c*b*3),d=0;n>d;++d)f[3*d]=g>>0&255,f[3*d+1]=g>>8&255,f[3*d+2]=g>>16&255;return this.initWithData(f,m,c,b,k),a.getData(),this._hasPremultipliedAlpha=a.isPremultipliedAlpha(),!0},addLoadedEventListener:function(a,c){this.addEventListener("load",a,c)},removeLoadedEventListener:function(a){this.removeEventListener("load",a)}})},cc._tmp.WebGLTextureAtlas=function(){var a=cc.TextureAtlas.prototype;a._setupVBO=function(){var a=cc._renderContext;
this._buffersVBO[0]=a.createBuffer();this._buffersVBO[1]=a.createBuffer();this._quadsWebBuffer=a.createBuffer();this._mapBuffers()};a._mapBuffers=function(){var a=cc._renderContext;a.bindBuffer(a.ARRAY_BUFFER,this._quadsWebBuffer);a.bufferData(a.ARRAY_BUFFER,this._quadsArrayBuffer,a.DYNAMIC_DRAW);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]);a.bufferData(a.ELEMENT_ARRAY_BUFFER,this._indices,a.STATIC_DRAW)};a.drawNumberOfQuads=function(a,b){if(b=b||0,0!==a&&this.texture&&this.texture.isLoaded()){var d=
cc._renderContext;cc.glBindTexture2D(this.texture);cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX);d.bindBuffer(d.ARRAY_BUFFER,this._quadsWebBuffer);this.dirty&&(d.bufferData(d.ARRAY_BUFFER,this._quadsArrayBuffer,d.DYNAMIC_DRAW),this.dirty=!1);d.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,d.FLOAT,!1,24,0);d.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,d.UNSIGNED_BYTE,!0,24,12);d.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,d.FLOAT,!1,24,16);d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,
this._buffersVBO[1]);cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP?d.drawElements(d.TRIANGLE_STRIP,6*a,d.UNSIGNED_SHORT,6*b*this._indices.BYTES_PER_ELEMENT):d.drawElements(d.TRIANGLES,6*a,d.UNSIGNED_SHORT,6*b*this._indices.BYTES_PER_ELEMENT);cc.g_NumberOfDraws++}}},cc._tmp.WebGLTextureCache=function(){var a=cc.textureCache;a.handleLoadedTexture=function(a){var b=this._textures;cc._rendererInitialized||(b=this._loadedTexturesBefore);var d=b[a];d||(d=b[a]=new cc.Texture2D,d.url=a);d.handleLoadedTexture()};a.addImage=
function(a,b,d){cc.assert(a,cc._LogInfos.Texture2D_addImage_2);var e=this._textures;cc._rendererInitialized||(e=this._loadedTexturesBefore);var f=e[a]||e[cc.loader._aliases[a]];if(f)return b&&b.call(d,f),f;f=e[a]=new cc.Texture2D;f.url=a;return(cc.loader._checkIsImageURL(a)?cc.loader.load:cc.loader.loadImg).call(cc.loader,a,function(f,h){if(f)return b&&b.call(d,f);cc.textureCache.handleLoadedTexture(a);var k=e[a];b&&b.call(d,k)}),f};a.addImageAsync=a.addImage;a=null},cc.ALIGN_CENTER=51,cc.ALIGN_TOP=
19,cc.ALIGN_TOP_RIGHT=18,cc.ALIGN_RIGHT=50,cc.ALIGN_BOTTOM_RIGHT=34,cc.ALIGN_BOTTOM=35,cc.ALIGN_BOTTOM_LEFT=33,cc.ALIGN_LEFT=49,cc.ALIGN_TOP_LEFT=17,cc.PVRHaveAlphaPremultiplied_=!1,cc._renderType===cc._RENDER_TYPE_CANVAS?(cc.Texture2D=cc.Class.extend({_contentSize:null,_textureLoaded:!1,_htmlElementObj:null,url:null,_pattern:null,ctor:function(){this._contentSize=cc.size(0,0);this._textureLoaded=!1;this._htmlElementObj=null;this._pattern=""},getPixelsWide:function(){return this._contentSize.width},
getPixelsHigh:function(){return this._contentSize.height},getContentSize:function(){var a=cc.contentScaleFactor();return cc.size(this._contentSize.width/a,this._contentSize.height/a)},_getWidth:function(){return this._contentSize.width/cc.contentScaleFactor()},_getHeight:function(){return this._contentSize.height/cc.contentScaleFactor()},getContentSizeInPixels:function(){return this._contentSize},initWithElement:function(a){a&&(this._htmlElementObj=a,this._contentSize.width=a.width,this._contentSize.height=
a.height,this._textureLoaded=!0)},getHtmlElementObj:function(){return this._htmlElementObj},isLoaded:function(){return this._textureLoaded},handleLoadedTexture:function(){if(!this._textureLoaded){if(!this._htmlElementObj){var a=cc.loader.getRes(this.url);if(!a)return;this.initWithElement(a)}a=this._htmlElementObj;this._contentSize.width=a.width;this._contentSize.height=a.height;this.dispatchEvent("load")}},description:function(){return"<cc.Texture2D | width = "+this._contentSize.width+" height "+
this._contentSize.height+">"},initWithData:function(a,c,b,d,e){return!1},initWithImage:function(a){return!1},initWithString:function(a,c,b,d,e,f){return!1},releaseTexture:function(){cc.loader.release(this.url)},getName:function(){return null},getMaxS:function(){return 1},setMaxS:function(a){},getMaxT:function(){return 1},setMaxT:function(a){},getPixelFormat:function(){return null},getShaderProgram:function(){return null},setShaderProgram:function(a){},hasPremultipliedAlpha:function(){return!1},hasMipmaps:function(){return!1},
releaseData:function(a){},keepData:function(a,c){return a},drawAtPoint:function(a){},drawInRect:function(a){},initWithETCFile:function(a){return cc.log(cc._LogInfos.Texture2D_initWithETCFile),!1},initWithPVRFile:function(a){return cc.log(cc._LogInfos.Texture2D_initWithPVRFile),!1},initWithPVRTCData:function(a,c,b,d,e,f){return cc.log(cc._LogInfos.Texture2D_initWithPVRTCData),!1},setTexParameters:function(a,c,b,d){return void 0!==c&&(a={minFilter:a,magFilter:c,wrapS:b,wrapT:d}),a.wrapS===cc.REPEAT&&
a.wrapT===cc.REPEAT?void(this._pattern="repeat"):a.wrapS===cc.REPEAT?void(this._pattern="repeat-x"):a.wrapT===cc.REPEAT?void(this._pattern="repeat-y"):void(this._pattern="")},setAntiAliasTexParameters:function(){},setAliasTexParameters:function(){},generateMipmap:function(){},stringForFormat:function(){return""},bitsPerPixelForFormat:function(a){return-1},addLoadedEventListener:function(a,c){this.addEventListener("load",a,c)},removeLoadedEventListener:function(a){this.removeEventListener("load",a)},
_grayElementObj:null,_backupElement:null,_isGray:!1,_switchToGray:function(a){this._textureLoaded&&this._isGray!==a&&(this._isGray=a,this._isGray?(this._backupElement=this._htmlElementObj,this._grayElementObj||(this._grayElementObj=cc.Texture2D._generateGrayTexture(this._htmlElementObj)),this._htmlElementObj=this._grayElementObj):null!==this._backupElement&&(this._htmlElementObj=this._backupElement))}}),cc.Texture2D._generateGrayTexture=function(a,c,b){if(null===a)return null;b=b||cc.newElement("canvas");
c=c||cc.rect(0,0,a.width,a.height);b.width=c.width;b.height=c.height;var d=b.getContext("2d");d.drawImage(a,c.x,c.y,c.width,c.height,0,0,c.width,c.height);a=d.getImageData(0,0,c.width,c.height);c=a.data;for(var e=0,f=c.length;f>e;e+=4)c[e]=c[e+1]=c[e+2]=.34*c[e]+.5*c[e+1]+.16*c[e+2];return d.putImageData(a,0,0),b}):(cc.assert(cc.isFunction(cc._tmp.WebGLTexture2D),cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTexture2D(),delete cc._tmp.WebGLTexture2D),cc.EventHelper.prototype.apply(cc.Texture2D.prototype),
cc.assert(cc.isFunction(cc._tmp.PrototypeTexture2D),cc._LogInfos.MissingFile,"TexturesPropertyDefine.js"),cc._tmp.PrototypeTexture2D(),delete cc._tmp.PrototypeTexture2D,cc.textureCache={_textures:{},_textureColorsCache:{},_textureKeySeq:0|1E3*Math.random(),_loadedTexturesBefore:{},_initializingRenderer:function(){var a,c=this._loadedTexturesBefore,b=this._textures;for(a in c){var d=c[a];d.handleLoadedTexture();b[a]=d}this._loadedTexturesBefore={}},addPVRTCImage:function(a){cc.log(cc._LogInfos.textureCache_addPVRTCImage)},
addETCImage:function(a){cc.log(cc._LogInfos.textureCache_addETCImage)},description:function(){return"<TextureCache | Number of textures = "+this._textures.length+">"},textureForKey:function(a){return cc.log(cc._LogInfos.textureCache_textureForKey),this.getTextureForKey(a)},getTextureForKey:function(a){return this._textures[a]||this._textures[cc.loader._aliases[a]]},getKeyByTexture:function(a){for(var c in this._textures)if(this._textures[c]===a)return c;return null},_generalTextureKey:function(){return this._textureKeySeq++,
"_textureKey_"+this._textureKeySeq},getTextureColors:function(a){var c=this.getKeyByTexture(a);return c||(c=a instanceof HTMLImageElement?a.src:this._generalTextureKey()),this._textureColorsCache[c]||(this._textureColorsCache[c]=cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor(a)),this._textureColorsCache[c]},addPVRImage:function(a){cc.log(cc._LogInfos.textureCache_addPVRImage)},removeAllTextures:function(){var a=this._textures,c;for(c in a)a[c]&&a[c].releaseTexture();this._textures={}},removeTexture:function(a){if(a){var c=
this._textures,b;for(b in c)c[b]===a&&(c[b].releaseTexture(),delete c[b])}},removeTextureForKey:function(a){null!=a&&this._textures[a]&&delete this._textures[a]},cacheImage:function(a,c){if(c instanceof cc.Texture2D)return void(this._textures[a]=c);var b=new cc.Texture2D;b.initWithElement(c);b.handleLoadedTexture();this._textures[a]=b},addUIImage:function(a,c){if(cc.assert(a,cc._LogInfos.textureCache_addUIImage_2),c&&this._textures[c])return this._textures[c];var b=new cc.Texture2D;return b.initWithImage(a),
null!=c?this._textures[c]=b:cc.log(cc._LogInfos.textureCache_addUIImage),b},dumpCachedTextureInfo:function(){var a=0,c=0,b=this._textures,d;for(d in b){var e=b[d];a++;e.getHtmlElementObj()instanceof HTMLImageElement?cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo,d,e.getHtmlElementObj().src,e.pixelsWidth,e.pixelsHeight):cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_2,d,e.pixelsWidth,e.pixelsHeight);c+=e.pixelsWidth*e.pixelsHeight*4}b=this._textureColorsCache;for(d in b){var e=b[d],
f;for(f in e){var g=e[f];a++;cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_2,d,g.width,g.height);c+=g.width*g.height*4}}cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_3,a,c/1024,(c/1048576).toFixed(2))},_clear:function(){this._textures={};this._textureColorsCache={};this._textureKeySeq=0|1E3*Math.random();this._loadedTexturesBefore={}}},cc._renderType===cc._RENDER_TYPE_CANVAS){var _p=cc.textureCache;_p.handleLoadedTexture=function(a){var c=this._textures,b=c[a];b||(b=c[a]=new cc.Texture2D,
b.url=a);b.handleLoadedTexture()};_p.addImage=function(a,c,b){cc.assert(a,cc._LogInfos.Texture2D_addImage);var d=this._textures,e=d[a]||d[cc.loader._aliases[a]];if(e)return c&&c.call(b,e),e;e=d[a]=new cc.Texture2D;e.url=a;return(cc.loader._checkIsImageURL(a)?cc.loader.load:cc.loader.loadImg).call(cc.loader,a,function(e,g){if(e)return c&&c.call(b,e);cc.textureCache.handleLoadedTexture(a);var h=d[a];c&&c.call(b,h)}),e};_p.addImageAsync=_p.addImage;_p=null}else cc.assert(cc.isFunction(cc._tmp.WebGLTextureCache),
cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTextureCache(),delete cc._tmp.WebGLTextureCache;
(cc.Scene=cc.Node.extend({_className:"Scene",ctor:function(){cc.Node.prototype.ctor.call(this);this._ignoreAnchorPointForPosition=!0;this.setAnchorPoint(.5,.5);this.setContentSize(cc.director.getWinSize())}}),cc.Scene.create=function(){return new cc.Scene},cc.LoaderScene=cc.Scene.extend({_interval:null,_label:null,_className:"LoaderScene",cb:null,target:null,init:function(){var a=this,c=200,b=a._bgLayer=new cc.LayerColor(cc.color(32,32,32,255));a.addChild(b,0);var d=24,e=-c/2+100;cc._loaderImage&&
(cc.loader.loadImg(cc._loaderImage,{isCrossOrigin:!1},function(b,d){c=d.height;a._initStage(d,cc.visibleRect.center)}),d=14,e=-c/2-10);d=a._label=new cc.LabelTTF("Loading... 0%","Arial",d);return d.setPosition(cc.pAdd(cc.visibleRect.center,cc.p(0,e))),d.setColor(cc.color(180,180,180)),b.addChild(this._label,10),!0},_initStage:function(a,c){var b=this._texture2d=new cc.Texture2D;b.initWithElement(a);b.handleLoadedTexture();b=this._logo=new cc.Sprite(b);b.setScale(cc.contentScaleFactor());b.x=c.x;b.y=
c.y;this._bgLayer.addChild(b,10)},onEnter:function(){cc.Node.prototype.onEnter.call(this);this.schedule(this._startLoading,.3)},onExit:function(){cc.Node.prototype.onExit.call(this);this._label.setString("Loading... 0%")},initWithResources:function(a,c,b){cc.isString(a)&&(a=[a]);this.resources=a||[];this.cb=c;this.target=b},_startLoading:function(){var a=this;a.unschedule(a._startLoading);cc.loader.load(a.resources,function(c,b,d){c=Math.min(d/b*100|0,100);a._label.setString("Loading... "+c+"%")},
function(){a.cb&&a.cb.call(a.target)})}}),cc.LoaderScene.preload=function(a,c,b){var d=cc;return d.loaderScene||(d.loaderScene=new cc.LoaderScene,d.loaderScene.init()),d.loaderScene.initWithResources(a,c,b),cc.director.runScene(d.loaderScene),d.loaderScene},cc.Layer=cc.Node.extend({_className:"Layer",ctor:function(){var a=cc.Node.prototype;a.ctor.call(this);this._ignoreAnchorPointForPosition=!0;a.setAnchorPoint.call(this,.5,.5);a.setContentSize.call(this,cc.winSize)},init:function(){return this._ignoreAnchorPointForPosition=
!0,this.setAnchorPoint(.5,.5),this.setContentSize(cc.winSize),this._cascadeColorEnabled=!1,this._cascadeOpacityEnabled=!1,!0},bake:function(){this._renderCmd.bake()},unbake:function(){this._renderCmd.unbake()},isBaked:function(){return this._isBaked},addChild:function(a,c,b){cc.Node.prototype.addChild.call(this,a,c,b);this._renderCmd._bakeForAddChild(a)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.Layer.CanvasRenderCmd(this):new cc.Layer.WebGLRenderCmd(this)}}),
cc.Layer.create=function(){return new cc.Layer},cc.LayerColor=cc.Layer.extend({_blendFunc:null,_className:"LayerColor",getBlendFunc:function(){return this._blendFunc},changeWidthAndHeight:function(a,c){this.width=a;this.height=c},changeWidth:function(a){this.width=a},changeHeight:function(a){this.height=a},setOpacityModifyRGB:function(a){},isOpacityModifyRGB:function(){return!1},ctor:function(a,c,b){cc.Layer.prototype.ctor.call(this);this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST);cc.LayerColor.prototype.init.call(this,
a,c,b)},init:function(a,c,b){cc._renderType!==cc._RENDER_TYPE_CANVAS&&(this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_COLOR));var d=cc.director.getWinSize();a=a||cc.color(0,0,0,255);c=void 0===c?d.width:c;b=void 0===b?d.height:b;d=this._realColor;return d.r=a.r,d.g=a.g,d.b=a.b,this._realOpacity=a.a,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty),cc.LayerColor.prototype.setContentSize.call(this,c,b),!0},setBlendFunc:function(a,c){var b=
this._blendFunc;void 0===c?(b.src=a.src,b.dst=a.dst):(b.src=a,b.dst=c);this._renderCmd.updateBlendFunc(b)},_setWidth:function(a){cc.Node.prototype._setWidth.call(this,a);this._renderCmd._updateSquareVerticesWidth(a)},_setHeight:function(a){cc.Node.prototype._setHeight.call(this,a);this._renderCmd._updateSquareVerticesHeight(a)},setContentSize:function(a,c){cc.Layer.prototype.setContentSize.call(this,a,c);this._renderCmd._updateSquareVertices(a,c)},_createRenderCmd:function(){return cc._renderType===
cc._RENDER_TYPE_CANVAS?new cc.LayerColor.CanvasRenderCmd(this):new cc.LayerColor.WebGLRenderCmd(this)}}),cc.LayerColor.create=function(a,c,b){return new cc.LayerColor(a,c,b)},function(){var a=cc.LayerColor.prototype;cc.defineGetterSetter(a,"width",a._getWidth,a._setWidth);cc.defineGetterSetter(a,"height",a._getHeight,a._setHeight)}(),cc.LayerGradient=cc.LayerColor.extend({_endColor:null,_startOpacity:255,_endOpacity:255,_alongVector:null,_compressedInterpolation:!1,_className:"LayerGradient",_colorStops:[],
ctor:function(a,c,b,d){cc.LayerColor.prototype.ctor.call(this);this._endColor=cc.color(0,0,0,255);this._alongVector=cc.p(0,-1);this._endOpacity=this._startOpacity=255;d&&d instanceof Array?(this._colorStops=d,d.splice(0,0,{p:0,color:a||cc.color.BLACK}),d.push({p:1,color:c||cc.color.BLACK})):this._colorStops=[{p:0,color:a||cc.color.BLACK},{p:1,color:c||cc.color.BLACK}];cc.LayerGradient.prototype.init.call(this,a,c,b,d)},init:function(a,c,b,d){a=a||cc.color(0,0,0,255);c=c||cc.color(0,0,0,255);b=b||
cc.p(0,-1);d=this._endColor;return this._startOpacity=a.a,d.r=c.r,d.g=c.g,d.b=c.b,this._endOpacity=c.a,this._alongVector=b,this._compressedInterpolation=!0,cc.LayerColor.prototype.init.call(this,cc.color(a.r,a.g,a.b,255)),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty|cc.Node._dirtyFlags.gradientDirty),!0},setContentSize:function(a,c){cc.LayerColor.prototype.setContentSize.call(this,a,c);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},
_setWidth:function(a){cc.LayerColor.prototype._setWidth.call(this,a);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},_setHeight:function(a){cc.LayerColor.prototype._setHeight.call(this,a);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},getStartColor:function(){return cc.color(this._realColor)},setStartColor:function(a){this.color=a;var c=this._colorStops;c&&0<c.length&&(c=c[0].color,c.r=a.r,c.g=a.g,c.b=a.b)},setEndColor:function(a){var c=this._endColor;c.r=a.r;c.g=
a.g;c.b=a.b;(c=this._colorStops)&&0<c.length&&(c=c[c.length-1].color,c.r=a.r,c.g=a.g,c.b=a.b);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},getEndColor:function(){return cc.color(this._endColor)},setStartOpacity:function(a){this._startOpacity=a;var c=this._colorStops;c&&0<c.length&&(c[0].color.a=a);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getStartOpacity:function(){return this._startOpacity},setEndOpacity:function(a){this._endOpacity=a;var c=this._colorStops;
c&&0<c.length&&(c[c.length-1].color.a=a);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getEndOpacity:function(){return this._endOpacity},setVector:function(a){this._alongVector.x=a.x;this._alongVector.y=a.y;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},getVector:function(){return cc.p(this._alongVector.x,this._alongVector.y)},isCompressedInterpolation:function(){return this._compressedInterpolation},setCompressedInterpolation:function(a){this._compressedInterpolation=
a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},getColorStops:function(){return this._colorStops},setColorStops:function(a){this._colorStops=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty|cc.Node._dirtyFlags.gradientDirty)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.LayerGradient.CanvasRenderCmd(this):new cc.LayerGradient.WebGLRenderCmd(this)}}),cc.LayerGradient.create=function(a,c,b,d){return new cc.LayerGradient(a,
c,b,d)},function(){var a=cc.LayerGradient.prototype;a.startColor;cc.defineGetterSetter(a,"startColor",a.getStartColor,a.setStartColor);a.endColor;cc.defineGetterSetter(a,"endColor",a.getEndColor,a.setEndColor);a.startOpacity;cc.defineGetterSetter(a,"startOpacity",a.getStartOpacity,a.setStartOpacity);a.endOpacity;cc.defineGetterSetter(a,"endOpacity",a.getEndOpacity,a.setEndOpacity);a.vector;cc.defineGetterSetter(a,"vector",a.getVector,a.setVector);a.colorStops;cc.defineGetterSetter(a,"colorStops",
a.getColorStops,a.setColorStops)}(),cc.LayerMultiplex=cc.Layer.extend({_enabledLayer:0,_layers:null,_className:"LayerMultiplex",ctor:function(a){cc.Layer.prototype.ctor.call(this);a instanceof Array?cc.LayerMultiplex.prototype.initWithLayers.call(this,a):cc.LayerMultiplex.prototype.initWithLayers.call(this,Array.prototype.slice.call(arguments))},initWithLayers:function(a){return 0<a.length&&null==a[a.length-1]&&cc.log(cc._LogInfos.LayerMultiplex_initWithLayers),this._layers=a,this._enabledLayer=0,
this.addChild(this._layers[this._enabledLayer]),!0},switchTo:function(a){return a>=this._layers.length?void cc.log(cc._LogInfos.LayerMultiplex_switchTo):(this.removeChild(this._layers[this._enabledLayer],!0),this._enabledLayer=a,void this.addChild(this._layers[a]))},switchToAndReleaseMe:function(a){return a>=this._layers.length?void cc.log(cc._LogInfos.LayerMultiplex_switchToAndReleaseMe):(this.removeChild(this._layers[this._enabledLayer],!0),this._layers[this._enabledLayer]=null,this._enabledLayer=
a,void this.addChild(this._layers[a]))},addLayer:function(a){return a?void this._layers.push(a):void cc.log(cc._LogInfos.LayerMultiplex_addLayer)}}),cc.LayerMultiplex.create=function(){return new cc.LayerMultiplex(Array.prototype.slice.call(arguments))},function(){cc.Layer.CanvasRenderCmd=function(a){cc.Node.CanvasRenderCmd.call(this,a);this._isBaked=!1;this._bakeSprite=null};var a=cc.Layer.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);a.constructor=cc.Layer.CanvasRenderCmd;
a.bake=function(){if(!this._isBaked){this._needDraw=!0;this._isBaked=this._cacheDirty=cc.renderer.childrenOrderDirty=!0;for(var a=this._node._children,b=0,d=a.length;d>b;b++)a[b]._renderCmd._setCachedParent(this);this._bakeSprite||(this._bakeSprite=new cc.BakeSprite,this._bakeSprite.setAnchorPoint(0,0))}};a.unbake=function(){if(this._isBaked){cc.renderer.childrenOrderDirty=!0;this._isBaked=this._needDraw=!1;this._cacheDirty=!0;for(var a=this._node._children,b=0,d=a.length;d>b;b++)a[b]._renderCmd._setCachedParent(null)}};
a.isBaked=function(){return this._isBaked};a.rendering=function(){if(this._cacheDirty){var a=this._node,b=a._children,d=this._bakeSprite;this.transform(this.getParentRenderCmd(),!0);var e=this._getBoundingBoxForBake();e.width=0|e.width+.5;e.height=0|e.height+.5;var f=d.getCacheContext(),g=f.getContext();d.resetCanvasSize(e.width,e.height);f.setOffset(0-e.x,g.canvas.height-e.height+e.y);d.setPosition(e.x,e.y);a.sortAllChildren();cc.renderer._turnToCacheMode(this.__instanceId);a=0;for(e=b.length;e>
a;a++)b[a].visit(this);cc.renderer._renderingToCacheCanvas(f,this.__instanceId);d.transform();this._cacheDirty=!1}};a.visit=function(a){if(!this._isBaked)return void cc.Node.CanvasRenderCmd.prototype.visit.call(this,a);var b=this._node,d=b._children.length;b._visible&&0!==d&&(this._syncStatus(a),cc.renderer.pushRenderCommand(this),this._bakeSprite.visit(this),this._dirtyFlag=0)};a._bakeForAddChild=function(a){a._parent===this._node&&this._isBaked&&a._renderCmd._setCachedParent(this)};a._getBoundingBoxForBake=
function(){var a=null,b=this._node;if(!b._children||0===b._children.length)return cc.rect(0,0,10,10);for(var d=b.getNodeToWorldTransform(),b=b._children,e=0,f=b.length;f>e;e++){var g=b[e];g&&g._visible&&(a?(g=g._getBoundingBoxToCurrentNode(d))&&(a=cc.rectUnion(a,g)):a=g._getBoundingBoxToCurrentNode(d))}return a}}(),function(){cc.LayerColor.CanvasRenderCmd=function(a){cc.Layer.CanvasRenderCmd.call(this,a);this._needDraw=!0;this._blendFuncStr="source-over";this._bakeRenderCmd=new cc.CustomRenderCmd(this,
this._bakeRendering)};var a=cc.LayerColor.CanvasRenderCmd.prototype=Object.create(cc.Layer.CanvasRenderCmd.prototype);a.constructor=cc.LayerColor.CanvasRenderCmd;a.unbake=function(){cc.Layer.CanvasRenderCmd.prototype.unbake.call(this);this._needDraw=!0};a.rendering=function(a,b,d){a=a||cc._renderContext;var e=a.getContext(),f=this._node,g=this._displayedColor,h=this._displayedOpacity/255,k=f._contentSize.width,f=f._contentSize.height;0!==h&&(a.setCompositeOperation(this._blendFuncStr),a.setGlobalAlpha(h),
a.setFillStyle("rgba("+(0|g.r)+","+(0|g.g)+","+(0|g.b)+", 1)"),a.setTransform(this._worldTransform,b,d),e.fillRect(0,0,k*b,-f*d),cc.g_NumberOfDraws++)};a.updateBlendFunc=function(a){this._blendFuncStr=cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(a)};a._updateSquareVertices=a._updateSquareVerticesWidth=a._updateSquareVerticesHeight=function(){};a._bakeRendering=function(){if(this._cacheDirty){var a;a=this._node;var b=this._bakeSprite,d=a._children,e=d.length;this.transform(this.getParentRenderCmd(),
!0);var f=this._getBoundingBoxForBake();f.width=0|f.width+.5;f.height=0|f.height+.5;var g=b.getCacheContext(),h=g.getContext();b.resetCanvasSize(f.width,f.height);g.setOffset(0-f.x,h.canvas.height-f.height+f.y);b.setPosition(f.x,f.y);var k;if(cc.renderer._turnToCacheMode(this.__instanceId),0<e){a.sortAllChildren();for(a=0;e>a&&(k=d[a],0>k._localZOrder);a++)k._renderCmd.visit(this);for(cc.renderer.pushRenderCommand(this);e>a;a++)d[a]._renderCmd.visit(this)}else cc.renderer.pushRenderCommand(this);
cc.renderer._renderingToCacheCanvas(g,this.__instanceId);b.transform();this._cacheDirty=!1}};a.visit=function(a){if(!this._isBaked)return void cc.Node.CanvasRenderCmd.prototype.visit.call(this);this._node._visible&&(this._syncStatus(a),cc.renderer.pushRenderCommand(this._bakeRenderCmd),this._bakeSprite._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),this._bakeSprite.visit(this),this._dirtyFlag=0)};a._getBoundingBoxForBake=function(){var a=this._node,b=cc.rect(0,0,a._contentSize.width,
a._contentSize.height),d=a.getNodeToWorldTransform();if(b=cc.rectApplyAffineTransform(b,a.getNodeToWorldTransform()),!a._children||0===a._children.length)return b;for(var a=a._children,e=0;e<a.length;e++){var f=a[e];f&&f._visible&&(f=f._getBoundingBoxToCurrentNode(d),b=cc.rectUnion(b,f))}return b}}(),function(){cc.LayerGradient.RenderCmd={updateStatus:function(){var a=cc.Node._dirtyFlags,c=this._dirtyFlag,b=c&a.colorDirty,d=c&a.opacityDirty;b&&this._updateDisplayColor();d&&this._updateDisplayOpacity();
c&a.transformDirty&&this.transform(null,!0);(b||d||c&a.gradientDirty)&&this._updateColor();this._dirtyFlag=0}}}(),function(){cc.LayerGradient.CanvasRenderCmd=function(a){cc.LayerColor.CanvasRenderCmd.call(this,a);this._needDraw=!0;this._startPoint=cc.p(0,0);this._endPoint=cc.p(0,0);this._endStopStr=this._startStopStr=null};var a=cc.LayerGradient.CanvasRenderCmd.prototype=Object.create(cc.LayerColor.CanvasRenderCmd.prototype);cc.inject(cc.LayerGradient.RenderCmd,a);a.constructor=cc.LayerGradient.CanvasRenderCmd;
a.rendering=function(a,b,d){a=a||cc._renderContext;var e=a.getContext(),f=this._node,g=this._displayedOpacity/255;if(0!==g){var h=f._contentSize.width,k=f._contentSize.height;a.setCompositeOperation(this._blendFuncStr);a.setGlobalAlpha(g);g=e.createLinearGradient(this._startPoint.x*b,this._startPoint.y*d,this._endPoint.x*b,this._endPoint.y*d);if(f._colorStops)for(var m=0;m<f._colorStops.length;m++)g.addColorStop(f._colorStops[m].p,this._colorStopsStr[m]);else g.addColorStop(0,this._startStopStr),
g.addColorStop(1,this._endStopStr);a.setFillStyle(g);a.setTransform(this._worldTransform,b,d);e.fillRect(0,0,h*b,-k*d);cc.g_NumberOfDraws++}};a._syncStatus=function(a){var b=cc.Node._dirtyFlags,d=this._dirtyFlag,e=a?a._node:null;e&&e._cascadeColorEnabled&&a._dirtyFlag&b.colorDirty&&(d|=b.colorDirty);e&&e._cascadeOpacityEnabled&&a._dirtyFlag&b.opacityDirty&&(d|=b.opacityDirty);a&&a._dirtyFlag&b.transformDirty&&(d|=b.transformDirty);var e=d&b.colorDirty,f=d&b.opacityDirty;this._dirtyFlag=d;e&&this._syncDisplayColor();
f&&this._syncDisplayOpacity();d&b.transformDirty&&this.transform(a);(e||f||d&b.gradientDirty)&&this._updateColor()};a._updateColor=function(){var a=this._node,b=a._contentSize,d=.5*b.width,b=.5*b.height;this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.gradientDirty;var e=cc.pAngleSigned(cc.p(0,-1),a._alongVector),e=cc.pRotateByAngle(cc.p(0,-1),cc.p(0,0),e),f=Math.min(Math.abs(1/e.x),Math.abs(1/e.y));this._startPoint.x=d*-e.x*f+d;this._startPoint.y=b*e.y*f-b;this._endPoint.x=d*e.x*f+d;this._endPoint.y=
b*-e.y*f-b;d=this._displayedColor;b=a._endColor;e=a._startOpacity/255;f=a._endOpacity/255;if(this._startStopStr="rgba("+Math.round(d.r)+","+Math.round(d.g)+","+Math.round(d.b)+","+e.toFixed(4)+")",this._endStopStr="rgba("+Math.round(b.r)+","+Math.round(b.g)+","+Math.round(b.b)+","+f.toFixed(4)+")",a._colorStops)for(this._endOpacity=this._startOpacity=0,this._colorStopsStr=[],d=0;d<a._colorStops.length;d++)b=a._colorStops[d].color,e=null==b.a?1:b.a/255,this._colorStopsStr.push("rgba("+Math.round(b.r)+
","+Math.round(b.g)+","+Math.round(b.b)+","+e.toFixed(4)+")")}}(),cc._tmp.PrototypeSprite=function(){var a=cc.Sprite.prototype;cc.defineGetterSetter(a,"opacityModifyRGB",a.isOpacityModifyRGB,a.setOpacityModifyRGB);cc.defineGetterSetter(a,"opacity",a.getOpacity,a.setOpacity);cc.defineGetterSetter(a,"color",a.getColor,a.setColor);a.dirty;a.flippedX;cc.defineGetterSetter(a,"flippedX",a.isFlippedX,a.setFlippedX);a.flippedY;cc.defineGetterSetter(a,"flippedY",a.isFlippedY,a.setFlippedY);a.offsetX;cc.defineGetterSetter(a,
"offsetX",a._getOffsetX);a.offsetY;cc.defineGetterSetter(a,"offsetY",a._getOffsetY);a.atlasIndex;a.texture;cc.defineGetterSetter(a,"texture",a.getTexture,a.setTexture);a.textureRectRotated;cc.defineGetterSetter(a,"textureRectRotated",a.isTextureRectRotated);a.textureAtlas;a.batchNode;cc.defineGetterSetter(a,"batchNode",a.getBatchNode,a.setBatchNode);a.quad;cc.defineGetterSetter(a,"quad",a.getQuad)},cc.Sprite=cc.Node.extend({dirty:!1,atlasIndex:0,textureAtlas:null,_batchNode:null,_recursiveDirty:null,
_hasChildren:null,_shouldBeHidden:!1,_transformToBatch:null,_blendFunc:null,_texture:null,_rect:null,_rectRotated:!1,_offsetPosition:null,_unflippedOffsetPositionFromCenter:null,_opacityModifyRGB:!1,_flippedX:!1,_flippedY:!1,_textureLoaded:!1,_className:"Sprite",ctor:function(a,c,b){cc.Node.prototype.ctor.call(this);this._shouldBeHidden=!1;this._offsetPosition=cc.p(0,0);this._unflippedOffsetPositionFromCenter=cc.p(0,0);this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST};this._rect=cc.rect(0,0,0,0);
this._softInit(a,c,b)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(a,c){this.addEventListener("load",a,c)},isDirty:function(){return this.dirty},setDirty:function(a){this.dirty=a},isTextureRectRotated:function(){return this._rectRotated},getAtlasIndex:function(){return this.atlasIndex},setAtlasIndex:function(a){this.atlasIndex=a},getTextureRect:function(){return cc.rect(this._rect)},getTextureAtlas:function(){return this.textureAtlas},setTextureAtlas:function(a){this.textureAtlas=
a},getOffsetPosition:function(){return cc.p(this._offsetPosition)},_getOffsetX:function(){return this._offsetPosition.x},_getOffsetY:function(){return this._offsetPosition.y},getBlendFunc:function(){return this._blendFunc},initWithSpriteFrame:function(a){cc.assert(a,cc._LogInfos.Sprite_initWithSpriteFrame);a.textureLoaded()||(this._textureLoaded=!1,a.addEventListener("load",this._renderCmd._spriteFrameLoadedCallback,this));var c=cc._renderType===cc._RENDER_TYPE_CANVAS?!1:a._rotated,c=this.initWithTexture(a.getTexture(),
a.getRect(),c);return this.setSpriteFrame(a),c},initWithSpriteFrameName:function(a){cc.assert(a,cc._LogInfos.Sprite_initWithSpriteFrameName);var c=cc.spriteFrameCache.getSpriteFrame(a);return cc.assert(c,a+cc._LogInfos.Sprite_initWithSpriteFrameName1),this.initWithSpriteFrame(c)},useBatchNode:function(a){this.textureAtlas=a.getTextureAtlas();this._batchNode=a},setVertexRect:function(a){var c=this._rect;c.x=a.x;c.y=a.y;c.width=a.width;c.height=a.height},sortAllChildren:function(){if(this._reorderChildDirty){var a,
c,b,d=this._children,e=d.length;for(a=1;e>a;a++){b=d[a];for(c=a-1;0<=c&&(b._localZOrder<d[c]._localZOrder||b._localZOrder===d[c]._localZOrder&&b.arrivalOrder<d[c].arrivalOrder);)d[c+1]=d[c],c--;d[c+1]=b}this._batchNode&&this._arrayMakeObjectsPerformSelector(d,cc.Node._stateCallbackType.sortAllChildren);this._reorderChildDirty=!1}},reorderChild:function(a,c){return cc.assert(a,cc._LogInfos.Sprite_reorderChild_2),-1===this._children.indexOf(a)?void cc.log(cc._LogInfos.Sprite_reorderChild):void(c!==
a.zIndex&&(this._batchNode&&!this._reorderChildDirty&&(this._setReorderChildDirtyRecursively(),this._batchNode.reorderBatch(!0)),cc.Node.prototype.reorderChild.call(this,a,c)))},removeChild:function(a,c){this._batchNode&&this._batchNode.removeSpriteFromAtlas(a);cc.Node.prototype.removeChild.call(this,a,c)},setVisible:function(a){cc.Node.prototype.setVisible.call(this,a);this._renderCmd.setDirtyRecursively(!0)},removeAllChildren:function(a){var c=this._children,b=this._batchNode;if(b&&null!=c)for(var d=
0,e=c.length;e>d;d++)b.removeSpriteFromAtlas(c[d]);cc.Node.prototype.removeAllChildren.call(this,a);this._hasChildren=!1},ignoreAnchorPointForPosition:function(a){return this._batchNode?void cc.log(cc._LogInfos.Sprite_ignoreAnchorPointForPosition):void cc.Node.prototype.ignoreAnchorPointForPosition.call(this,a)},setFlippedX:function(a){this._flippedX!==a&&(this._flippedX=a,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},setFlippedY:function(a){this._flippedY!==
a&&(this._flippedY=a,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},isFlippedX:function(){return this._flippedX},isFlippedY:function(){return this._flippedY},setOpacityModifyRGB:function(a){this._opacityModifyRGB!==a&&(this._opacityModifyRGB=a,this._renderCmd._setColorDirty())},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setDisplayFrameWithAnimationName:function(a,c){cc.assert(a,cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_3);var b=
cc.animationCache.getAnimation(a);return b?(b=b.getFrames()[c])?void this.setSpriteFrame(b.getSpriteFrame()):void cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_2):void cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName)},getBatchNode:function(){return this._batchNode},_setReorderChildDirtyRecursively:function(){if(!this._reorderChildDirty){this._reorderChildDirty=!0;for(var a=this._parent;a&&a!==this._batchNode;)a._setReorderChildDirtyRecursively(),a=a.parent}},getTexture:function(){return this._texture},
_softInit:function(a,c,b){if(void 0===a)cc.Sprite.prototype.init.call(this);else if(cc.isString(a))"#"===a[0]?(c=a.substr(1,a.length-1),(c=cc.spriteFrameCache.getSpriteFrame(c))?this.initWithSpriteFrame(c):cc.log("%s does not exist",a)):cc.Sprite.prototype.init.call(this,a,c);else if("object"==typeof a)if(a instanceof cc.Texture2D)this.initWithTexture(a,c,b);else if(a instanceof cc.SpriteFrame)this.initWithSpriteFrame(a);else if(a instanceof HTMLImageElement||a instanceof HTMLCanvasElement)c=new cc.Texture2D,
c.initWithElement(a),c.handleLoadedTexture(),this.initWithTexture(c)},getQuad:function(){return this._renderCmd.getQuad()},setBlendFunc:function(a,c){var b=this._blendFunc;void 0===c?(b.src=a.src,b.dst=a.dst):(b.src=a,b.dst=c);this._renderCmd.updateBlendFunc(b)},init:function(){return 0<arguments.length?this.initWithFile(arguments[0],arguments[1]):(cc.Node.prototype.init.call(this),this.dirty=this._recursiveDirty=!1,this._blendFunc.src=cc.BLEND_SRC,this._blendFunc.dst=cc.BLEND_DST,this.texture=null,
this._flippedX=this._flippedY=!1,this.anchorX=.5,this.anchorY=.5,this._offsetPosition.x=0,this._offsetPosition.y=0,this._hasChildren=!1,this._renderCmd._init(),this.setTextureRect(cc.rect(0,0,0,0),!1,cc.size(0,0)),!0)},initWithFile:function(a,c){cc.assert(a,cc._LogInfos.Sprite_initWithFile);var b=cc.textureCache.getTextureForKey(a);if(b){if(!c){var d=b.getContentSize();c=cc.rect(0,0,d.width,d.height)}return this.initWithTexture(b,c)}return b=cc.textureCache.addImage(a),this.initWithTexture(b,c||cc.rect(0,
0,b._contentSize.width,b._contentSize.height))},initWithTexture:function(a,c,b,d){if(cc.assert(0!==arguments.length,cc._LogInfos.CCSpriteBatchNode_initWithTexture),b=b||!1,a=this._renderCmd._handleTextureForRotatedTexture(a,c,b,d),!cc.Node.prototype.init.call(this))return!1;this._batchNode=null;this.dirty=this._recursiveDirty=!1;this._opacityModifyRGB=!0;this._blendFunc.src=cc.BLEND_SRC;this._blendFunc.dst=cc.BLEND_DST;this._flippedX=this._flippedY=!1;this.setAnchorPoint(.5,.5);this._offsetPosition.x=
0;this._offsetPosition.y=0;this._hasChildren=!1;this._renderCmd._init();var e=a.isLoaded();return this._textureLoaded=e,e?(c||(c=cc.rect(0,0,a.width,a.height)),this._renderCmd._checkTextureBoundary(a,c,b),this.texture=a,this.setTextureRect(c,b),this.setBatchNode(null),!0):(this._rectRotated=b,c&&(this._rect.x=c.x,this._rect.y=c.y,this._rect.width=c.width,this._rect.height=c.height),this.texture&&this.texture.removeEventListener("load",this),a.addEventListener("load",this._renderCmd._textureLoadedCallback,
this),this.texture=a,!0)},setTextureRect:function(a,c,b,d){this._rectRotated=c||!1;this.setContentSize(b||a);this.setVertexRect(a);this._renderCmd._setTextureCoords(a,d);a=this._unflippedOffsetPositionFromCenter.x;c=this._unflippedOffsetPositionFromCenter.y;this._flippedX&&(a=-a);this._flippedY&&(c=-c);b=this._rect;this._offsetPosition.x=a+(this._contentSize.width-b.width)/2;this._offsetPosition.y=c+(this._contentSize.height-b.height)/2;this._batchNode?this.dirty=!0:this._renderCmd._resetForBatchNode()},
updateTransform:function(){this._renderCmd.updateTransform()},addChild:function(a,c,b){cc.assert(a,cc._LogInfos.CCSpriteBatchNode_addChild_2);null==c&&(c=a._localZOrder);null==b&&(b=a.tag);this._renderCmd._setBatchNodeForAddChild(a)&&(cc.Node.prototype.addChild.call(this,a,c,b),this._hasChildren=!0)},setSpriteFrame:function(a){var c=this;cc.isString(a)&&(a=cc.spriteFrameCache.getSpriteFrame(a),cc.assert(a,cc._LogInfos.Sprite_setSpriteFrame));this.setNodeDirty(!0);var b=a.getOffset();c._unflippedOffsetPositionFromCenter.x=
b.x;c._unflippedOffsetPositionFromCenter.y=b.y;b=a.getTexture();a.textureLoaded()?(b!==c._texture&&(c.texture=b),c.setTextureRect(a.getRect(),a.isRotated(),a.getOriginalSize())):(c._textureLoaded=!1,a.addEventListener("load",function(a){c._textureLoaded=!0;var b=a.getTexture();b!==c._texture&&(c.texture=b);c.setTextureRect(a.getRect(),a.isRotated(),a.getOriginalSize());c.dispatchEvent("load");c.setColor(c.color)},c));this._renderCmd._updateForSetSpriteFrame(b)},setDisplayFrame:function(a){cc.log(cc._LogInfos.Sprite_setDisplayFrame);
this.setSpriteFrame(a)},isFrameDisplayed:function(a){return this._renderCmd.isFrameDisplayed(a)},displayFrame:function(){return this.getSpriteFrame()},getSpriteFrame:function(){return new cc.SpriteFrame(this._texture,cc.rectPointsToPixels(this._rect),this._rectRotated,cc.pointPointsToPixels(this._unflippedOffsetPositionFromCenter),cc.sizePointsToPixels(this._contentSize))},setBatchNode:function(a){(this._batchNode=a)?(this._transformToBatch=cc.affineTransformIdentity(),this.textureAtlas=this._batchNode.getTextureAtlas()):
(this.atlasIndex=cc.Sprite.INDEX_NOT_INITIALIZED,this.textureAtlas=null,this._recursiveDirty=!1,this.dirty=!1,this._renderCmd._resetForBatchNode())},setTexture:function(a){return a?void(cc.isString(a)?(a=cc.textureCache.addImage(a),a._textureLoaded?(this._clearRect(),this._renderCmd._setTexture(a),this._changeRectWithTexture(a.getContentSize()),this.setColor(this._realColor),this._textureLoaded=!0):a.addEventListener("load",function(){this._clearRect();this._renderCmd._setTexture(a);this._changeRectWithTexture(a.getContentSize());
this.setColor(this._realColor);this._textureLoaded=!0},this)):(cc.assert(a instanceof cc.Texture2D,cc._LogInfos.Sprite_setTexture_2),this._clearRect(),this._changeRectWithTexture(a.getContentSize()),this._renderCmd._setTexture(a))):this._renderCmd._setTexture(null)},_clearRect:function(){var a=this._texture;if(a){var a=a._contentSize,c=this._rect;a.width===c.width&&a.height===c.height&&(c.width=c.height=0)}},_changeRectWithTexture:function(a){if(a&&(a.width||a.height)){var c=this.getTextureRect();
c.height||c.width||(a.x=a.x||0,a.y=a.y||0,a.width=a.width||0,a.height=a.height||0,this.setTextureRect(a))}},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.Sprite.CanvasRenderCmd(this):new cc.Sprite.WebGLRenderCmd(this)}}),cc.Sprite.create=function(a,c,b){return new cc.Sprite(a,c,b)},cc.Sprite.createWithTexture=cc.Sprite.create,cc.Sprite.createWithSpriteFrameName=cc.Sprite.create,cc.Sprite.createWithSpriteFrame=cc.Sprite.create,cc.Sprite.INDEX_NOT_INITIALIZED=-1,
cc.EventHelper.prototype.apply(cc.Sprite.prototype),cc.assert(cc.isFunction(cc._tmp.PrototypeSprite),cc._LogInfos.MissingFile,"SpritesPropertyDefine.js"),cc._tmp.PrototypeSprite(),delete cc._tmp.PrototypeSprite,function(){cc.Sprite.CanvasRenderCmd=function(a){cc.Node.CanvasRenderCmd.call(this,a);this._needDraw=!0;this._textureCoord={renderX:0,renderY:0,x:0,y:0,width:0,height:0,validRect:!1};this._blendFuncStr="source-over";this._colorized=!1;this._originalTexture=null};var a=cc.Sprite.CanvasRenderCmd.prototype=
Object.create(cc.Node.CanvasRenderCmd.prototype);a.constructor=cc.Sprite.CanvasRenderCmd;a._init=function(){};a.setDirtyRecursively=function(a){};a._resetForBatchNode=function(){};a._setTexture=function(a){var b=this._node;b._texture!==a&&(a?(a.getHtmlElementObj()instanceof HTMLImageElement&&(this._originalTexture=a),b._textureLoaded=a._textureLoaded):b._textureLoaded=!1,b._texture=a)};a._setColorDirty=function(){this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty)};
a.isFrameDisplayed=function(a){var b=this._node;return a.getTexture()!==b._texture?!1:cc.rectEqualToRect(a.getRect(),b._rect)};a.updateBlendFunc=function(a){this._blendFuncStr=cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(a)};a._setBatchNodeForAddChild=function(a){return!0};a._handleTextureForRotatedTexture=function(a,b,d,e){d&&a.isLoaded()&&(a=a.getHtmlElementObj(),a=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(a,b,e),e=new cc.Texture2D,e.initWithElement(a),e.handleLoadedTexture(),
a=e,b.x=b.y=0,this._node._rect=cc.rect(0,0,b.width,b.height));return a};a._checkTextureBoundary=function(a,b,d){a&&a.url&&(d=b.y+b.height,b.x+b.width>a.width&&cc.error(cc._LogInfos.RectWidth,a.url),d>a.height&&cc.error(cc._LogInfos.RectHeight,a.url));this._node._originalTexture=a};a.rendering=function(a,b,d){var e=this._node,f=this._textureCoord,g=this._displayedOpacity/255;if((!e._texture||0!==f.width&&0!==f.height&&e._texture._textureLoaded)&&0!==g){a=a||cc._renderContext;var h=a.getContext(),k=
e._offsetPosition.x,m=e._rect.height,n=e._rect.width,p=-e._offsetPosition.y-m;(a.setTransform(this._worldTransform,b,d),a.setCompositeOperation(this._blendFuncStr),a.setGlobalAlpha(g),(e._flippedX||e._flippedY)&&a.save(),e._flippedX&&(k=-k-n,h.scale(-1,1)),e._flippedY&&(p=e._offsetPosition.y,h.scale(1,-1)),e._texture)?(g=e._texture._htmlElementObj,""!==e._texture._pattern?(a.setFillStyle(h.createPattern(g,e._texture._pattern)),h.fillRect(k*b,p*d,n*b,m*d)):this._colorized?h.drawImage(g,0,0,f.width,
f.height,k*b,p*d,n*b,m*d):h.drawImage(g,f.renderX,f.renderY,f.width,f.height,k*b,p*d,n*b,m*d)):(g=e._contentSize,f.validRect&&(f=this._displayedColor,a.setFillStyle("rgba("+f.r+","+f.g+","+f.b+",1)"),h.fillRect(k*b,p*d,g.width*b,g.height*d)));(e._flippedX||e._flippedY)&&a.restore();cc.g_NumberOfDraws++}};cc.sys._supportCanvasNewBlendModes?a._updateColor=function(){var a=this._node,b=this._displayedColor;if(255===b.r&&255===b.g&&255===b.b)return void(this._colorized&&(this._colorized=!1,a.texture=
this._originalTexture));var d,e=a._texture,f=this._textureCoord;e&&f.validRect&&this._originalTexture&&(d=e.getHtmlElementObj(),d)&&(this._colorized=!0,d instanceof HTMLCanvasElement&&!this._rectRotated&&!this._newTextureWhenChangeColor&&this._originalTexture._htmlElementObj!==d?cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(this._originalTexture._htmlElementObj,b,f,d):(d=cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(this._originalTexture._htmlElementObj,b,f),e=new cc.Texture2D,
e.initWithElement(d),e.handleLoadedTexture(),a.texture=e))}:a._updateColor=function(){var a=this._node,b=this._displayedColor;if(255===b.r&&255===b.g&&255===b.b)return void(this._colorized&&(this._colorized=!1,a.texture=this._originalTexture));var d,e=a._texture,f=this._textureCoord;if(e&&f.validRect&&this._originalTexture&&(d=e.getHtmlElementObj(),d)){var g=cc.textureCache.getTextureColors(this._originalTexture.getHtmlElementObj());g&&(this._colorized=!0,d instanceof HTMLCanvasElement&&!this._rectRotated&&
!this._newTextureWhenChangeColor?cc.Sprite.CanvasRenderCmd._generateTintImage(d,g,b,f,d):(d=cc.Sprite.CanvasRenderCmd._generateTintImage(d,g,b,f),e=new cc.Texture2D,e.initWithElement(d),e.handleLoadedTexture(),a.texture=e))}};a.getQuad=function(){return null};a._updateForSetSpriteFrame=function(a,b){var d=this._node;if(d._rectRotated&&(d._originalTexture=a),this._colorized=!1,this._textureCoord.renderX=this._textureCoord.x,this._textureCoord.renderY=this._textureCoord.y,b)d=d.getColor(),255===d.r&&
255===d.g&&255===d.b||this._updateColor()};a.updateTransform=function(){var a=this._node;if(a.dirty){var b=a._parent;!a._visible||b&&b!==a._batchNode&&b._shouldBeHidden?a._shouldBeHidden=!0:(a._shouldBeHidden=!1,b&&b!==a._batchNode?a._transformToBatch=cc.affineTransformConcat(this.getNodeToParentTransform(),b._transformToBatch):a._transformToBatch=this.getNodeToParentTransform());a._recursiveDirty=!1;a.dirty=!1}a._hasChildren&&a._arrayMakeObjectsPerformSelector(a._children,cc.Node._stateCallbackType.updateTransform)};
a._updateDisplayColor=function(a){cc.Node.CanvasRenderCmd.prototype._updateDisplayColor.call(this,a)};a._spriteFrameLoadedCallback=function(a){this.setTextureRect(a.getRect(),a.isRotated(),a.getOriginalSize());this._renderCmd._updateColor();this.dispatchEvent("load")};a._textureLoadedCallback=function(a){if(!this._textureLoaded){this._textureLoaded=!0;var b=this._rect,d=this._renderCmd;b?cc._rectEqualToZero(b)&&(b.width=a.width,b.height=a.height):b=cc.rect(0,0,a.width,a.height);this.texture=d._originalTexture=
a;this.setTextureRect(b,this._rectRotated);a=d._displayedColor;255===a.r&&255===a.g&&255===a.b||d._updateColor();this.setBatchNode(this._batchNode);this.dispatchEvent("load")}};a._setTextureCoords=function(a,b){void 0===b&&(b=!0);var d=this._textureCoord,e=b?cc.contentScaleFactor():1;d.renderX=d.x=0|a.x*e;d.renderY=d.y=0|a.y*e;d.width=0|a.width*e;d.height=0|a.height*e;d.validRect=!(0===d.width||0===d.height||0>d.x||0>d.y);this._colorized&&(this._node._texture=this._originalTexture,this._colorized=
!1)};cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply=function(a,b,d,e){e=e||cc.newElement("canvas");d=d||cc.rect(0,0,a.width,a.height);var f=e.getContext("2d");return e.width!==d.width||e.height!==d.height?(e.width=d.width,e.height=d.height):f.globalCompositeOperation="source-over",f.fillStyle="rgb("+(0|b.r)+","+(0|b.g)+","+(0|b.b)+")",f.fillRect(0,0,d.width,d.height),f.globalCompositeOperation="multiply",f.drawImage(a,d.x,d.y,d.width,d.height,0,0,d.width,d.height),f.globalCompositeOperation=
"destination-atop",f.drawImage(a,d.x,d.y,d.width,d.height,0,0,d.width,d.height),e};cc.Sprite.CanvasRenderCmd._generateTintImage=function(a,b,d,e,f){e||(e=cc.rect(0,0,a.width,a.height));var g;a=d.r/255;var h=d.g/255;d=d.b/255;var k=Math.min(e.width,b[0].width),m=Math.min(e.height,b[0].height);f?(g=f.getContext("2d"),g.clearRect(0,0,k,m)):(f=cc.newElement("canvas"),f.width=k,f.height=m,g=f.getContext("2d"));g.save();g.globalCompositeOperation="lighter";var n=g.globalAlpha;return 0<a&&(g.globalAlpha=
a*n,g.drawImage(b[0],e.x,e.y,k,m,0,0,k,m)),0<h&&(g.globalAlpha=h*n,g.drawImage(b[1],e.x,e.y,k,m,0,0,k,m)),0<d&&(g.globalAlpha=d*n,g.drawImage(b[2],e.x,e.y,k,m,0,0,k,m)),1>a+h+d&&(g.globalAlpha=n,g.drawImage(b[3],e.x,e.y,k,m,0,0,k,m)),g.restore(),f};cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor=function(a){function b(){var b=cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor,e=a.width,h=a.height;d[0].width=e;d[0].height=h;d[1].width=e;d[1].height=h;d[2].width=e;d[2].height=h;d[3].width=
e;d[3].height=h;b.canvas.width=e;b.canvas.height=h;var k=b.canvas.getContext("2d");k.drawImage(a,0,0);b.tempCanvas.width=e;b.tempCanvas.height=h;for(var k=k.getImageData(0,0,e,h).data,m=0;4>m;m++){var n=d[m].getContext("2d");n.getImageData(0,0,e,h).data;b.tempCtx.drawImage(a,0,0);for(var p=b.tempCtx.getImageData(0,0,e,h),q=p.data,r=0;r<k.length;r+=4)q[r]=0===m?k[r]:0,q[r+1]=1===m?k[r+1]:0,q[r+2]=2===m?k[r+2]:0,q[r+3]=k[r+3];n.putImageData(p,0,0)}a.onload=null}if(a.channelCache)return a.channelCache;
var d=[cc.newElement("canvas"),cc.newElement("canvas"),cc.newElement("canvas"),cc.newElement("canvas")];try{b()}catch(e){a.onload=b}return a.channelCache=d,d};cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor.canvas=cc.newElement("canvas");cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor.tempCanvas=cc.newElement("canvas");cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor.tempCtx=cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor.tempCanvas.getContext("2d");cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas=
function(a,b,d){if(!a)return null;if(!b)return a;d=null==d?!0:d;var e=cc.newElement("canvas");e.width=b.width;e.height=b.height;var f=e.getContext("2d");return f.translate(e.width/2,e.height/2),f.rotate(d?-1.5707963267948966:1.5707963267948966),f.drawImage(a,b.x,b.y,b.height,b.width,-b.height/2,-b.width/2,b.height,b.width),e}}(),cc.BakeSprite=cc.Sprite.extend({_cacheCanvas:null,_cacheContext:null,ctor:function(){cc.Sprite.prototype.ctor.call(this);var a=document.createElement("canvas");a.width=a.height=
10;this._cacheCanvas=a;this._cacheContext=new cc.CanvasContextWrapper(a.getContext("2d"));var c=new cc.Texture2D;c.initWithElement(a);c.handleLoadedTexture();this.setTexture(c)},getCacheContext:function(){return this._cacheContext},getCacheCanvas:function(){return this._cacheCanvas},resetCanvasSize:function(a,c){void 0===c&&(c=a.height,a=a.width);var b=this._cacheCanvas;b.width=a;b.height=c;this.getTexture().handleLoadedTexture();this.setTextureRect(cc.rect(0,0,a,c),!1)}}),cc.AnimationFrame=cc.Class.extend({_spriteFrame:null,
_delayPerUnit:0,_userInfo:null,ctor:function(a,c,b){this._spriteFrame=a||null;this._delayPerUnit=c||0;this._userInfo=b||null},clone:function(){var a=new cc.AnimationFrame;return a.initWithSpriteFrame(this._spriteFrame.clone(),this._delayPerUnit,this._userInfo),a},copyWithZone:function(a){return cc.clone(this)},copy:function(a){a=new cc.AnimationFrame;return a.initWithSpriteFrame(this._spriteFrame.clone(),this._delayPerUnit,this._userInfo),a},initWithSpriteFrame:function(a,c,b){return this._spriteFrame=
a,this._delayPerUnit=c,this._userInfo=b,!0},getSpriteFrame:function(){return this._spriteFrame},setSpriteFrame:function(a){this._spriteFrame=a},getDelayUnits:function(){return this._delayPerUnit},setDelayUnits:function(a){this._delayPerUnit=a},getUserInfo:function(){return this._userInfo},setUserInfo:function(a){this._userInfo=a}}),cc.AnimationFrame.create=function(a,c,b){return new cc.AnimationFrame(a,c,b)},cc.Animation=cc.Class.extend({_frames:null,_loops:0,_restoreOriginalFrame:!1,_duration:0,
_delayPerUnit:0,_totalDelayUnits:0,ctor:function(a,c,b){if(this._frames=[],void 0===a)this.initWithSpriteFrames(null,0);else{var d=a[0];d&&(d instanceof cc.SpriteFrame?this.initWithSpriteFrames(a,c,b):d instanceof cc.AnimationFrame&&this.initWithAnimationFrames(a,c,b))}},getFrames:function(){return this._frames},setFrames:function(a){this._frames=a},addSpriteFrame:function(a){var c=new cc.AnimationFrame;c.initWithSpriteFrame(a,1,null);this._frames.push(c);this._totalDelayUnits++},addSpriteFrameWithFile:function(a){a=
cc.textureCache.addImage(a);var c=cc.rect(0,0,0,0);c.width=a.width;c.height=a.height;a=new cc.SpriteFrame(a,c);this.addSpriteFrame(a)},addSpriteFrameWithTexture:function(a,c){var b=new cc.SpriteFrame(a,c);this.addSpriteFrame(b)},initWithAnimationFrames:function(a,c,b){cc.arrayVerifyType(a,cc.AnimationFrame);this._delayPerUnit=c;this._loops=void 0===b?1:b;this._totalDelayUnits=0;c=this._frames;for(b=c.length=0;b<a.length;b++){var d=a[b];c.push(d);this._totalDelayUnits+=d.getDelayUnits()}return!0},
clone:function(){var a=new cc.Animation;return a.initWithAnimationFrames(this._copyFrames(),this._delayPerUnit,this._loops),a.setRestoreOriginalFrame(this._restoreOriginalFrame),a},copyWithZone:function(a){a=new cc.Animation;return a.initWithAnimationFrames(this._copyFrames(),this._delayPerUnit,this._loops),a.setRestoreOriginalFrame(this._restoreOriginalFrame),a},_copyFrames:function(){for(var a=[],c=0;c<this._frames.length;c++)a.push(this._frames[c].clone());return a},copy:function(a){return this.copyWithZone(null)},
getLoops:function(){return this._loops},setLoops:function(a){this._loops=a},setRestoreOriginalFrame:function(a){this._restoreOriginalFrame=a},getRestoreOriginalFrame:function(){return this._restoreOriginalFrame},getDuration:function(){return this._totalDelayUnits*this._delayPerUnit},getDelayPerUnit:function(){return this._delayPerUnit},setDelayPerUnit:function(a){this._delayPerUnit=a},getTotalDelayUnits:function(){return this._totalDelayUnits},initWithSpriteFrames:function(a,c,b){cc.arrayVerifyType(a,
cc.SpriteFrame);this._loops=void 0===b?1:b;this._delayPerUnit=c||0;this._totalDelayUnits=0;c=this._frames;if(c.length=0,a){for(b=0;b<a.length;b++){var d=a[b],e=new cc.AnimationFrame;e.initWithSpriteFrame(d,1,null);c.push(e)}this._totalDelayUnits+=a.length}return!0},retain:function(){},release:function(){}}),cc.Animation.create=function(a,c,b){return new cc.Animation(a,c,b)},cc.Animation.createWithAnimationFrames=cc.Animation.create,cc.animationCache={_animations:{},addAnimation:function(a,c){this._animations[c]=
a},removeAnimation:function(a){a&&this._animations[a]&&delete this._animations[a]},getAnimation:function(a){return this._animations[a]?this._animations[a]:null},_addAnimationsWithDictionary:function(a,c){var b=a.animations;if(!b)return void cc.log(cc._LogInfos.animationCache__addAnimationsWithDictionary);var d=1,e=a.properties;if(e)for(var d=null!=e.format?parseInt(e.format):d,e=e.spritesheets,f=cc.spriteFrameCache,g=cc.path,h=0;h<e.length;h++)f.addSpriteFrames(g.changeBasename(c,e[h]));switch(d){case 1:this._parseVersion1(b);
break;case 2:this._parseVersion2(b);break;default:cc.log(cc._LogInfos.animationCache__addAnimationsWithDictionary_2)}},addAnimations:function(a){cc.assert(a,cc._LogInfos.animationCache_addAnimations_2);var c=cc.loader.getRes(a);return c?void this._addAnimationsWithDictionary(c,a):void cc.log(cc._LogInfos.animationCache_addAnimations)},_parseVersion1:function(a){var c=cc.spriteFrameCache,b;for(b in a){var d=a[b],e=d.frames,d=parseFloat(d.delay)||0,f=null;if(e){for(var g=[],h=0;h<e.length;h++){var k=
c.getSpriteFrame(e[h]);if(k){var m=new cc.AnimationFrame;m.initWithSpriteFrame(k,1,null);g.push(m)}else cc.log(cc._LogInfos.animationCache__parseVersion1_2,b,e[h])}0!==g.length?(g.length!==e.length&&cc.log(cc._LogInfos.animationCache__parseVersion1_4,b),f=new cc.Animation(g,d,1),cc.animationCache.addAnimation(f,b)):cc.log(cc._LogInfos.animationCache__parseVersion1_3,b)}else cc.log(cc._LogInfos.animationCache__parseVersion1,b)}},_parseVersion2:function(a){var c=cc.spriteFrameCache,b;for(b in a){var d=
a[b],e=d.loop,f=parseInt(d.loops),e=e?cc.REPEAT_FOREVER:isNaN(f)?1:f,f=d.restoreOriginalFrame&&1==d.restoreOriginalFrame?!0:!1,g=d.frames;if(g){for(var h=[],k=0;k<g.length;k++){var m=g[k],n=m.spriteframe,p=c.getSpriteFrame(n);if(p){var n=parseFloat(m.delayUnits)||0,m=m.notification,q=new cc.AnimationFrame;q.initWithSpriteFrame(p,n,m);h.push(q)}else cc.log(cc._LogInfos.animationCache__parseVersion2_2,b,n)}d=parseFloat(d.delayPerUnit)||0;g=new cc.Animation;g.initWithAnimationFrames(h,d,e);g.setRestoreOriginalFrame(f);
cc.animationCache.addAnimation(g,b)}else cc.log(cc._LogInfos.animationCache__parseVersion2,b)}},_clear:function(){this._animations={}}},cc.SpriteFrame=cc.Class.extend({_offset:null,_originalSize:null,_rectInPixels:null,_rotated:!1,_rect:null,_offsetInPixels:null,_originalSizeInPixels:null,_texture:null,_textureFilename:"",_textureLoaded:!1,ctor:function(a,c,b,d,e){this._offset=cc.p(0,0);this._offsetInPixels=cc.p(0,0);this._originalSize=cc.size(0,0);this._rotated=!1;this._originalSizeInPixels=cc.size(0,
0);this._textureFilename="";this._texture=null;this._textureLoaded=!1;void 0!==a&&void 0!==c&&(void 0===b||void 0===d||void 0===e?this.initWithTexture(a,c):this.initWithTexture(a,c,b,d,e))},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(a,c){this.addEventListener("load",a,c)},getRectInPixels:function(){var a=this._rectInPixels;return cc.rect(a.x,a.y,a.width,a.height)},setRectInPixels:function(a){this._rectInPixels||(this._rectInPixels=cc.rect(0,0,0,0));this._rectInPixels.x=
a.x;this._rectInPixels.y=a.y;this._rectInPixels.width=a.width;this._rectInPixels.height=a.height;this._rect=cc.rectPixelsToPoints(a)},isRotated:function(){return this._rotated},setRotated:function(a){this._rotated=a},getRect:function(){var a=this._rect;return cc.rect(a.x,a.y,a.width,a.height)},setRect:function(a){this._rect||(this._rect=cc.rect(0,0,0,0));this._rect.x=a.x;this._rect.y=a.y;this._rect.width=a.width;this._rect.height=a.height;this._rectInPixels=cc.rectPointsToPixels(this._rect)},getOffsetInPixels:function(){return cc.p(this._offsetInPixels)},
setOffsetInPixels:function(a){this._offsetInPixels.x=a.x;this._offsetInPixels.y=a.y;cc._pointPixelsToPointsOut(this._offsetInPixels,this._offset)},getOriginalSizeInPixels:function(){return cc.size(this._originalSizeInPixels)},setOriginalSizeInPixels:function(a){this._originalSizeInPixels.width=a.width;this._originalSizeInPixels.height=a.height},getOriginalSize:function(){return cc.size(this._originalSize)},setOriginalSize:function(a){this._originalSize.width=a.width;this._originalSize.height=a.height},
getTexture:function(){if(this._texture)return this._texture;if(""!==this._textureFilename){var a=cc.textureCache.addImage(this._textureFilename);return a&&(this._textureLoaded=a.isLoaded()),a}return null},setTexture:function(a){if(this._texture!==a){var c=a.isLoaded();this._textureLoaded=c;this._texture=a;c||a.addEventListener("load",function(a){if(this._textureLoaded=!0,this._rotated&&cc._renderType===cc._RENDER_TYPE_CANVAS){var c=a.getHtmlElementObj(),c=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(c,
this.getRect()),e=new cc.Texture2D;e.initWithElement(c);e.handleLoadedTexture();this.setTexture(e);c=this.getRect();this.setRect(cc.rect(0,0,c.width,c.height))}c=this._rect;0===c.width&&0===c.height&&(c=a.width,a=a.height,this._rect.width=c,this._rect.height=a,this._rectInPixels=cc.rectPointsToPixels(this._rect),this._originalSizeInPixels.width=this._rectInPixels.width,this._originalSizeInPixels.height=this._rectInPixels.height,this._originalSize.width=c,this._originalSize.height=a);this.dispatchEvent("load")},
this)}},getOffset:function(){return cc.p(this._offset)},setOffset:function(a){this._offset.x=a.x;this._offset.y=a.y},clone:function(){var a=new cc.SpriteFrame;return a.initWithTexture(this._textureFilename,this._rectInPixels,this._rotated,this._offsetInPixels,this._originalSizeInPixels),a.setTexture(this._texture),a},copyWithZone:function(){var a=new cc.SpriteFrame;return a.initWithTexture(this._textureFilename,this._rectInPixels,this._rotated,this._offsetInPixels,this._originalSizeInPixels),a.setTexture(this._texture),
a},copy:function(){return this.copyWithZone()},initWithTexture:function(a,c,b,d,e){if(2===arguments.length&&(c=cc.rectPointsToPixels(c)),d=d||cc.p(0,0),e=e||c,b=b||!1,cc.isString(a)?(this._texture=null,this._textureFilename=a):a instanceof cc.Texture2D&&this.setTexture(a),a=this.getTexture(),this._rectInPixels=c,c=this._rect=cc.rectPixelsToPoints(c),a&&a.url&&a.isLoaded()){var f,g;b?(f=c.x+c.height,g=c.y+c.width):(f=c.x+c.width,g=c.y+c.height);f>a.getPixelsWide()&&cc.error(cc._LogInfos.RectWidth,
a.url);g>a.getPixelsHigh()&&cc.error(cc._LogInfos.RectHeight,a.url)}return this._offsetInPixels.x=d.x,this._offsetInPixels.y=d.y,cc._pointPixelsToPointsOut(d,this._offset),this._originalSizeInPixels.width=e.width,this._originalSizeInPixels.height=e.height,cc._sizePixelsToPointsOut(e,this._originalSize),this._rotated=b,!0}}),cc.EventHelper.prototype.apply(cc.SpriteFrame.prototype),cc.SpriteFrame.create=function(a,c,b,d,e){return new cc.SpriteFrame(a,c,b,d,e)},cc.SpriteFrame.createWithTexture=cc.SpriteFrame.create,
cc.SpriteFrame._frameWithTextureForCanvas=function(a,c,b,d,e){var f=new cc.SpriteFrame;return f._texture=a,f._rectInPixels=c,f._rect=cc.rectPixelsToPoints(c),f._offsetInPixels.x=d.x,f._offsetInPixels.y=d.y,cc._pointPixelsToPointsOut(f._offsetInPixels,f._offset),f._originalSizeInPixels.width=e.width,f._originalSizeInPixels.height=e.height,cc._sizePixelsToPointsOut(f._originalSizeInPixels,f._originalSize),f._rotated=b,f},cc.spriteFrameCache={_CCNS_REG1:/^\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*$/,
_CCNS_REG2:/^\s*\{\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*,\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*\}\s*$/,_spriteFrames:{},_spriteFramesAliases:{},_frameConfigCache:{},_rectFromString:function(a){return(a=this._CCNS_REG2.exec(a))?cc.rect(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]),parseFloat(a[4])):cc.rect(0,0,0,0)},_pointFromString:function(a){return(a=this._CCNS_REG1.exec(a))?cc.p(parseFloat(a[1]),parseFloat(a[2])):cc.p(0,0)},_sizeFromString:function(a){return(a=
this._CCNS_REG1.exec(a))?cc.size(parseFloat(a[1]),parseFloat(a[2])):cc.size(0,0)},_getFrameConfig:function(a){var c=cc.loader.getRes(a);return cc.assert(c,cc._LogInfos.spriteFrameCache__getFrameConfig_2,a),cc.loader.release(a),c._inited?(this._frameConfigCache[a]=c,c):(this._frameConfigCache[a]=this._parseFrameConfig(c),this._frameConfigCache[a])},_getFrameConfigByJsonObject:function(a,c){return cc.assert(c,cc._LogInfos.spriteFrameCache__getFrameConfig_2,a),this._frameConfigCache[a]=this._parseFrameConfig(c),
this._frameConfigCache[a]},_parseFrameConfig:function(a){var c=a.frames,b=a.metadata||a.meta;a={};var d={},e=0;b&&(e=b.format,e=1>=e.length?parseInt(e):e,d.image=b.textureFileName||b.textureFileName||b.image);for(var f in c){var g=c[f];if(g){b={};if(0==e){b.rect=cc.rect(g.x,g.y,g.width,g.height);b.rotated=!1;b.offset=cc.p(g.offsetX,g.offsetY);var h=g.originalWidth,g=g.originalHeight;h&&g||cc.log(cc._LogInfos.spriteFrameCache__getFrameConfig);h=Math.abs(h);g=Math.abs(g);b.size=cc.size(h,g)}else if(1==
e||2==e)b.rect=this._rectFromString(g.frame),b.rotated=g.rotated||!1,b.offset=this._pointFromString(g.offset),b.size=this._sizeFromString(g.sourceSize);else if(3==e){var h=this._sizeFromString(g.spriteSize),k=this._rectFromString(g.textureRect);h&&(k=cc.rect(k.x,k.y,h.width,h.height));b.rect=k;b.rotated=g.textureRotated||!1;b.offset=this._pointFromString(g.spriteOffset);b.size=this._sizeFromString(g.spriteSourceSize);b.aliases=g.aliases}else h=g.frame,k=g.sourceSize,f=g.filename||f,b.rect=cc.rect(h.x,
h.y,h.w,h.h),b.rotated=g.rotated||!1,b.offset=cc.p(0,0),b.size=cc.size(k.w,k.h);a[f]=b}}return{_inited:!0,frames:a,meta:d}},_addSpriteFramesByObject:function(a,c,b){if(cc.assert(a,cc._LogInfos.spriteFrameCache_addSpriteFrames_2),c&&c.frames)c=this._frameConfigCache[a]||this._getFrameConfigByJsonObject(a,c),this._createSpriteFrames(a,c,b)},_createSpriteFrames:function(a,c,b){var d=c.frames;c=c.meta;b?b instanceof cc.Texture2D||(cc.isString(b)?b=cc.textureCache.addImage(b):cc.assert(0,cc._LogInfos.spriteFrameCache_addSpriteFrames_3)):
(b=cc.path.changeBasename(a,c.image||".png"),b=cc.textureCache.addImage(b));a=this._spriteFramesAliases;c=this._spriteFrames;for(var e in d){var f=d[e],g=c[e];if(!g){g=new cc.SpriteFrame(b,f.rect,f.rotated,f.offset,f.size);if(f=f.aliases)for(var h=0,k=f.length;k>h;h++){var m=f[h];a[m]&&cc.log(cc._LogInfos.spriteFrameCache_addSpriteFrames,m);a[m]=e}cc._renderType===cc._RENDER_TYPE_CANVAS&&g.isRotated()&&g.getTexture().isLoaded()&&(f=g.getTexture().getHtmlElementObj(),f=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(f,
g.getRectInPixels()),h=new cc.Texture2D,h.initWithElement(f),h.handleLoadedTexture(),g.setTexture(h),f=g._rect,g.setRect(cc.rect(0,0,f.width,f.height)));c[e]=g}}},addSpriteFrames:function(a,c){cc.assert(a,cc._LogInfos.spriteFrameCache_addSpriteFrames_2);var b=this._frameConfigCache[a]||cc.loader.getRes(a);b&&b.frames&&(b=this._frameConfigCache[a]||this._getFrameConfig(a),this._createSpriteFrames(a,b,c))},_checkConflict:function(a){a=a.frames;for(var c in a)this._spriteFrames[c]&&cc.log(cc._LogInfos.spriteFrameCache__checkConflict,
c)},addSpriteFrame:function(a,c){this._spriteFrames[c]=a},removeSpriteFrames:function(){this._spriteFrames={};this._spriteFramesAliases={}},removeSpriteFrameByName:function(a){a&&(this._spriteFramesAliases[a]&&delete this._spriteFramesAliases[a],this._spriteFrames[a]&&delete this._spriteFrames[a])},removeSpriteFramesFromFile:function(a){var c=this._spriteFrames,b=this._spriteFramesAliases;if(a=this._frameConfigCache[a]){a=a.frames;for(var d in a)if(c[d]){delete c[d];for(var e in b)b[e]===d&&delete b[e]}}},
removeSpriteFramesFromTexture:function(a){var c=this._spriteFrames,b=this._spriteFramesAliases,d;for(d in c){var e=c[d];if(e&&e.getTexture()===a){delete c[d];for(var f in b)b[f]===d&&delete b[f]}}},getSpriteFrame:function(a){var c=this._spriteFrames[a];if(!c){var b=this._spriteFramesAliases[a];b&&(c=this._spriteFrames[b.toString()],c||delete this._spriteFramesAliases[a])}return c},_clear:function(){this._spriteFrames={};this._spriteFramesAliases={};this._frameConfigCache={}}},cc.g_NumberOfDraws=0,
cc.GLToClipTransform=function(a){cc.kmGLGetMatrix(cc.KM_GL_PROJECTION,a);var c=new cc.math.Matrix4;cc.kmGLGetMatrix(cc.KM_GL_MODELVIEW,c);a.multiply(c)},cc.Director=cc.Class.extend({_landscape:!1,_nextDeltaTimeZero:!1,_paused:!1,_purgeDirectorInNextLoop:!1,_sendCleanupToScene:!1,_animationInterval:0,_oldAnimationInterval:0,_projection:0,_accumDt:0,_contentScaleFactor:1,_displayStats:!1,_deltaTime:0,_frameRate:0,_FPSLabel:null,_SPFLabel:null,_drawsLabel:null,_winSizeInPoints:null,_lastUpdate:null,
_nextScene:null,_notificationNode:null,_openGLView:null,_scenesStack:null,_projectionDelegate:null,_runningScene:null,_frames:0,_totalFrames:0,_secondsPerFrame:0,_dirtyRegion:null,_scheduler:null,_actionManager:null,_eventProjectionChanged:null,_eventAfterDraw:null,_eventAfterVisit:null,_eventAfterUpdate:null,ctor:function(){var a=this;a._lastUpdate=Date.now();cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){a._lastUpdate=Date.now()})},init:function(){return this._oldAnimationInterval=
this._animationInterval=1/cc.defaultFPS,this._scenesStack=[],this._projection=cc.Director.PROJECTION_DEFAULT,this._projectionDelegate=null,this._accumDt=0,this._frameRate=0,this._displayStats=!1,this._totalFrames=this._frames=0,this._lastUpdate=Date.now(),this._paused=!1,this._purgeDirectorInNextLoop=!1,this._winSizeInPoints=cc.size(0,0),this._openGLView=null,this._contentScaleFactor=1,this._scheduler=new cc.Scheduler,cc.ActionManager?(this._actionManager=new cc.ActionManager,this._scheduler.scheduleUpdate(this._actionManager,
cc.Scheduler.PRIORITY_SYSTEM,!1)):this._actionManager=null,this._eventAfterDraw=new cc.EventCustom(cc.Director.EVENT_AFTER_DRAW),this._eventAfterDraw.setUserData(this),this._eventAfterVisit=new cc.EventCustom(cc.Director.EVENT_AFTER_VISIT),this._eventAfterVisit.setUserData(this),this._eventAfterUpdate=new cc.EventCustom(cc.Director.EVENT_AFTER_UPDATE),this._eventAfterUpdate.setUserData(this),this._eventProjectionChanged=new cc.EventCustom(cc.Director.EVENT_PROJECTION_CHANGED),this._eventProjectionChanged.setUserData(this),
!0},calculateDeltaTime:function(){var a=Date.now();this._nextDeltaTimeZero?(this._deltaTime=0,this._nextDeltaTimeZero=!1):this._deltaTime=(a-this._lastUpdate)/1E3;0<cc.game.config[cc.game.CONFIG_KEY.debugMode]&&.2<this._deltaTime&&(this._deltaTime=1/60);this._lastUpdate=a},convertToGL:null,convertToUI:null,drawScene:function(){var a=cc.renderer;this.calculateDeltaTime();this._paused||(this._scheduler.update(this._deltaTime),cc.eventManager.dispatchEvent(this._eventAfterUpdate));this._clear();this._nextScene&&
this.setNextScene();this._beforeVisitScene&&this._beforeVisitScene();this._runningScene&&(!0===a.childrenOrderDirty?(cc.renderer.clearRenderCommands(),this._runningScene._renderCmd._curLevel=0,this._runningScene.visit(),a.resetFlag()):!0===a.transformDirty()&&a.transform(),cc.eventManager.dispatchEvent(this._eventAfterVisit));this._notificationNode&&this._notificationNode.visit();this._displayStats&&this._showStats();this._afterVisitScene&&this._afterVisitScene();a.rendering(cc._renderContext);cc.eventManager.dispatchEvent(this._eventAfterDraw);
this._totalFrames++;this._displayStats&&this._calculateMPF()},_beforeVisitScene:null,_afterVisitScene:null,end:function(){this._purgeDirectorInNextLoop=!0},getContentScaleFactor:function(){return this._contentScaleFactor},getNotificationNode:function(){return this._notificationNode},getWinSize:function(){return cc.size(this._winSizeInPoints)},getWinSizeInPixels:function(){return cc.size(this._winSizeInPoints.width*this._contentScaleFactor,this._winSizeInPoints.height*this._contentScaleFactor)},getVisibleSize:null,
getVisibleOrigin:null,getZEye:null,pause:function(){this._paused||(this._oldAnimationInterval=this._animationInterval,this.setAnimationInterval(.25),this._paused=!0)},popScene:function(){cc.assert(this._runningScene,cc._LogInfos.Director_popScene);this._scenesStack.pop();var a=this._scenesStack.length;0===a?this.end():(this._sendCleanupToScene=!0,this._nextScene=this._scenesStack[a-1])},purgeCachedData:function(){cc.animationCache._clear();cc.spriteFrameCache._clear();cc.textureCache._clear()},purgeDirector:function(){this.getScheduler().unscheduleAll();
cc.eventManager&&cc.eventManager.setEnabled(!1);this._runningScene&&(this._runningScene.onExitTransitionDidStart(),this._runningScene.onExit(),this._runningScene.cleanup());this._nextScene=this._runningScene=null;this._scenesStack.length=0;this.stopAnimation();this.purgeCachedData();cc.checkGLErrorDebug()},pushScene:function(a){cc.assert(a,cc._LogInfos.Director_pushScene);this._sendCleanupToScene=!1;this._scenesStack.push(a);this._nextScene=a},runScene:function(a){if(cc.assert(a,cc._LogInfos.Director_pushScene),
this._runningScene){var c=this._scenesStack.length;0===c?(this._sendCleanupToScene=!0,this._scenesStack[c]=a,this._nextScene=a):(this._sendCleanupToScene=!0,this._scenesStack[c-1]=a,this._nextScene=a)}else this.pushScene(a),this.startAnimation()},resume:function(){this._paused&&(this.setAnimationInterval(this._oldAnimationInterval),this._lastUpdate=Date.now(),this._lastUpdate||cc.log(cc._LogInfos.Director_resume),this._paused=!1,this._deltaTime=0)},setContentScaleFactor:function(a){a!==this._contentScaleFactor&&
(this._contentScaleFactor=a,this._createStatsLabel())},setDepthTest:null,setDefaultValues:function(){},setNextDeltaTimeZero:function(a){this._nextDeltaTimeZero=a},setNextScene:function(){var a=!1,c=!1;(cc.TransitionScene&&(a=this._runningScene?this._runningScene instanceof cc.TransitionScene:!1,c=this._nextScene?this._nextScene instanceof cc.TransitionScene:!1),c)||((c=this._runningScene)&&(c.onExitTransitionDidStart(),c.onExit()),this._sendCleanupToScene&&c&&c.cleanup());this._runningScene=this._nextScene;
cc.renderer.childrenOrderDirty=!0;this._nextScene=null;a||null===this._runningScene||(this._runningScene.onEnter(),this._runningScene.onEnterTransitionDidFinish())},setNotificationNode:function(a){this._notificationNode=a},getDelegate:function(){return this._projectionDelegate},setDelegate:function(a){this._projectionDelegate=a},setOpenGLView:null,setProjection:null,setViewport:null,getOpenGLView:null,getProjection:null,setAlphaBlending:null,_showStats:function(){this._frames++;this._accumDt+=this._deltaTime;
this._FPSLabel&&this._SPFLabel&&this._drawsLabel?(this._accumDt>cc.DIRECTOR_FPS_INTERVAL&&(this._SPFLabel.string=this._secondsPerFrame.toFixed(3),this._frameRate=this._frames/this._accumDt,this._frames=0,this._accumDt=0,this._FPSLabel.string=this._frameRate.toFixed(1),this._drawsLabel.string=(0|cc.g_NumberOfDraws).toString()),this._FPSLabel.visit(),this._SPFLabel.visit(),this._drawsLabel.visit()):this._createStatsLabel();cc.g_NumberOfDraws=0},isSendCleanupToScene:function(){return this._sendCleanupToScene},
getRunningScene:function(){return this._runningScene},getAnimationInterval:function(){return this._animationInterval},isDisplayStats:function(){return this._displayStats},setDisplayStats:function(a){this._displayStats=a},getSecondsPerFrame:function(){return this._secondsPerFrame},isNextDeltaTimeZero:function(){return this._nextDeltaTimeZero},isPaused:function(){return this._paused},getTotalFrames:function(){return this._totalFrames},popToRootScene:function(){this.popToSceneStackLevel(1)},popToSceneStackLevel:function(a){cc.assert(this._runningScene,
cc._LogInfos.Director_popToSceneStackLevel_2);var c=this._scenesStack,b=c.length;if(0===b)return void this.end();if(!(a>b)){for(;b>a;){var d=c.pop();d.running&&(d.onExitTransitionDidStart(),d.onExit());d.cleanup();b--}this._nextScene=c[c.length-1];this._sendCleanupToScene=!1}},getScheduler:function(){return this._scheduler},setScheduler:function(a){this._scheduler!==a&&(this._scheduler=a)},getActionManager:function(){return this._actionManager},setActionManager:function(a){this._actionManager!==a&&
(this._actionManager=a)},getDeltaTime:function(){return this._deltaTime},_createStatsLabel:null,_calculateMPF:function(){this._secondsPerFrame=(Date.now()-this._lastUpdate)/1E3}}),cc.Director.EVENT_PROJECTION_CHANGED="director_projection_changed",cc.Director.EVENT_AFTER_DRAW="director_after_draw",cc.Director.EVENT_AFTER_VISIT="director_after_visit",cc.Director.EVENT_AFTER_UPDATE="director_after_update",cc.DisplayLinkDirector=cc.Director.extend({invalid:!1,startAnimation:function(){this._nextDeltaTimeZero=
!0;this.invalid=!1},mainLoop:function(){this._purgeDirectorInNextLoop?(this._purgeDirectorInNextLoop=!1,this.purgeDirector()):this.invalid||this.drawScene()},stopAnimation:function(){this.invalid=!0},setAnimationInterval:function(a){this._animationInterval=a;this.invalid||(this.stopAnimation(),this.startAnimation())}}),cc.Director.sharedDirector=null,cc.Director.firstUseDirector=!0,cc.Director._getInstance=function(){return cc.Director.firstUseDirector&&(cc.Director.firstUseDirector=!1,cc.Director.sharedDirector=
new cc.DisplayLinkDirector,cc.Director.sharedDirector.init()),cc.Director.sharedDirector},cc.defaultFPS=60,cc.Director.PROJECTION_2D=0,cc.Director.PROJECTION_3D=1,cc.Director.PROJECTION_CUSTOM=3,cc.Director.PROJECTION_DEFAULT=cc.Director.PROJECTION_3D,cc._renderType===cc._RENDER_TYPE_CANVAS)?(_p=cc.Director.prototype,_p.setProjection=function(a){this._projection=a;cc.eventManager.dispatchEvent(this._eventProjectionChanged)},_p.setDepthTest=function(){},_p.setOpenGLView=function(a){this._winSizeInPoints.width=
cc._canvas.width;this._winSizeInPoints.height=cc._canvas.height;this._openGLView=a||cc.view;cc.eventManager&&cc.eventManager.setEnabled(!0)},_p._clear=function(){var a=this._openGLView.getViewPortRect(),c=cc._renderContext.getContext();c.setTransform(1,0,0,1,0,0);c.clearRect(-a.x,a.y,a.width,a.height)},_p._createStatsLabel=function(){var a=0,a=this._winSizeInPoints.width>this._winSizeInPoints.height?0|this._winSizeInPoints.height/320*24:0|this._winSizeInPoints.width/320*24;this._FPSLabel=new cc.LabelTTF("000.0",
"Arial",a);this._SPFLabel=new cc.LabelTTF("0.000","Arial",a);this._drawsLabel=new cc.LabelTTF("0000","Arial",a);a=cc.DIRECTOR_STATS_POSITION;this._drawsLabel.setPosition(this._drawsLabel.width/2+a.x,5*this._drawsLabel.height/2+a.y);this._SPFLabel.setPosition(this._SPFLabel.width/2+a.x,3*this._SPFLabel.height/2+a.y);this._FPSLabel.setPosition(this._FPSLabel.width/2+a.x,this._FPSLabel.height/2+a.y)},_p.getVisibleSize=function(){return this.getWinSize()},_p.getVisibleOrigin=function(){return cc.p(0,
0)}):(cc.Director._fpsImage=new Image,cc._addEventListener(cc.Director._fpsImage,"load",function(){cc.Director._fpsImageLoaded=!0}),cc._fpsImage&&(cc.Director._fpsImage.src=cc._fpsImage));cc.PRIORITY_NON_SYSTEM=cc.PRIORITY_SYSTEM+1;cc.ListEntry=function(a,c,b,d,e,f,g){this.prev=a;this.next=c;this.callback=b;this.target=d;this.priority=e;this.paused=f;this.markedForDeletion=g};cc.HashUpdateEntry=function(a,c,b,d,e){this.list=a;this.entry=c;this.target=b;this.callback=d;this.hh=e};
cc.HashTimerEntry=cc.hashSelectorEntry=function(a,c,b,d,e,f,g){this.timers=a;this.target=c;this.timerIndex=b;this.currentTimer=d;this.currentTimerSalvaged=e;this.paused=f;this.hh=g};
cc.Timer=cc.Class.extend({_scheduler:null,_elapsed:0,_runForever:!1,_useDelay:!1,_timesExecuted:0,_repeat:0,_delay:0,_interval:0,getInterval:function(){return this._interval},setInterval:function(a){this._interval=a},setupTimerWithInterval:function(a,c,b){this._elapsed=-1;this._interval=a;this._delay=b;this._useDelay=0<this._delay;this._repeat=c;this._runForever=this._repeat===cc.REPEAT_FOREVER},trigger:function(){return 0},cancel:function(){return 0},ctor:function(){this._scheduler=null;this._elapsed=
-1;this._useDelay=this._runForever=!1;this._interval=this._delay=this._repeat=this._timesExecuted=0},update:function(a){-1===this._elapsed?(this._elapsed=0,this._timesExecuted=0):(this._elapsed+=a,this._runForever&&!this._useDelay?this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0):(this._useDelay?this._elapsed>=this._delay&&(this.trigger(),this._elapsed-=this._delay,this._timesExecuted+=1,this._useDelay=!1):this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0,this._timesExecuted+=
1),!this._runForever&&this._timesExecuted>this._repeat&&this.cancel()))}});
cc.TimerTargetSelector=cc.Timer.extend({_target:null,_selector:null,ctor:function(){this._selector=this._target=null},initWithSelector:function(a,c,b,d,e,f){return this._scheduler=a,this._target=b,this._selector=c,this.setupTimerWithInterval(d,e,f),!0},getSelector:function(){return this._selector},trigger:function(){this._target&&this._selector&&this._target.call(this._selector,this._elapsed)},cancel:function(){this._scheduler.unschedule(this._selector,this._target)}});
cc.TimerTargetCallback=cc.Timer.extend({_target:null,_callback:null,_key:null,ctor:function(){this._callback=this._target=null},initWithCallback:function(a,c,b,d,e,f,g){return this._scheduler=a,this._target=b,this._callback=c,this._key=d,this.setupTimerWithInterval(e,f,g),!0},getCallback:function(){return this._callback},getKey:function(){return this._key},trigger:function(){this._callback&&this._callback.call(this._target,this._elapsed)},cancel:function(){this._scheduler.unschedule(this._callback,
this._target)}});
cc.Scheduler=cc.Class.extend({_timeScale:1,_updatesNegList:null,_updates0List:null,_updatesPosList:null,_hashForTimers:null,_arrayForTimers:null,_hashForUpdates:null,_currentTarget:null,_currentTargetSalvaged:!1,_updateHashLocked:!1,ctor:function(){this._timeScale=1;this._updatesNegList=[];this._updates0List=[];this._updatesPosList=[];this._hashForUpdates={};this._hashForTimers={};this._currentTarget=null;this._updateHashLocked=this._currentTargetSalvaged=!1;this._arrayForTimers=[]},_schedulePerFrame:function(a,
c,b,d){var e=this._hashForUpdates[c.__instanceId];if(e&&e.entry){if(e.entry.priority===b)return e.entry.markedForDeletion=!1,void(e.entry.paused=d);if(this._updateHashLocked)return cc.log("warning: you CANNOT change update priority in scheduled function"),e.entry.markedForDeletion=!1,void(e.entry.paused=d);this.unscheduleUpdate(c)}0===b?this._appendIn(this._updates0List,a,c,d):0>b?this._priorityIn(this._updatesNegList,a,c,b,d):this._priorityIn(this._updatesPosList,a,c,b,d)},_removeHashElement:function(a){delete this._hashForTimers[a.target.__instanceId];
cc.arrayRemoveObject(this._arrayForTimers,a);a.Timer=null;a.target=null},_removeUpdateFromHash:function(a){(a=this._hashForUpdates[a.target.__instanceId])&&(cc.arrayRemoveObject(a.list,a.entry),delete this._hashForUpdates[a.target.__instanceId],a.entry=null,a.target=null)},_priorityIn:function(a,c,b,d,e){c=new cc.ListEntry(null,null,c,b,d,e,!1);if(a){e=a.length-1;for(var f=0;e>=f&&!(d<a[f].priority);f++);a.splice(f,0,c)}else a=[],a.push(c);return this._hashForUpdates[b.__instanceId]=new cc.HashUpdateEntry(a,
c,b,null),a},_appendIn:function(a,c,b,d){c=new cc.ListEntry(null,null,c,b,0,d,!1);a.push(c);this._hashForUpdates[b.__instanceId]=new cc.HashUpdateEntry(a,c,b,null,null)},setTimeScale:function(a){this._timeScale=a},getTimeScale:function(){return this._timeScale},update:function(a){this._updateHashLocked=!0;1!==this._timeScale&&(a*=this._timeScale);var c,b,d,e;c=0;b=this._updatesNegList;for(d=b.length;d>c;c++)e=b[c],e.paused||e.markedForDeletion||e.callback(a);c=0;b=this._updates0List;for(d=b.length;d>
c;c++)e=b[c],e.paused||e.markedForDeletion||e.callback(a);c=0;b=this._updatesPosList;for(d=b.length;d>c;c++)e=b[c],e.paused||e.markedForDeletion||e.callback(a);var f;b=this._arrayForTimers;for(c=0;c<b.length;c++){if(f=b[c],this._currentTarget=f,this._currentTargetSalvaged=!1,!f.paused)for(f.timerIndex=0;f.timerIndex<f.timers.length;++f.timerIndex)f.currentTimer=f.timers[f.timerIndex],f.currentTimerSalvaged=!1,f.currentTimer.update(a),f.currentTimer=null;this._currentTargetSalvaged&&0===this._currentTarget.timers.length&&
this._removeHashElement(this._currentTarget)}c=0;for(b=this._updatesNegList;c<b.length;)e=b[c],e.markedForDeletion?this._removeUpdateFromHash(e):c++;c=0;for(b=this._updates0List;c<b.length;)e=b[c],e.markedForDeletion?this._removeUpdateFromHash(e):c++;c=0;for(b=this._updatesPosList;c<b.length;)e=b[c],e.markedForDeletion?this._removeUpdateFromHash(e):c++;this._updateHashLocked=!1;this._currentTarget=null},scheduleCallbackForTarget:function(a,c,b,d,e,f){this.schedule(c,a,b,d,e,f,a.__instanceId+"")},
schedule:function(a,c,b,d,e,f,g){var h=!1;if("function"!=typeof a)var k=a,h=!0;!1===h?5===arguments.length&&(g=e,f=d,e=0,d=cc.REPEAT_FOREVER):4===arguments.length&&(f=d,d=cc.REPEAT_FOREVER,e=0);cc.assert(c,cc._LogInfos.Scheduler_scheduleCallbackForTarget_3);!1===h&&cc.assert(g,"key should not be empty!");var m=this._hashForTimers[c.__instanceId];m?cc.assert(m.paused===f,""):(m=new cc.HashTimerEntry(null,c,0,null,null,f,null),this._arrayForTimers.push(m),this._hashForTimers[c.__instanceId]=m);var n,
p;if(null==m.timers)m.timers=[];else if(!1===h)for(p=0;p<m.timers.length;p++){if(n=m.timers[p],a===n._callback)return cc.log(cc._LogInfos.Scheduler_scheduleCallbackForTarget,n.getInterval().toFixed(4),b.toFixed(4)),void(n._interval=b)}else for(p=0;p<m.timers.length;++p)if(n=m.timers[p],n&&k===n.getSelector())return cc.log("CCScheduler#scheduleSelector. Selector already scheduled. Updating interval from: %.4f to %.4f",n.getInterval(),b),void n.setInterval(b);!1===h?(n=new cc.TimerTargetCallback,n.initWithCallback(this,
a,c,g,b,d,e),m.timers.push(n)):(n=new cc.TimerTargetSelector,n.initWithSelector(this,k,c,b,d,e),m.timers.push(n))},scheduleUpdate:function(a,c,b){this._schedulePerFrame(function(c){a.update(c)},a,c,b)},_getUnscheduleMark:function(a,c){switch(typeof a){case "number":case "string":return a===c.getKey();case "function":return a===c._callback;default:return a===c.getSelector()}},unschedule:function(a,c){if(c&&a){var b=this._hashForTimers[c.__instanceId];if(b)for(var d=b.timers,e=0,f=d.length;f>e;e++){var g=
d[e];if(this._getUnscheduleMark(a,g))return g!==b.currentTimer||b.currentTimerSalvaged||(b.currentTimerSalvaged=!0),d.splice(e,1),b.timerIndex>=e&&b.timerIndex--,void(0===d.length&&(this._currentTarget===b?this._currentTargetSalvaged=!0:this._removeHashElement(b)))}}},unscheduleUpdate:function(a){null!=a&&(a=this._hashForUpdates[a.__instanceId])&&(this._updateHashLocked?a.entry.markedForDeletion=!0:this._removeUpdateFromHash(a.entry))},unscheduleAllForTarget:function(a){if(null!=a){var c=this._hashForTimers[a.__instanceId];
c&&(-1<c.timers.indexOf(c.currentTimer)&&!c.currentTimerSalvaged&&(c.currentTimerSalvaged=!0),c.timers.length=0,this._currentTarget===c?this._currentTargetSalvaged=!0:this._removeHashElement(c));this.unscheduleUpdate(a)}},unscheduleAll:function(){this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},unscheduleAllWithMinPriority:function(a){var c,b,d=this._arrayForTimers;for(c=0;c<d.length;c++)b=d[c],this.unscheduleAllForTarget(b.target);d=0;if(0>a)for(c=0;c<this._updatesNegList.length;)d=
this._updatesNegList.length,(b=this._updatesNegList[c])&&b.priority>=a&&this.unscheduleUpdate(b.target),d==this._updatesNegList.length&&c++;if(0>=a)for(c=0;c<this._updates0List.length;)d=this._updates0List.length,(b=this._updates0List[c])&&this.unscheduleUpdate(b.target),d==this._updates0List.length&&c++;for(c=0;c<this._updatesPosList.length;)d=this._updatesPosList.length,(b=this._updatesPosList[c])&&b.priority>=a&&this.unscheduleUpdate(b.target),d==this._updatesPosList.length&&c++},isScheduled:function(a,
c){cc.assert(a,"Argument key must not be empty");cc.assert(c,"Argument target must be non-nullptr");var b=this._hashForUpdates[c.__instanceId];if(!b||null==b.timers)return!1;for(var b=b.timers,d=0;d<b.length;++d)if(a===b[d].getKey())return!0;return!1},pauseAllTargets:function(){return this.pauseAllTargetsWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},pauseAllTargetsWithMinPriority:function(a){var c,b,d,e=[],f=this._arrayForTimers;b=0;for(d=f.length;d>b;b++)(c=f[b])&&(c.paused=!0,e.push(c.target));
if(0>a)for(b=0;b<this._updatesNegList.length;b++)(c=this._updatesNegList[b])&&c.priority>=a&&(c.paused=!0,e.push(c.target));if(0>=a)for(b=0;b<this._updates0List.length;b++)(c=this._updates0List[b])&&(c.paused=!0,e.push(c.target));for(b=0;b<this._updatesPosList.length;b++)(c=this._updatesPosList[b])&&c.priority>=a&&(c.paused=!0,e.push(c.target));return e},resumeTargets:function(a){if(a)for(var c=0;c<a.length;c++)this.resumeTarget(a[c])},pauseTarget:function(a){cc.assert(a,cc._LogInfos.Scheduler_pauseTarget);
var c=this._hashForTimers[a.__instanceId];c&&(c.paused=!0);(a=this._hashForUpdates[a.__instanceId])&&(a.entry.paused=!0)},resumeTarget:function(a){cc.assert(a,cc._LogInfos.Scheduler_resumeTarget);var c=this._hashForTimers[a.__instanceId];c&&(c.paused=!1);(a=this._hashForUpdates[a.__instanceId])&&(a.entry.paused=!1)},isTargetPaused:function(a){cc.assert(a,cc._LogInfos.Scheduler_isTargetPaused);var c=this._hashForTimers[a.__instanceId];return c?c.paused:(a=this._hashForUpdates[a.__instanceId])?a.entry.paused:
!1},scheduleUpdateForTarget:function(a,c,b){this.scheduleUpdate(a,c,b)},unscheduleCallbackForTarget:function(a,c){this.unschedule(c,a)},unscheduleUpdateForTarget:function(a){this.unscheduleUpdate(a)},unscheduleAllCallbacksForTarget:function(a){this.unschedule(a.__instanceId+"",a)},unscheduleAllCallbacks:function(){this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},unscheduleAllCallbacksWithMinPriority:function(a){this.unscheduleAllWithMinPriority(a)}});cc.Scheduler.PRIORITY_SYSTEM=-2147483648;
cc._tmp.PrototypeLabelTTF=function(){var a=cc.LabelTTF.prototype;cc.defineGetterSetter(a,"color",a.getColor,a.setColor);cc.defineGetterSetter(a,"opacity",a.getOpacity,a.setOpacity);a.string;cc.defineGetterSetter(a,"string",a.getString,a.setString);a.textAlign;cc.defineGetterSetter(a,"textAlign",a.getHorizontalAlignment,a.setHorizontalAlignment);a.verticalAlign;cc.defineGetterSetter(a,"verticalAlign",a.getVerticalAlignment,a.setVerticalAlignment);a.fontSize;cc.defineGetterSetter(a,"fontSize",a.getFontSize,
a.setFontSize);a.fontName;cc.defineGetterSetter(a,"fontName",a.getFontName,a.setFontName);a.font;cc.defineGetterSetter(a,"font",a._getFont,a._setFont);a.boundingSize;a.boundingWidth;cc.defineGetterSetter(a,"boundingWidth",a._getBoundingWidth,a._setBoundingWidth);a.boundingHeight;cc.defineGetterSetter(a,"boundingHeight",a._getBoundingHeight,a._setBoundingHeight);a.fillStyle;cc.defineGetterSetter(a,"fillStyle",a._getFillStyle,a.setFontFillColor);a.strokeStyle;cc.defineGetterSetter(a,"strokeStyle",a._getStrokeStyle,
a._setStrokeStyle);a.lineWidth;cc.defineGetterSetter(a,"lineWidth",a._getLineWidth,a._setLineWidth);a.shadowOffset;a.shadowOffsetX;cc.defineGetterSetter(a,"shadowOffsetX",a._getShadowOffsetX,a._setShadowOffsetX);a.shadowOffsetY;cc.defineGetterSetter(a,"shadowOffsetY",a._getShadowOffsetY,a._setShadowOffsetY);a.shadowOpacity;cc.defineGetterSetter(a,"shadowOpacity",a._getShadowOpacity,a._setShadowOpacity);a.shadowBlur;cc.defineGetterSetter(a,"shadowBlur",a._getShadowBlur,a._setShadowBlur)};
cc.LabelTTF=cc.Sprite.extend({_dimensions:null,_hAlignment:cc.TEXT_ALIGNMENT_CENTER,_vAlignment:cc.VERTICAL_TEXT_ALIGNMENT_TOP,_fontName:null,_fontSize:0,_string:"",_originalText:null,_shadowEnabled:!1,_shadowOffset:null,_shadowOpacity:0,_shadowBlur:0,_shadowColor:null,_strokeEnabled:!1,_strokeColor:null,_strokeSize:0,_textFillColor:null,_strokeShadowOffsetX:0,_strokeShadowOffsetY:0,_needUpdateTexture:!1,_lineWidths:null,_className:"LabelTTF",_fontStyle:"normal",_fontWeight:"normal",_lineHeight:"normal",
initWithString:function(a,c,b,d,e,f){var g;return g=a?a+"":"",b=b||16,d=d||cc.size(0,0),e=e||cc.TEXT_ALIGNMENT_LEFT,f=f||cc.VERTICAL_TEXT_ALIGNMENT_TOP,this._opacityModifyRGB=!1,this._dimensions=cc.size(d.width,d.height),this._fontName=c||"Arial",this._hAlignment=e,this._vAlignment=f,this._fontSize=b,this._renderCmd._setFontStyle(this._fontName,b,this._fontStyle,this._fontWeight),this.string=g,this._renderCmd._setColorsString(),this._renderCmd._updateTexture(),this._setUpdateTextureDirty(),!0},_setUpdateTextureDirty:function(){this._needUpdateTexture=
!0;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.textDirty)},ctor:function(a,c,b,d,e,f){cc.Sprite.prototype.ctor.call(this);this._dimensions=cc.size(0,0);this._hAlignment=cc.TEXT_ALIGNMENT_LEFT;this._vAlignment=cc.VERTICAL_TEXT_ALIGNMENT_TOP;this._opacityModifyRGB=!1;this._fontName="Arial";this._shadowEnabled=!1;this._shadowOffset=cc.p(0,0);this._shadowBlur=this._shadowOpacity=0;this._strokeEnabled=!1;this._strokeColor=cc.color(255,255,255,255);this._strokeSize=0;this._textFillColor=cc.color(255,
255,255,255);this._strokeShadowOffsetY=this._strokeShadowOffsetX=0;this._needUpdateTexture=!1;this._lineWidths=[];this._renderCmd._setColorsString();this._textureLoaded=!0;c&&c instanceof cc.FontDefinition?this.initWithStringAndTextDefinition(a,c):cc.LabelTTF.prototype.initWithString.call(this,a,c,b,d,e,f)},init:function(){return this.initWithString(" ",this._fontName,this._fontSize)},description:function(){return"<cc.LabelTTF | FontName ="+this._fontName+" FontSize = "+this._fontSize.toFixed(1)+
">"},getLineHeight:function(){return!this._lineHeight||this._lineHeight.charAt?this._renderCmd._getFontClientHeight():this._lineHeight||this._renderCmd._getFontClientHeight()},setLineHeight:function(a){this._lineHeight=a},getString:function(){return this._string},getHorizontalAlignment:function(){return this._hAlignment},getVerticalAlignment:function(){return this._vAlignment},getDimensions:function(){return cc.size(this._dimensions)},getFontSize:function(){return this._fontSize},getFontName:function(){return this._fontName},
initWithStringAndTextDefinition:function(a,c){return this._updateWithTextDefinition(c,!1),this.string=a,!0},setTextDefinition:function(a){a&&this._updateWithTextDefinition(a,!0)},getTextDefinition:function(){return this._prepareTextDefinition(!1)},enableShadow:function(a,c,b,d){null!=a.r&&null!=a.g&&null!=a.b&&null!=a.a?this._enableShadow(a,c,b):this._enableShadowNoneColor(a,c,b,d)},_enableShadowNoneColor:function(a,c,b,d){b=b||.5;!1===this._shadowEnabled&&(this._shadowEnabled=!0);var e=this._shadowOffset;
(e&&e.x!==a||e._y!==c)&&(e.x=a,e.y=c);this._shadowOpacity!==b&&(this._shadowOpacity=b);this._renderCmd._setColorsString();this._shadowBlur!==d&&(this._shadowBlur=d);this._setUpdateTextureDirty()},_enableShadow:function(a,c,b){this._shadowColor||(this._shadowColor=cc.color(255,255,255,128));this._shadowColor.r=a.r;this._shadowColor.g=a.g;this._shadowColor.b=a.b;this._enableShadowNoneColor(c.width||c.x||0,c.height||c.y||0,null!=a.a?a.a/255:.5,b)},_getShadowOffsetX:function(){return this._shadowOffset.x},
_setShadowOffsetX:function(a){!1===this._shadowEnabled&&(this._shadowEnabled=!0);this._shadowOffset.x!==a&&(this._shadowOffset.x=a,this._setUpdateTextureDirty())},_getShadowOffsetY:function(){return this._shadowOffset._y},_setShadowOffsetY:function(a){!1===this._shadowEnabled&&(this._shadowEnabled=!0);this._shadowOffset._y!==a&&(this._shadowOffset._y=a,this._setUpdateTextureDirty())},_getShadowOffset:function(){return cc.p(this._shadowOffset.x,this._shadowOffset.y)},_setShadowOffset:function(a){!1===
this._shadowEnabled&&(this._shadowEnabled=!0);this._shadowOffset.x===a.x&&this._shadowOffset.y===a.y||(this._shadowOffset.x=a.x,this._shadowOffset.y=a.y,this._setUpdateTextureDirty())},_getShadowOpacity:function(){return this._shadowOpacity},_setShadowOpacity:function(a){!1===this._shadowEnabled&&(this._shadowEnabled=!0);this._shadowOpacity!==a&&(this._shadowOpacity=a,this._renderCmd._setColorsString(),this._setUpdateTextureDirty())},_getShadowBlur:function(){return this._shadowBlur},_setShadowBlur:function(a){!1===
this._shadowEnabled&&(this._shadowEnabled=!0);this._shadowBlur!==a&&(this._shadowBlur=a,this._setUpdateTextureDirty())},disableShadow:function(){this._shadowEnabled&&(this._shadowEnabled=!1,this._setUpdateTextureDirty())},enableStroke:function(a,c){!1===this._strokeEnabled&&(this._strokeEnabled=!0);var b=this._strokeColor;b.r===a.r&&b.g===a.g&&b.b===a.b||(b.r=a.r,b.g=a.g,b.b=a.b,this._renderCmd._setColorsString());this._strokeSize!==c&&(this._strokeSize=c||0);this._setUpdateTextureDirty()},_getStrokeStyle:function(){return this._strokeColor},
_setStrokeStyle:function(a){!1===this._strokeEnabled&&(this._strokeEnabled=!0);var c=this._strokeColor;c.r===a.r&&c.g===a.g&&c.b===a.b||(c.r=a.r,c.g=a.g,c.b=a.b,this._renderCmd._setColorsString(),this._setUpdateTextureDirty())},_getLineWidth:function(){return this._strokeSize},_setLineWidth:function(a){!1===this._strokeEnabled&&(this._strokeEnabled=!0);this._strokeSize!==a&&(this._strokeSize=a||0,this._setUpdateTextureDirty())},disableStroke:function(){this._strokeEnabled&&(this._strokeEnabled=!1,
this._setUpdateTextureDirty())},setFontFillColor:function(a){var c=this._textFillColor;(c.r!==a.r||c.g!==a.g||c.b!==a.b)&&(c.r=a.r,c.g=a.g,c.b=a.b,this._renderCmd._setColorsString(),this._needUpdateTexture=!0)},_getFillStyle:function(){return this._textFillColor},_updateWithTextDefinition:function(a,c){a.fontDimensions?(this._dimensions.width=a.boundingWidth,this._dimensions.height=a.boundingHeight):(this._dimensions.width=0,this._dimensions.height=0);this._hAlignment=a.textAlign;this._vAlignment=
a.verticalAlign;this._fontName=a.fontName;this._fontSize=a.fontSize||12;a.lineHeight?this._lineHeight=a.lineHeight:this._lineHeight=this._fontSize;this._renderCmd._setFontStyle(a);a.shadowEnabled&&this.enableShadow(a.shadowOffsetX,a.shadowOffsetY,a.shadowOpacity,a.shadowBlur);a.strokeEnabled&&this.enableStroke(a.strokeStyle,a.lineWidth);this.setFontFillColor(a.fillStyle);c&&this._renderCmd._updateTexture();var b=cc.Node._dirtyFlags;this._renderCmd.setDirtyFlag(b.colorDirty|b.opacityDirty|b.textDirty)},
_prepareTextDefinition:function(a){var c=new cc.FontDefinition;if(a?(c.fontSize=this._fontSize,c.boundingWidth=cc.contentScaleFactor()*this._dimensions.width,c.boundingHeight=cc.contentScaleFactor()*this._dimensions.height):(c.fontSize=this._fontSize,c.boundingWidth=this._dimensions.width,c.boundingHeight=this._dimensions.height),c.fontName=this._fontName,c.textAlign=this._hAlignment,c.verticalAlign=this._vAlignment,this._strokeEnabled){c.strokeEnabled=!0;var b=this._strokeColor;c.strokeStyle=cc.color(b.r,
b.g,b.b);c.lineWidth=this._strokeSize}else c.strokeEnabled=!1;this._shadowEnabled?(c.shadowEnabled=!0,c.shadowBlur=this._shadowBlur,c.shadowOpacity=this._shadowOpacity,c.shadowOffsetX=(a?cc.contentScaleFactor():1)*this._shadowOffset.x,c.shadowOffsetY=(a?cc.contentScaleFactor():1)*this._shadowOffset.y):c._shadowEnabled=!1;a=this._textFillColor;return c.fillStyle=cc.color(a.r,a.g,a.b),c},setString:function(a){a=String(a);this._originalText!==a&&(this._originalText=a+"",this._updateString(),this._setUpdateTextureDirty(),
this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty))},_updateString:function(){this._string&&""!==this._string||this._string===this._originalText||(cc.renderer.childrenOrderDirty=!0);this._string=this._originalText},setHorizontalAlignment:function(a){a!==this._hAlignment&&(this._hAlignment=a,this._setUpdateTextureDirty())},setVerticalAlignment:function(a){a!==this._vAlignment&&(this._vAlignment=a,this._setUpdateTextureDirty())},setDimensions:function(a,c){var b;void 0===c?(b=a.width,
c=a.height):b=a;b===this._dimensions.width&&c===this._dimensions.height||(this._dimensions.width=b,this._dimensions.height=c,this._updateString(),this._setUpdateTextureDirty())},_getBoundingWidth:function(){return this._dimensions.width},_setBoundingWidth:function(a){a!==this._dimensions.width&&(this._dimensions.width=a,this._updateString(),this._setUpdateTextureDirty())},_getBoundingHeight:function(){return this._dimensions.height},_setBoundingHeight:function(a){a!==this._dimensions.height&&(this._dimensions.height=
a,this._updateString(),this._setUpdateTextureDirty())},setFontSize:function(a){this._fontSize!==a&&(this._fontSize=a,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},setFontName:function(a){this._fontName&&this._fontName!==a&&(this._fontName=a,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFont:function(){return this._renderCmd._getFontStyle()},
_setFont:function(a){(a=cc.LabelTTF._fontStyleRE.exec(a))&&(this._fontSize=parseInt(a[1]),this._fontName=a[2],this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},getContentSize:function(){return this._needUpdateTexture&&this._renderCmd._updateTTF(),cc.Sprite.prototype.getContentSize.call(this)},_getWidth:function(){return this._needUpdateTexture&&this._renderCmd._updateTTF(),cc.Sprite.prototype._getWidth.call(this)},_getHeight:function(){return this._needUpdateTexture&&
this._renderCmd._updateTTF(),cc.Sprite.prototype._getHeight.call(this)},setTextureRect:function(a,c,b){cc.Sprite.prototype.setTextureRect.call(this,a,c,b,!1)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.LabelTTF.CanvasRenderCmd(this):new cc.LabelTTF.WebGLRenderCmd(this)},_setFontStyle:function(a){this._fontStyle!==a&&(this._fontStyle=a,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},
_getFontStyle:function(){return this._fontStyle},_setFontWeight:function(a){this._fontWeight!==a&&(this._fontWeight=a,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFontWeight:function(){return this._fontWeight}});cc.assert(cc.isFunction(cc._tmp.PrototypeLabelTTF),cc._LogInfos.MissingFile,"LabelTTFPropertyDefine.js");cc._tmp.PrototypeLabelTTF();delete cc._tmp.PrototypeLabelTTF;cc.LabelTTF._fontStyleRE=/^(\d+)px\s+['"]?([\w\s\d]+)['"]?$/;
cc.LabelTTF.create=function(a,c,b,d,e,f){return new cc.LabelTTF(a,c,b,d,e,f)};cc.LabelTTF.createWithFontDefinition=cc.LabelTTF.create;cc.USE_LA88_LABELS?cc.LabelTTF._SHADER_PROGRAM=cc.SHADER_POSITION_TEXTURECOLOR:cc.LabelTTF._SHADER_PROGRAM=cc.SHADER_POSITION_TEXTUREA8COLOR;cc.LabelTTF.__labelHeightDiv=cc.newElement("div");cc.LabelTTF.__labelHeightDiv.style.fontFamily="Arial";cc.LabelTTF.__labelHeightDiv.style.position="absolute";cc.LabelTTF.__labelHeightDiv.style.left="-100px";
cc.LabelTTF.__labelHeightDiv.style.top="-100px";cc.LabelTTF.__labelHeightDiv.style.lineHeight="normal";document.body?document.body.appendChild(cc.LabelTTF.__labelHeightDiv):cc._addEventListener(window,"load",function(){this.removeEventListener("load",arguments.callee,!1);document.body.appendChild(cc.LabelTTF.__labelHeightDiv)},!1);
cc.LabelTTF.__getFontHeightByDiv=function(a,c){if(a instanceof cc.FontDefinition){var b=cc.LabelTTF.__fontHeightCache[a._getCanvasFontStr()];if(0<b)return b;var d=cc.LabelTTF.__labelHeightDiv;return d.innerHTML="ajghl~!",d.style.fontFamily=a.fontName,d.style.fontSize=a.fontSize+"px",d.style.fontStyle=a.fontStyle,d.style.fontWeight=a.fontWeight,b=d.clientHeight,cc.LabelTTF.__fontHeightCache[a._getCanvasFontStr()]=b,d.innerHTML="",b}b=cc.LabelTTF.__fontHeightCache[a+"."+c];if(0<b)return b;d=cc.LabelTTF.__labelHeightDiv;
return d.innerHTML="ajghl~!",d.style.fontFamily=a,d.style.fontSize=c+"px",b=d.clientHeight,cc.LabelTTF.__fontHeightCache[a+"."+c]=b,d.innerHTML="",b};cc.LabelTTF.__fontHeightCache={};cc.LabelTTF._textAlign=["left","center","right"];cc.LabelTTF._textBaseline=["top","middle","bottom"];cc.LabelTTF.wrapInspection=!0;cc.LabelTTF._wordRex=/([a-zA-Z0-9\u00c4\u00d6\u00dc\u00e4\u00f6\u00fc\u00df\u00e9\u00e8\u00e7\u00e0\u00f9\u00ea\u00e2\u00ee\u00f4\u00fb]+|\S)/;cc.LabelTTF._symbolRex=/^[!,.:;}\]%\?>\u3001\u2018\u201c\u300b\uff1f\u3002\uff0c\uff01]/;
cc.LabelTTF._lastWordRex=/([a-zA-Z0-9\u00c4\u00d6\u00dc\u00e4\u00f6\u00fc\u00df\u00e9\u00e8\u00e7\u00e0\u00f9\u00ea\u00e2\u00ee\u00f4\u00fb]+|\S)$/;cc.LabelTTF._lastEnglish=/[a-zA-Z0-9\u00c4\u00d6\u00dc\u00e4\u00f6\u00fc\u00df\u00e9\u00e8\u00e7\u00e0\u00f9\u00ea\u00e2\u00ee\u00f4\u00fb]+$/;cc.LabelTTF._firsrEnglish=/^[a-zA-Z0-9\u00c4\u00d6\u00dc\u00e4\u00f6\u00fc\u00df\u00e9\u00e8\u00e7\u00e0\u00f9\u00ea\u00e2\u00ee\u00f4\u00fb]/;
(function(){cc.LabelTTF.RenderCmd=function(){this._fontClientHeight=18;this._fontStyleStr="";this._shadowColorStr="rgba(128, 128, 128, 0.5)";this._strokeColorStr="";this._fillColorStr="rgba(255,255,255,1)";this._labelContext=this._labelCanvas=null;this._lineWidths=[];this._strings=[];this._isMultiLine=!1};var a=cc.LabelTTF.RenderCmd.prototype;a.constructor=cc.LabelTTF.RenderCmd;a._getLabelContext=function(){if(this._labelContext)return this._labelContext;var a=this._node;if(!this._labelCanvas){var b=
cc.newElement("canvas");b.width=1;b.height=1;var d=new cc.Texture2D;d.initWithElement(b);a.setTexture(d);this._labelCanvas=b}return this._labelContext=this._labelCanvas.getContext("2d"),this._labelContext};a._setFontStyle=function(a,b,d,e){a instanceof cc.FontDefinition?(this._fontStyleStr=a._getCanvasFontStr(),this._fontClientHeight=cc.LabelTTF.__getFontHeightByDiv(a)):(this._fontStyleStr=d+" "+e+" "+b+"px '"+a+"'",this._fontClientHeight=cc.LabelTTF.__getFontHeightByDiv(a,b))};a._getFontStyle=function(){return this._fontStyleStr};
a._getFontClientHeight=function(){return this._fontClientHeight};a._updateTexture=function(){this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.textDirty;var a=this._node,b=this._getLabelContext(),d=this._labelCanvas,e=a._contentSize;if(0===a._string.length)return d.width=1,d.height=e.height||1,a._texture&&a._texture.handleLoadedTexture(),a.setTextureRect(cc.rect(0,0,1,e.height)),!0;b.font=this._fontStyleStr;this._updateTTF();var f=e.width,e=e.height,g=d.width===f&&d.height===e;return d.width=f,
d.height=e,g&&b.clearRect(0,0,f,e),this._drawTTFInCanvas(b),a._texture&&a._texture.handleLoadedTexture(),a.setTextureRect(cc.rect(0,0,f,e)),!0};a._measureConfig=function(){this._getLabelContext().font=this._fontStyleStr};a._measure=function(a){return this._getLabelContext().measureText(a).width};a._updateTTF=function(){var a,b,d=this._node,e=d._dimensions.width,f=this._lineWidths;if(f.length=0,this._isMultiLine=!1,this._measureConfig(),0!==e)for(this._strings=d._string.split("\n"),a=0;a<this._strings.length;a++)this._checkWarp(this._strings,
a,e);else for(this._strings=d._string.split("\n"),a=0,b=this._strings.length;b>a;a++)f.push(this._measure(this._strings[a]));0<this._strings.length&&(this._isMultiLine=!0);b=a=0;if(d._strokeEnabled&&(a=b=2*d._strokeSize),d._shadowEnabled){var g=d._shadowOffset;a+=2*Math.abs(g.x);b+=2*Math.abs(g.y)}e=0===e?this._isMultiLine?cc.size(Math.ceil(Math.max.apply(Math,f)+a),Math.ceil(this._fontClientHeight*this._strings.length+b)):cc.size(Math.ceil(this._measure(d._string)+a),Math.ceil(this._fontClientHeight+
b)):0===d._dimensions.height?this._isMultiLine?cc.size(Math.ceil(e+a),Math.ceil(d.getLineHeight()*this._strings.length+b)):cc.size(Math.ceil(e+a),Math.ceil(d.getLineHeight()+b)):cc.size(Math.ceil(e+a),Math.ceil(d._dimensions.height+b));"normal"!==d._getFontStyle()&&(e.width=Math.ceil(e.width+.3*d._fontSize));d.setContentSize(e);d._strokeShadowOffsetX=a;d._strokeShadowOffsetY=b;d=d._anchorPoint;this._anchorPointInPoints.x=.5*a+(e.width-a)*d.x;this._anchorPointInPoints.y=.5*b+(e.height-b)*d.y};a._drawTTFInCanvas=
function(a){if(a){var b=this._node,d=b._strokeShadowOffsetX,e=b._strokeShadowOffsetY,f=b._contentSize.height-e,g=b._vAlignment,h=b._hAlignment,k=b._strokeSize;a.setTransform(1,0,0,1,.5*d,f+.5*e);a.font!==this._fontStyleStr&&(a.font=this._fontStyleStr);a.fillStyle=this._fillColorStr;var m=e=0,n=b._strokeEnabled;if(n&&(a.lineWidth=2*k,a.strokeStyle=this._strokeColorStr),b._shadowEnabled)k=b._shadowOffset,a.shadowColor=this._shadowColorStr,a.shadowOffsetX=k.x,a.shadowOffsetY=-k.y,a.shadowBlur=b._shadowBlur;
a.textBaseline=cc.LabelTTF._textBaseline[g];a.textAlign=cc.LabelTTF._textAlign[h];var p=b._contentSize.width-d,d=b.getLineHeight(),k=(d-this._fontClientHeight)/2;if(e+=h===cc.TEXT_ALIGNMENT_RIGHT?p:h===cc.TEXT_ALIGNMENT_CENTER?p/2:0,this._isMultiLine)for(b=this._strings.length,g===cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM?m=d-2*k+f-d*b:g===cc.VERTICAL_TEXT_ALIGNMENT_CENTER&&(m=(d-2*k)/2+(f-d*b)/2),g=0;b>g;g++)h=this._strings[g],p=-f+(d*g+k)+m,n&&a.strokeText(h,e,p),a.fillText(h,e,p);else g===cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM||
(m-=g===cc.VERTICAL_TEXT_ALIGNMENT_TOP?f:.5*f),n&&a.strokeText(b._string,e,m),a.fillText(b._string,e,m)}};a._checkWarp=function(a,b,d){var e=a[b],f=this._measure(e);if(f>d&&1<e.length){for(var g,h=d/f*e.length|0,k=e.substr(h),m=f-this._measure(k),n=0,p=0;m>d&&100>p++;)h*=d/m,h|=0,k=e.substr(h),m=f-this._measure(k);for(p=0;d>m&&100>p++;)k&&(n=(g=cc.LabelTTF._wordRex.exec(k))?g[0].length:1,g=k),h+=n,k=e.substr(h),m=f-this._measure(k);h-=n;0===h&&(h=1,g=g.substr(1));var q;d=e.substr(0,h);cc.LabelTTF.wrapInspection&&
cc.LabelTTF._symbolRex.test(g||k)&&(q=cc.LabelTTF._lastWordRex.exec(d),h-=q?q[0].length:0,g=e.substr(h),d=e.substr(0,h));cc.LabelTTF._firsrEnglish.test(g)&&(q=cc.LabelTTF._lastEnglish.exec(d),q&&d!==q[0]&&(h-=q[0].length,g=e.substr(h),d=e.substr(0,h)));a[b]=g||k;a.splice(b,0,d)}}})();
(function(){cc.LabelTTF.CanvasRenderCmd=function(a){cc.Sprite.CanvasRenderCmd.call(this,a);cc.LabelTTF.RenderCmd.call(this)};cc.LabelTTF.CanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype);cc.inject(cc.LabelTTF.RenderCmd.prototype,cc.LabelTTF.CanvasRenderCmd.prototype);var a=cc.LabelTTF.CanvasRenderCmd.prototype;a.constructor=cc.LabelTTF.CanvasRenderCmd;a.updateStatus=function(){var a=cc.Node._dirtyFlags,b=this._dirtyFlag,d=b&a.colorDirty,e=b&a.opacityDirty;d&&this._updateDisplayColor();
e&&this._updateDisplayOpacity();d?this._updateColor():b&a.textDirty&&this._updateTexture();this._dirtyFlag&a.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty)};a._syncStatus=function(a){var b=cc.Node._dirtyFlags,d=this._dirtyFlag,e=a?a._node:null;e&&e._cascadeColorEnabled&&a._dirtyFlag&b.colorDirty&&(d|=b.colorDirty);e&&e._cascadeOpacityEnabled&&a._dirtyFlag&b.opacityDirty&&(d|=b.opacityDirty);a&&a._dirtyFlag&b.transformDirty&&
(d|=b.transformDirty);var e=d&b.colorDirty,f=d&b.opacityDirty;this._dirtyFlag=d;e&&this._syncDisplayColor();f&&this._syncDisplayOpacity();e?this._updateColor():d&b.textDirty&&this._updateTexture();d&b.transformDirty&&this.transform(a)};a._setColorsString=function(){var a=this._displayedColor,b=this._node,d=b._shadowColor||this._displayedColor,e=b._strokeColor,f=b._textFillColor,g=a.r/255,h=a.g/255,a=a.b/255;this._shadowColorStr="rgba("+(0|g*d.r)+","+(0|h*d.g)+","+(0|a*d.b)+","+b._shadowOpacity+")";
this._fillColorStr="rgba("+(0|g*f.r)+","+(0|h*f.g)+","+(0|a*f.b)+", 1)";this._strokeColorStr="rgba("+(0|g*e.r)+","+(0|h*e.g)+","+(0|a*e.b)+", 1)"};a._updateColor=function(){this._setColorsString();this._updateTexture()}})();cc=cc||{};cc._tmp=cc._tmp||{};cc.associateWithNative=function(a,c){};
cc.KEY={none:0,back:6,menu:18,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,
"-":109,numdel:110,"/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,semicolon:186,equal:187,"=":187,",":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,backslash:220,"]":221,closebracket:221,quote:222,dpadLeft:1E3,dpadRight:1001,dpadUp:1003,dpadDown:1004,dpadCenter:1005};cc.FMT_JPG=0;cc.FMT_PNG=1;cc.FMT_TIFF=2;cc.FMT_RAWDATA=3;cc.FMT_WEBP=4;cc.FMT_UNKNOWN=5;
cc.getImageFormatByData=function(a){return 8<a.length&&137===a[0]&&80===a[1]&&78===a[2]&&71===a[3]&&13===a[4]&&10===a[5]&&26===a[6]&&10===a[7]?cc.FMT_PNG:2<a.length&&(73===a[0]&&73===a[1]||77===a[0]&&77===a[1]||255===a[0]&&216===a[1])?cc.FMT_TIFF:cc.FMT_UNKNOWN};cc.inherits=function(a,c){function b(){}b.prototype=c.prototype;a.superClass_=c.prototype;a.prototype=new b;a.prototype.constructor=a};
cc.base=function(a,c,b){var d=arguments.callee.caller;if(d.superClass_)return ret=d.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1)),ret;for(var e=Array.prototype.slice.call(arguments,2),f=!1,g=a.constructor;g;g=g.superClass_&&g.superClass_.constructor)if(g.prototype[c]===d)f=!0;else if(f)return g.prototype[c].apply(a,e);if(a[c]===d)return a.constructor.prototype[c].apply(a,e);throw Error("cc.base called from a method of one name to a method of a different name");};
cc.rendererCanvas={childrenOrderDirty:!0,_transformNodePool:[],_renderCmds:[],_isCacheToCanvasOn:!1,_cacheToCanvasCmds:{},_cacheInstanceIds:[],_currentID:0,getRenderCmd:function(a){return a._createRenderCmd()},rendering:function(a){var c,b=this._renderCmds,d=cc.view.getScaleX(),e=cc.view.getScaleY(),f=a||cc._renderContext;f.computeRealOffsetY();a=0;for(c=b.length;c>a;a++)b[a].rendering(f,d,e)},_renderingToCacheCanvas:function(a,c,b,d){a||cc.log("The context of RenderTexture is invalid.");b=cc.isUndefined(b)?
1:b;d=cc.isUndefined(d)?1:d;c=c||this._currentID;var e,f,g=this._cacheToCanvasCmds[c];a.computeRealOffsetY();e=0;for(f=g.length;f>e;e++)g[e].rendering(a,b,d);g.length=0;a=this._cacheInstanceIds;delete this._cacheToCanvasCmds[c];cc.arrayRemoveObject(a,c);0===a.length?this._isCacheToCanvasOn=!1:this._currentID=a[a.length-1]},_turnToCacheMode:function(a){this._isCacheToCanvasOn=!0;a=a||0;this._cacheToCanvasCmds[a]=[];-1===this._cacheInstanceIds.indexOf(a)&&this._cacheInstanceIds.push(a);this._currentID=
a},_turnToNormalMode:function(){this._isCacheToCanvasOn=!1},resetFlag:function(){this.childrenOrderDirty=!1;this._transformNodePool.length=0},transform:function(){var a=this._transformNodePool;a.sort(this._sortNodeByLevelAsc);for(var c=0,b=a.length;b>c;c++)0!==a[c]._dirtyFlag&&a[c].updateStatus();a.length=0},transformDirty:function(){return 0<this._transformNodePool.length},_sortNodeByLevelAsc:function(a,c){return a._curLevel-c._curLevel},pushDirtyNode:function(a){this._transformNodePool.push(a)},
clearRenderCommands:function(){this._renderCmds.length=0},pushRenderCommand:function(a){if(a._needDraw)if(this._isCacheToCanvasOn){var c=this._cacheToCanvasCmds[this._currentID];-1===c.indexOf(a)&&c.push(a)}else-1===this._renderCmds.indexOf(a)&&this._renderCmds.push(a)}};cc._renderType===cc._RENDER_TYPE_CANVAS&&(cc.renderer=cc.rendererCanvas);
(function(){cc.CanvasContextWrapper=function(a){this._context=a;this._saveCount=0;this._currentAlpha=a.globalAlpha;this._currentCompositeOperation=a.globalCompositeOperation;this._currentFillStyle=a.fillStyle;this._currentStrokeStyle=a.strokeStyle;this._offsetY=this._offsetX=0;this._realOffsetY=this.height;this._armatureMode=0};var a=cc.CanvasContextWrapper.prototype;a.resetCache=function(){var a=this._context;this._currentAlpha=a.globalAlpha;this._currentCompositeOperation=a.globalCompositeOperation;
this._currentFillStyle=a.fillStyle;this._currentStrokeStyle=a.strokeStyle;this._realOffsetY=this._context.canvas.height+this._offsetY};a.setOffset=function(a,b){this._offsetX=a;this._offsetY=b;this._realOffsetY=this._context.canvas.height+this._offsetY};a.computeRealOffsetY=function(){this._realOffsetY=this._context.canvas.height+this._offsetY};a.setViewScale=function(a,b){this._scaleX=a;this._scaleY=b};a.getContext=function(){return this._context};a.save=function(){this._context.save();this._saveCount++};
a.restore=function(){this._context.restore();this._saveCount--};a.setGlobalAlpha=function(a){0<this._saveCount?this._context.globalAlpha=a:this._currentAlpha!==a&&(this._currentAlpha=a,this._context.globalAlpha=a)};a.setCompositeOperation=function(a){0<this._saveCount?this._context.globalCompositeOperation=a:this._currentCompositeOperation!==a&&(this._currentCompositeOperation=a,this._context.globalCompositeOperation=a)};a.setFillStyle=function(a){0<this._saveCount?this._context.fillStyle=a:this._currentFillStyle!==
a&&(this._currentFillStyle=a,this._context.fillStyle=a)};a.setStrokeStyle=function(a){0<this._saveCount?this._context.strokeStyle=a:this._currentStrokeStyle!==a&&(this._currentStrokeStyle=a,this._context.strokeStyle=a)};a.setTransform=function(a,b,d){0<this._armatureMode?(this.restore(),this.save(),this._context.transform(a.a,-a.b,-a.c,a.d,a.tx*b,-(a.ty*d))):this._context.setTransform(a.a,-a.b,-a.c,a.d,this._offsetX+a.tx*b,this._realOffsetY-a.ty*d)};a._switchToArmatureMode=function(a,b,d,e){a?(this._armatureMode++,
this._context.setTransform(b.a,b.c,b.b,b.d,this._offsetX+b.tx*d,this._realOffsetY-b.ty*e),this.save()):(this._armatureMode--,this.restore())}})();_p=cc.inputManager;_p.setAccelerometerEnabled=function(a){this._accelEnabled!==a&&(this._accelEnabled=a,a=cc.director.getScheduler(),this._accelCurTime=0,a.scheduleUpdate(this))};_p.setAccelerometerInterval=function(a){this._accelInterval!==a&&(this._accelInterval=a)};
_p._registerKeyboardEvent=function(){cc._addEventListener(cc._canvas,"keydown",function(a){cc.eventManager.dispatchEvent(new cc.EventKeyboard(a.keyCode,!0));a.stopPropagation();a.preventDefault()},!1);cc._addEventListener(cc._canvas,"keyup",function(a){cc.eventManager.dispatchEvent(new cc.EventKeyboard(a.keyCode,!1));a.stopPropagation();a.preventDefault()},!1)};
_p._registerAccelerometerEvent=function(){var a=window;this._acceleration=new cc.Acceleration;this._accelDeviceEvent=a.DeviceMotionEvent||a.DeviceOrientationEvent;cc.sys.browserType===cc.sys.BROWSER_TYPE_MOBILE_QQ&&(this._accelDeviceEvent=window.DeviceOrientationEvent);var c=this._accelDeviceEvent===a.DeviceMotionEvent?"devicemotion":"deviceorientation",b=navigator.userAgent;(/Android/.test(b)||/Adr/.test(b)&&cc.sys.browserType===cc.BROWSER_TYPE_UC)&&(this._minus=-1);cc._addEventListener(a,c,this.didAccelerate.bind(this),
!1)};
_p.didAccelerate=function(a){var c=window;if(this._accelEnabled){var b,d,e,f=this._acceleration;this._accelDeviceEvent===window.DeviceMotionEvent?(e=a.accelerationIncludingGravity,b=this._accelMinus*e.x*.1,d=this._accelMinus*e.y*.1,e=.1*e.z):(b=a.gamma/90*.981,d=.981*-(a.beta/90),e=a.alpha/90*.981);cc.sys.os===cc.sys.OS_ANDROID?(f.x=-b,f.y=-d):(f.x=b,f.y=d);f.z=e;f.timestamp=a.timeStamp||Date.now();a=f.x;c.orientation===cc.UIInterfaceOrientationLandscapeRight?(f.x=-f.y,f.y=a):c.orientation===cc.UIInterfaceOrientationLandscapeLeft?
(f.x=f.y,f.y=-a):c.orientation===cc.UIInterfaceOrientationPortraitUpsideDown&&(f.x=-f.x,f.y=-f.y)}};delete _p;
cc.vertexLineToPolygon=function(a,c,b,d,e){if(e+=d,!(1>=e)){c*=.5;for(var f,g=e-1,h=d;e>h;h++){f=2*h;var k,m=cc.p(a[2*h],a[2*h+1]);if(0===h)k=cc.pPerp(cc.pNormalize(cc.pSub(m,cc.p(a[2*(h+1)],a[2*(h+1)+1]))));else if(h===g)k=cc.pPerp(cc.pNormalize(cc.pSub(cc.p(a[2*(h-1)],a[2*(h-1)+1]),m)));else{k=cc.p(a[2*(h-1)],a[2*(h-1)+1]);var n=cc.p(a[2*(h+1)],a[2*(h+1)+1]),p=cc.pNormalize(cc.pSub(n,m)),q=cc.pNormalize(cc.pSub(k,m)),r=Math.acos(cc.pDot(p,q));k=r<cc.degreesToRadians(70)?cc.pPerp(cc.pNormalize(cc.pMidpoint(p,
q))):r<cc.degreesToRadians(170)?cc.pNormalize(cc.pMidpoint(p,q)):cc.pPerp(cc.pNormalize(cc.pSub(n,k)))}k=cc.pMult(k,c);b[2*f]=m.x+k.x;b[2*f+1]=m.y+k.y;b[2*(f+1)]=m.x-k.x;b[2*(f+1)+1]=m.y-k.y}for(h=0===d?0:d-1;g>h;h++)f=2*h,a=f+2,c=cc.vertex2(b[2*f],b[2*f+1]),e=cc.vertex2(b[2*(f+1)],b[2*(f+1)+1]),f=cc.vertex2(b[2*a],b[2*a]),d=cc.vertex2(b[2*(a+1)],b[2*(a+1)+1]),c=!cc.vertexLineIntersect(c.x,c.y,d.x,d.y,e.x,e.y,f.x,f.y),c.isSuccess||(0>c.value||1<c.value)&&(c.isSuccess=!0),c.isSuccess&&(b[2*a]=d.x,
b[2*a+1]=d.y,b[2*(a+1)]=f.x,b[2*(a+1)+1]=f.y)}};cc.vertexLineIntersect=function(a,c,b,d,e,f,g,h){var k,m,n,p;return a===b&&c===d||e===g&&f===h||(b-=a,d-=c,e-=a,f-=c,g-=a,h-=c,k=Math.sqrt(b*b+d*d),m=b/k,n=d/k,p=e*m+f*n,f=f*m-e*n,e=p,p=g*m+h*n,h=h*m-g*n,g=p,f===h)?{isSuccess:!1,value:0}:{isSuccess:!0,value:(g+(e-g)*h/(h-f))/k}};cc.vertexListIsClockwise=function(a){for(var c=0,b=a.length;b>c;c++){var d=a[(c+1)%b],e=a[(c+2)%b];if(0<cc.pCross(cc.pSub(d,a[c]),cc.pSub(e,d)))return!1}return!0};
cc.CGAffineToGL=function(a,c){c[2]=c[3]=c[6]=c[7]=c[8]=c[9]=c[11]=c[14]=0;c[10]=c[15]=1;c[0]=a.a;c[4]=a.c;c[12]=a.tx;c[1]=a.b;c[5]=a.d;c[13]=a.ty};cc.GLToCGAffine=function(a,c){c.a=a[0];c.c=a[4];c.tx=a[12];c.b=a[1];c.d=a[5];c.ty=a[13]};cc.EventAcceleration=cc.Event.extend({_acc:null,ctor:function(a){cc.Event.prototype.ctor.call(this,cc.Event.ACCELERATION);this._acc=a}});
cc.EventKeyboard=cc.Event.extend({_keyCode:0,_isPressed:!1,ctor:function(a,c){cc.Event.prototype.ctor.call(this,cc.Event.KEYBOARD);this._keyCode=a;this._isPressed=c}});
cc._EventListenerAcceleration=cc.EventListener.extend({_onAccelerationEvent:null,ctor:function(a){this._onAccelerationEvent=a;var c=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.ACCELERATION,cc._EventListenerAcceleration.LISTENER_ID,function(a){c._onAccelerationEvent(a._acc,a)})},checkAvailable:function(){return cc.assert(this._onAccelerationEvent,cc._LogInfos._EventListenerAcceleration_checkAvailable),!0},clone:function(){return new cc._EventListenerAcceleration(this._onAccelerationEvent)}});
cc._EventListenerAcceleration.LISTENER_ID="__cc_acceleration";cc._EventListenerAcceleration.create=function(a){return new cc._EventListenerAcceleration(a)};
cc._EventListenerKeyboard=cc.EventListener.extend({onKeyPressed:null,onKeyReleased:null,ctor:function(){var a=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.KEYBOARD,cc._EventListenerKeyboard.LISTENER_ID,function(c){c._isPressed?a.onKeyPressed&&a.onKeyPressed(c._keyCode,c):a.onKeyReleased&&a.onKeyReleased(c._keyCode,c)})},clone:function(){var a=new cc._EventListenerKeyboard;return a.onKeyPressed=this.onKeyPressed,a.onKeyReleased=this.onKeyReleased,a},checkAvailable:function(){return null===
this.onKeyPressed&&null===this.onKeyReleased?(cc.log(cc._LogInfos._EventListenerKeyboard_checkAvailable),!1):!0}});cc._EventListenerKeyboard.LISTENER_ID="__cc_keyboard";cc._EventListenerKeyboard.create=function(){return new cc._EventListenerKeyboard};
cc.AtlasNode=cc.Node.extend({textureAtlas:null,quadsToDraw:0,_itemsPerRow:0,_itemsPerColumn:0,_itemWidth:0,_itemHeight:0,_opacityModifyRGB:!1,_blendFunc:null,_ignoreContentScaleFactor:!1,_className:"AtlasNode",_textureForCanvas:null,ctor:function(a,c,b,d){cc.Node.prototype.ctor.call(this);this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST};this._ignoreContentScaleFactor=!1;void 0!==d&&this.initWithTileFile(a,c,b,d)},_createRenderCmd:function(){cc._renderType===cc._RENDER_TYPE_CANVAS?this._renderCmd=
new cc.AtlasNode.CanvasRenderCmd(this):this._renderCmd=new cc.AtlasNode.WebGLRenderCmd(this)},updateAtlasValues:function(){cc.log(cc._LogInfos.AtlasNode_updateAtlasValues)},getColor:function(){return this._opacityModifyRGB?this._renderCmd._colorUnmodified:cc.Node.prototype.getColor.call(this)},setOpacityModifyRGB:function(a){var c=this.color;this._opacityModifyRGB=a;this.setColor(c)},isOpacityModifyRGB:function(){return this._opacityModifyRGB},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(a,
c){void 0===c?this._blendFunc=a:this._blendFunc={src:a,dst:c}},setTextureAtlas:function(a){this.textureAtlas=a},getTextureAtlas:function(){return this.textureAtlas},getQuadsToDraw:function(){return this.quadsToDraw},setQuadsToDraw:function(a){this.quadsToDraw=a},initWithTileFile:function(a,c,b,d){if(!a)throw"cc.AtlasNode.initWithTileFile(): title should not be null";a=cc.textureCache.addImage(a);return this.initWithTexture(a,c,b,d)},initWithTexture:function(a,c,b,d){return this._renderCmd.initWithTexture(a,
c,b,d)},setColor:function(a){this._renderCmd.setColor(a)},setOpacity:function(a){this._renderCmd.setOpacity(a)},getTexture:function(){return this._renderCmd.getTexture()},setTexture:function(a){this._renderCmd.setTexture(a)},_setIgnoreContentScaleFactor:function(a){this._ignoreContentScaleFactor=a}});_p=cc.AtlasNode.prototype;cc.defineGetterSetter(_p,"opacity",_p.getOpacity,_p.setOpacity);cc.defineGetterSetter(_p,"color",_p.getColor,_p.setColor);_p.texture;
cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture);_p.textureAtlas;_p.quadsToDraw;cc.EventHelper.prototype.apply(_p);cc.AtlasNode.create=function(a,c,b,d){return new cc.AtlasNode(a,c,b,d)};
(function(){cc.AtlasNode.CanvasRenderCmd=function(a){cc.Node.CanvasRenderCmd.call(this,a);this._needDraw=!1;this._colorUnmodified=cc.color.WHITE;this._texture=this._originalTexture=null};var a=cc.AtlasNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);a.constructor=cc.AtlasNode.CanvasRenderCmd;a.initWithTexture=function(a,b,d,e){var f=this._node;return f._itemWidth=b,f._itemHeight=d,f._opacityModifyRGB=!0,this._originalTexture=a,this._originalTexture?(this._texture=this._originalTexture,
this._calculateMaxItems(),f.quadsToDraw=e,!0):(cc.log(cc._LogInfos.AtlasNode__initWithTexture),!1)};a.setColor=function(a){var b=this._node._realColor;b.r===a.r&&b.g===a.g&&b.b===a.b||(this._colorUnmodified=a,this._changeTextureColor())};cc.sys._supportCanvasNewBlendModes?a._changeTextureColor=function(){var a=this._node,b=a.getTexture();if(b&&this._originalTexture){var d=this._originalTexture.getHtmlElementObj();if(d){var e=b.getHtmlElementObj(),f=cc.rect(0,0,d.width,d.height);e instanceof HTMLCanvasElement?
cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(d,this._colorUnmodified,f,e):(e=cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(d,this._colorUnmodified,f),b=new cc.Texture2D,b.initWithElement(e),b.handleLoadedTexture(),a.setTexture(b))}}}:a._changeTextureColor=function(){var a,b=this._node,d=b.getTexture();if(d&&this._originalTexture&&(a=d.getHtmlElementObj(),a)){var e=this._originalTexture.getHtmlElementObj(),f=cc.textureCache.getTextureColors(e);f&&(e=cc.rect(0,0,e.width,e.height),
a instanceof HTMLCanvasElement?cc.Sprite.CanvasRenderCmd._generateTintImage(a,f,this._displayedColor,e,a):(a=cc.Sprite.CanvasRenderCmd._generateTintImage(a,f,this._displayedColor,e),d=new cc.Texture2D,d.initWithElement(a),d.handleLoadedTexture(),b.setTexture(d)))}};a.setOpacity=function(a){cc.Node.prototype.setOpacity.call(this._node,a)};a.getTexture=function(){return this._texture};a.setTexture=function(a){this._texture=a};a._calculateMaxItems=function(){var a=this._node,b=this._texture.getContentSize();
a._itemsPerColumn=0|b.height/a._itemHeight;a._itemsPerRow=0|b.width/a._itemWidth}})();
cc.TextureAtlas=cc.Class.extend({dirty:!1,texture:null,_indices:null,_buffersVBO:null,_capacity:0,_quads:null,_quadsArrayBuffer:null,_quadsWebBuffer:null,_quadsReader:null,ctor:function(a,c){this._buffersVBO=[];cc.isString(a)?this.initWithFile(a,c):a instanceof cc.Texture2D&&this.initWithTexture(a,c)},getTotalQuads:function(){return this._totalQuads},getCapacity:function(){return this._capacity},getTexture:function(){return this.texture},setTexture:function(a){this.texture=a},setDirty:function(a){this.dirty=
a},isDirty:function(){return this.dirty},getQuads:function(){return this._quads},setQuads:function(a){this._quads=a},_copyQuadsToTextureAtlas:function(a,c){if(a)for(var b=0;b<a.length;b++)this._setQuadToArray(a[b],c+b)},_setQuadToArray:function(a,c){var b=this._quads;return b[c]?(b[c].bl=a.bl,b[c].br=a.br,b[c].tl=a.tl,void(b[c].tr=a.tr)):void(b[c]=new cc.V3F_C4B_T2F_Quad(a.tl,a.bl,a.tr,a.br,this._quadsArrayBuffer,c*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT))},description:function(){return"<cc.TextureAtlas | totalQuads ="+
this._totalQuads+">"},_setupIndices:function(){if(0!==this._capacity)for(var a=this._indices,c=this._capacity,b=0;c>b;b++)cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP?(a[6*b+0]=4*b+0,a[6*b+1]=4*b+0,a[6*b+2]=4*b+2,a[6*b+3]=4*b+1,a[6*b+4]=4*b+3,a[6*b+5]=4*b+3):(a[6*b+0]=4*b+0,a[6*b+1]=4*b+1,a[6*b+2]=4*b+2,a[6*b+3]=4*b+3,a[6*b+4]=4*b+2,a[6*b+5]=4*b+1)},_setupVBO:function(){var a=cc._renderContext;this._buffersVBO[0]=a.createBuffer();this._buffersVBO[1]=a.createBuffer();this._quadsWebBuffer=a.createBuffer();this._mapBuffers()},
_mapBuffers:function(){var a=cc._renderContext;a.bindBuffer(a.ARRAY_BUFFER,this._quadsWebBuffer);a.bufferData(a.ARRAY_BUFFER,this._quadsArrayBuffer,a.DYNAMIC_DRAW);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]);a.bufferData(a.ELEMENT_ARRAY_BUFFER,this._indices,a.STATIC_DRAW)},initWithFile:function(a,c){var b=cc.textureCache.addImage(a);return b?this.initWithTexture(b,c):(cc.log(cc._LogInfos.TextureAtlas_initWithFile,a),!1)},initWithTexture:function(a,c){cc.assert(a,cc._LogInfos.TextureAtlas_initWithTexture);
this._capacity=c|=0;this._totalQuads=0;this.texture=a;this._quads=[];this._indices=new Uint16Array(6*c);var b=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._quadsArrayBuffer=new ArrayBuffer(b*c),this._quadsReader=new Uint8Array(this._quadsArrayBuffer),(!this._quads||!this._indices)&&0<c)return!1;for(var d=this._quads,e=0;c>e;e++)d[e]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,e*b);return this._setupIndices(),this._setupVBO(),this.dirty=!0,!0},updateQuad:function(a,c){cc.assert(a,
cc._LogInfos.TextureAtlas_updateQuad);cc.assert(0<=c&&c<this._capacity,cc._LogInfos.TextureAtlas_updateQuad_2);this._totalQuads=Math.max(c+1,this._totalQuads);this._setQuadToArray(a,c);this.dirty=!0},insertQuad:function(a,c){if(cc.assert(c<this._capacity,cc._LogInfos.TextureAtlas_insertQuad_2),this._totalQuads++,this._totalQuads>this._capacity)return void cc.log(cc._LogInfos.TextureAtlas_insertQuad);var b=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,d=c*b,e=(this._totalQuads-1-c)*b;this._quads[this._totalQuads-
1]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*b);this._quadsReader.set(this._quadsReader.subarray(d,d+e),d+b);this._setQuadToArray(a,c);this.dirty=!0},insertQuads:function(a,c,b){b=b||a.length;cc.assert(c+b<=this._capacity,cc._LogInfos.TextureAtlas_insertQuads);var d=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._totalQuads+=b,this._totalQuads>this._capacity)return void cc.log(cc._LogInfos.TextureAtlas_insertQuad);var e,f=c*d,g=(this._totalQuads-1-c-b)*
d,h=this._totalQuads-1-b;for(e=0;b>e;e++)this._quads[h+e]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*d);this._quadsReader.set(this._quadsReader.subarray(f,f+g),f+d*b);for(e=0;b>e;e++)this._setQuadToArray(a[e],c+e);this.dirty=!0},insertQuadFromIndex:function(a,c){if(a!==c){cc.assert(0<=c||c<this._totalQuads,cc._LogInfos.TextureAtlas_insertQuadFromIndex);cc.assert(0<=a||a<this._totalQuads,cc._LogInfos.TextureAtlas_insertQuadFromIndex_2);var b,d,e=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,
f=this._quadsReader,g=f.subarray(a*e,e);a>c?(b=c*e,d=(a-c)*e,f.set(f.subarray(b,b+d),b+e),f.set(g,b)):(b=(a+1)*e,d=(c-a)*e,f.set(f.subarray(b,b+d),b-e),f.set(g,c*e));this.dirty=!0}},removeQuadAtIndex:function(a){cc.assert(a<this._totalQuads,cc._LogInfos.TextureAtlas_removeQuadAtIndex);var c=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._totalQuads--,this._quads.length=this._totalQuads,a!==this._totalQuads){var b=(a+1)*c;this._quadsReader.set(this._quadsReader.subarray(b,b+(this._totalQuads-a)*c),
b-c)}this.dirty=!0},removeQuadsAtIndex:function(a,c){if(cc.assert(a+c<=this._totalQuads,cc._LogInfos.TextureAtlas_removeQuadsAtIndex),this._totalQuads-=c,a!==this._totalQuads){var b=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,d=(a+c)*b,e=a*b;this._quadsReader.set(this._quadsReader.subarray(d,d+(this._totalQuads-a)*b),e)}this.dirty=!0},removeAllQuads:function(){this._totalQuads=this._quads.length=0},_setDirty:function(a){this.dirty=a},resizeCapacity:function(a){if(a===this._capacity)return!0;var c=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,
b=this._capacity;this._totalQuads=Math.min(this._totalQuads,a);var d=this._capacity=0|a,e=this._totalQuads;if(null===this._quads)for(this._quads=[],this._quadsArrayBuffer=new ArrayBuffer(c*d),this._quadsReader=new Uint8Array(this._quadsArrayBuffer),a=0;d>a;a++)this._quads=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,a*c);else{var f,g,h=this._quads;if(d>b){f=[];g=new ArrayBuffer(c*d);for(a=0;e>a;a++)f[a]=new cc.V3F_C4B_T2F_Quad(h[a].tl,h[a].bl,h[a].tr,h[a].br,g,a*c);for(;d>a;a++)f[a]=
new cc.V3F_C4B_T2F_Quad(null,null,null,null,g,a*c)}else for(e=Math.max(e,d),f=[],g=new ArrayBuffer(c*d),a=0;e>a;a++)f[a]=new cc.V3F_C4B_T2F_Quad(h[a].tl,h[a].bl,h[a].tr,h[a].br,g,a*c);this._quadsReader=new Uint8Array(g);this._quads=f;this._quadsArrayBuffer=g}null===this._indices?this._indices=new Uint16Array(6*d):d>b?(c=new Uint16Array(6*d),c.set(this._indices,0),this._indices=c):this._indices=this._indices.subarray(0,6*d);return this._setupIndices(),this._mapBuffers(),this.dirty=!0,!0},increaseTotalQuadsWith:function(a){this._totalQuads+=
a},moveQuadsFromIndex:function(a,c,b){if(void 0===b){if(b=c,c=this._totalQuads-a,cc.assert(b+(this._totalQuads-a)<=this._capacity,cc._LogInfos.TextureAtlas_moveQuadsFromIndex),0===c)return}else if(cc.assert(b+c<=this._totalQuads,cc._LogInfos.TextureAtlas_moveQuadsFromIndex_2),cc.assert(a<this._totalQuads,cc._LogInfos.TextureAtlas_moveQuadsFromIndex_3),a===b)return;var d,e,f=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,g=a*f,h=c*f,k=this._quadsReader,m=k.subarray(g,g+h),n=b*f;a>b?(d=(a-b)*f,e=b*f,k.set(k.subarray(e,
e+d),e+h)):(d=(b-a)*f,e=(a+c)*f,k.set(k.subarray(e,e+d),g));k.set(m,n);this.dirty=!0},fillWithEmptyQuadsFromIndex:function(a,c){for(var b=c*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,d=new Uint8Array(this._quadsArrayBuffer,a*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,b),e=0;b>e;e++)d[e]=0},drawQuads:function(){this.drawNumberOfQuads(this._totalQuads,0)},_releaseBuffer:function(){var a=cc._renderContext;this._buffersVBO&&(this._buffersVBO[0]&&a.deleteBuffer(this._buffersVBO[0]),this._buffersVBO[1]&&a.deleteBuffer(this._buffersVBO[1]));
this._quadsWebBuffer&&a.deleteBuffer(this._quadsWebBuffer)}});_p=cc.TextureAtlas.prototype;_p.totalQuads;cc.defineGetterSetter(_p,"totalQuads",_p.getTotalQuads);_p.capacity;cc.defineGetterSetter(_p,"capacity",_p.getCapacity);_p.quads;cc.defineGetterSetter(_p,"quads",_p.getQuads,_p.setQuads);cc.TextureAtlas.create=function(a,c){return new cc.TextureAtlas(a,c)};cc.TextureAtlas.createWithTexture=cc.TextureAtlas.create;
cc._renderType===cc._RENDER_TYPE_WEBGL&&(cc.assert(cc.isFunction(cc._tmp.WebGLTextureAtlas),cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTextureAtlas(),delete cc._tmp.WebGLTextureAtlas);cc.assert(cc.isFunction(cc._tmp.PrototypeTextureAtlas),cc._LogInfos.MissingFile,"TexturesPropertyDefine.js");cc._tmp.PrototypeTextureAtlas();delete cc._tmp.PrototypeTextureAtlas;
cc.Camera=cc.Class.extend({_eyeX:null,_eyeY:null,_eyeZ:null,_centerX:null,_centerY:null,_centerZ:null,_upX:null,_upY:null,_upZ:null,_dirty:!1,_lookupMatrix:null,ctor:function(){this._lookupMatrix=new cc.math.Matrix4;this.restore()},description:function(){return"<CCCamera | center =("+this._centerX+","+this._centerY+","+this._centerZ+")>"},setDirty:function(a){this._dirty=a},isDirty:function(){return this._dirty},restore:function(){this._eyeX=this._eyeY=0;this._eyeZ=cc.Camera.getZEye();this._upX=this._centerX=
this._centerY=this._centerZ=0;this._upY=1;this._upZ=0;this._lookupMatrix.identity();this._dirty=!1},locate:function(){if(this._dirty){var a=new cc.math.Vec3(this._eyeX,this._eyeY,this._eyeZ),c=new cc.math.Vec3(this._centerX,this._centerY,this._centerZ),b=new cc.math.Vec3(this._upX,this._upY,this._upZ);this._lookupMatrix.lookAt(a,c,b);this._dirty=!1}cc.kmGLMultMatrix(this._lookupMatrix)},_locateForRenderer:function(a){if(this._dirty){var c=new cc.math.Vec3(this._eyeX,this._eyeY,this._eyeZ),b=new cc.math.Vec3(this._centerX,
this._centerY,this._centerZ),d=new cc.math.Vec3(this._upX,this._upY,this._upZ);this._lookupMatrix.lookAt(c,b,d);this._dirty=!1}a.multiply(this._lookupMatrix)},setEyeXYZ:function(a,c,b){this.setEye(a,c,b)},setEye:function(a,c,b){this._eyeX=a;this._eyeY=c;this._eyeZ=b;this._dirty=!0},setCenterXYZ:function(a,c,b){this.setCenter(a,c,b)},setCenter:function(a,c,b){this._centerX=a;this._centerY=c;this._centerZ=b;this._dirty=!0},setUpXYZ:function(a,c,b){this.setUp(a,c,b)},setUp:function(a,c,b){this._upX=
a;this._upY=c;this._upZ=b;this._dirty=!0},getEyeXYZ:function(a,c,b){return{x:this._eyeX,y:this._eyeY,z:this._eyeZ}},getEye:function(){return{x:this._eyeX,y:this._eyeY,z:this._eyeZ}},getCenterXYZ:function(a,c,b){return{x:this._centerX,y:this._centerY,z:this._centerZ}},getCenter:function(){return{x:this._centerX,y:this._centerY,z:this._centerZ}},getUpXYZ:function(a,c,b){return{x:this._upX,y:this._upY,z:this._upZ}},getUp:function(){return{x:this._upX,y:this._upY,z:this._upZ}},_DISALLOW_COPY_AND_ASSIGN:function(a){}});
cc.Camera.getZEye=function(){return cc.FLT_EPSILON};cc.PI2=2*Math.PI;
cc.DrawingPrimitiveCanvas=cc.Class.extend({_cacheArray:[],_renderContext:null,ctor:function(a){this._renderContext=a},drawPoint:function(a,c){c||(c=1);var b=cc.view.getScaleX(),d=cc.view.getScaleY(),d=cc.p(a.x*b,a.y*d),e=this._renderContext.getContext();e.beginPath();e.arc(d.x,-d.y,c*b,0,2*Math.PI,!1);e.closePath();e.fill()},drawPoints:function(a,c,b){if(null!=a){b||(b=1);c=this._renderContext.getContext();var d=cc.view.getScaleX(),e=cc.view.getScaleY();c.beginPath();for(var f=0,g=a.length;g>f;f++)c.arc(a[f].x*
d,-a[f].y*e,b*d,0,2*Math.PI,!1);c.closePath();c.fill()}},drawLine:function(a,c){var b=this._renderContext.getContext(),d=cc.view.getScaleX(),e=cc.view.getScaleY();b.beginPath();b.moveTo(a.x*d,-a.y*e);b.lineTo(c.x*d,-c.y*e);b.closePath();b.stroke()},drawRect:function(a,c){this.drawLine(cc.p(a.x,a.y),cc.p(c.x,a.y));this.drawLine(cc.p(c.x,a.y),cc.p(c.x,c.y));this.drawLine(cc.p(c.x,c.y),cc.p(a.x,c.y));this.drawLine(cc.p(a.x,c.y),cc.p(a.x,a.y))},drawSolidRect:function(a,c,b){a=[a,cc.p(c.x,a.y),c,cc.p(a.x,
c.y)];this.drawSolidPoly(a,4,b)},drawPoly:function(a,c,b,d){if(d=d||!1,null!=a){if(3>a.length)throw Error("Polygon's point must greater than 2");var e=a[0];c=this._renderContext.getContext();var f=cc.view.getScaleX(),g=cc.view.getScaleY();c.beginPath();c.moveTo(e.x*f,-e.y*g);for(var e=1,h=a.length;h>e;e++)c.lineTo(a[e].x*f,-a[e].y*g);b&&c.closePath();d?c.fill():c.stroke()}},drawSolidPoly:function(a,c,b){this.setDrawColor(b.r,b.g,b.b,b.a);this.drawPoly(a,c,!0,!0)},drawCircle:function(a,c,b,d,e){e=
e||!1;d=this._renderContext.getContext();var f=cc.view.getScaleX(),g=cc.view.getScaleY();d.beginPath();d.arc(0|a.x*f,0|-(a.y*g),c*f,-b,-(b-2*Math.PI),!1);e&&d.lineTo(0|a.x*f,0|-(a.y*g));d.stroke()},drawQuadBezier:function(a,c,b,d){for(var e=this._cacheArray,f=e.length=0,g=0;d>g;g++){var h=Math.pow(1-f,2)*a.x+2*(1-f)*f*c.x+f*f*b.x,k=Math.pow(1-f,2)*a.y+2*(1-f)*f*c.y+f*f*b.y;e.push(cc.p(h,k));f+=1/d}e.push(cc.p(b.x,b.y));this.drawPoly(e,d+1,!1,!1)},drawCubicBezier:function(a,c,b,d,e){for(var f=this._cacheArray,
g=f.length=0,h=0;e>h;h++){var k=Math.pow(1-g,3)*a.x+3*Math.pow(1-g,2)*g*c.x+3*(1-g)*g*g*b.x+g*g*g*d.x,m=Math.pow(1-g,3)*a.y+3*Math.pow(1-g,2)*g*c.y+3*(1-g)*g*g*b.y+g*g*g*d.y;f.push(cc.p(k,m));g+=1/e}f.push(cc.p(d.x,d.y));this.drawPoly(f,e+1,!1,!1)},drawCatmullRom:function(a,c){this.drawCardinalSpline(a,.5,c)},drawCardinalSpline:function(a,c,b){cc._renderContext.setStrokeStyle("rgba(255,255,255,1)");var d=this._cacheArray;d.length=0;for(var e,f,g=1/a.length,h=0;b+1>h;h++){var k=h/b;1===k?(e=a.length-
1,f=1):(e=0|k/g,f=(k-g*e)/g);k=cc.CardinalSplineAt(cc.getControlPointAt(a,e-1),cc.getControlPointAt(a,e-0),cc.getControlPointAt(a,e+1),cc.getControlPointAt(a,e+2),c,f);d.push(k)}this.drawPoly(d,b+1,!1,!1)},drawImage:function(a,c,b,d,e){var f=arguments.length,g=this._renderContext.getContext();switch(f){case 2:g.drawImage(a,c.x,-(c.y+a.height));break;case 3:g.drawImage(a,c.x,-(c.y+b.height),b.width,b.height);break;case 5:g.drawImage(a,c.x,c.y,b.width,b.height,d.x,-(d.y+e.height),e.width,e.height);
break;default:throw Error("Argument must be non-nil");}},drawStar:function(a,c,b){a=a||this._renderContext;var d=a.getContext();c*=cc.view.getScaleX();b="rgba("+(0|b.r)+","+(0|b.g)+","+(0|b.b);a.setFillStyle(b+",1)");var e=c/10;d.beginPath();d.moveTo(-c,c);d.lineTo(0,e);d.lineTo(c,c);d.lineTo(e,0);d.lineTo(c,-c);d.lineTo(0,-e);d.lineTo(-c,-c);d.lineTo(-e,0);d.lineTo(-c,c);d.closePath();d.fill();var f=d.createRadialGradient(0,0,e,0,0,c);f.addColorStop(0,b+", 1)");f.addColorStop(.3,b+", 0.8)");f.addColorStop(1,
b+", 0.0)");a.setFillStyle(f);d.beginPath();d.arc(0,0,c-e,0,cc.PI2,!1);d.closePath();d.fill()},drawColorBall:function(a,c,b){a=a||this._renderContext;var d=a.getContext();c*=cc.view.getScaleX();b="rgba("+(0|b.r)+","+(0|b.g)+","+(0|b.b);var e=d.createRadialGradient(0,0,c/10,0,0,c);e.addColorStop(0,b+", 1)");e.addColorStop(.3,b+", 0.8)");e.addColorStop(.6,b+", 0.4)");e.addColorStop(1,b+", 0.0)");a.setFillStyle(e);d.beginPath();d.arc(0,0,c,0,cc.PI2,!1);d.closePath();d.fill()},fillText:function(a,c,b){this._renderContext.getContext().fillText(a,
c,-b)},setDrawColor:function(a,c,b,d){this._renderContext.setFillStyle("rgba("+a+","+c+","+b+","+d/255+")");this._renderContext.setStrokeStyle("rgba("+a+","+c+","+b+","+d/255+")")},setPointSize:function(a){},setLineWidth:function(a){this._renderContext.getContext().lineWidth=a*cc.view.getScaleX()}});cc.IMAGE_FORMAT_JPEG=0;cc.IMAGE_FORMAT_PNG=1;cc.IMAGE_FORMAT_RAWDATA=9;cc.NextPOT=function(a){return--a,a|=a>>1,a|=a>>2,a|=a>>4,a|=a>>8,a|=a>>16,a+1};
cc.RenderTexture=cc.Node.extend({sprite:null,clearFlags:0,clearDepthVal:0,autoDraw:!1,_texture:null,_pixelFormat:cc.Texture2D.PIXEL_FORMAT_RGBA8888,clearStencilVal:0,_clearColor:null,_className:"RenderTexture",ctor:function(a,c,b,d){cc.Node.prototype.ctor.call(this);this._cascadeOpacityEnabled=this._cascadeColorEnabled=!0;this._clearColor=new cc.Color(0,0,0,255);void 0!==a&&void 0!==c&&(b=b||cc.Texture2D.PIXEL_FORMAT_RGBA8888,d=d||0,this.initWithWidthAndHeight(a,c,b,d));this.setAnchorPoint(0,0)},
_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.RenderTexture.CanvasRenderCmd(this):new cc.RenderTexture.WebGLRenderCmd(this)},cleanup:function(){cc.Node.prototype.onExit.call(this);this._renderCmd.cleanup()},getSprite:function(){return this.sprite},setSprite:function(a){this.sprite=a},setVirtualViewport:function(a,c,b){this._renderCmd.setVirtualViewport(a,c,b)},initWithWidthAndHeight:function(a,c,b,d){return this._renderCmd.initWithWidthAndHeight(a,c,b,d)},begin:function(){cc.renderer._turnToCacheMode(this.__instanceId);
this._renderCmd.begin()},beginWithClear:function(a,c,b,d,e,f){var g=cc._renderContext;e=e||g.COLOR_BUFFER_BIT;f=f||g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT;this._beginWithClear(a,c,b,d,e,f,g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT|g.STENCIL_BUFFER_BIT)},_beginWithClear:function(a,c,b,d,e,f,g){this.begin();this._renderCmd._beginWithClear(a,c,b,d,e,f,g)},end:function(){this._renderCmd.end()},clear:function(a,c,b,d){this.beginWithClear(a,c,b,d);this.end()},clearRect:function(a,c,b,d){this._renderCmd.clearRect(a,
c,b,d)},clearDepth:function(a){this._renderCmd.clearDepth(a)},clearStencil:function(a){this._renderCmd.clearStencil(a)},getClearFlags:function(){return this.clearFlags},setClearFlags:function(a){this.clearFlags=a},getClearColor:function(){return this._clearColor},setClearColor:function(a){var c=this._clearColor;c.r=a.r;c.g=a.g;c.b=a.b;c.a=a.a;this._renderCmd.updateClearColor(a)},getClearDepth:function(){return this.clearDepthVal},setClearDepth:function(a){this.clearDepthVal=a},getClearStencil:function(){return this.clearStencilVal},
setClearStencil:function(a){this.clearStencilVal=a},isAutoDraw:function(){return this.autoDraw},setAutoDraw:function(a){this.autoDraw=a},saveToFile:function(a,c){cc.log("saveToFile isn't supported on Cocos2d-Html5")},newCCImage:function(a){return cc.log("saveToFile isn't supported on cocos2d-html5"),null},listenToBackground:function(a){},listenToForeground:function(a){}});_p=cc.RenderTexture.prototype;_p.clearColorVal;cc.defineGetterSetter(_p,"clearColorVal",_p.getClearColor,_p.setClearColor);
cc.RenderTexture.create=function(a,c,b,d){return new cc.RenderTexture(a,c,b,d)};
(function(){cc.RenderTexture.CanvasRenderCmd=function(a){cc.Node.CanvasRenderCmd.call(this,a);this._needDraw=!0;this._clearColorStr="rgba(255,255,255,1)";this._cacheCanvas=cc.newElement("canvas");this._cacheContext=new cc.CanvasContextWrapper(this._cacheCanvas.getContext("2d"))};var a=cc.RenderTexture.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);a.constructor=cc.RenderTexture.CanvasRenderCmd;a.cleanup=function(){this._cacheCanvas=this._cacheContext=null};a.clearStencil=
function(a){};a.setVirtualViewport=function(a,b,d){};a.updateClearColor=function(a){this._clearColorStr="rgba("+(0|a.r)+","+(0|a.g)+","+(0|a.b)+","+a.a/255+")"};a.initWithWidthAndHeight=function(a,b,d,e){d=this._node;e=this._cacheCanvas;var f=cc.contentScaleFactor();e.width=0|a*f;e.height=0|b*f;a=new cc.Texture2D;a.initWithElement(e);a.handleLoadedTexture();a=d.sprite=new cc.Sprite(a);return a.setBlendFunc(cc.ONE,cc.ONE_MINUS_SRC_ALPHA),d.autoDraw=!1,d.addChild(a),!0};a.begin=function(){};a._beginWithClear=
function(a,b,d,e,f,g,h){a=a||0;b=b||0;d=d||0;e=isNaN(e)?255:e;f=this._cacheContext.getContext();g=this._cacheCanvas;f.setTransform(1,0,0,1,0,0);this._cacheContext.setFillStyle("rgba("+(0|a)+","+(0|b)+","+(0|d)+","+e/255+")");f.clearRect(0,0,g.width,g.height);f.fillRect(0,0,g.width,g.height)};a.end=function(){var a=this._node,b=cc.contentScaleFactor();cc.renderer._renderingToCacheCanvas(this._cacheContext,a.__instanceId,b,b)};a.clearRect=function(a,b,d,e){this._cacheContext.clearRect(a,b,d,-e)};a.clearDepth=
function(a){cc.log("clearDepth isn't supported on Cocos2d-Html5")};a.visit=function(a){var b=this._node;this._syncStatus(a);b.sprite.visit(this);this._dirtyFlag=0}})();
cc.SpriteBatchNode=cc.Node.extend({_blendFunc:null,_descendants:null,_className:"SpriteBatchNode",ctor:function(a,c){cc.Node.prototype.ctor.call(this);this._descendants=[];this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST);var b;c=c||cc.SpriteBatchNode.DEFAULT_CAPACITY;cc.isString(a)?(b=cc.textureCache.getTextureForKey(a),b||(b=cc.textureCache.addImage(a))):a instanceof cc.Texture2D&&(b=a);b&&this.initWithTexture(b,c)},addSpriteWithoutQuad:function(a,c,b){if(cc.assert(a,cc._LogInfos.SpriteBatchNode_addSpriteWithoutQuad_2),
!(a instanceof cc.Sprite))return cc.log(cc._LogInfos.SpriteBatchNode_addSpriteWithoutQuad),null;a.atlasIndex=c;var d,e=0,f=this._descendants;if(f&&0<f.length)for(e=0,d=f.length;d>e;e++){var g=f[e];if(g&&g.atlasIndex>=c)break}return f.splice(e,0,a),cc.Node.prototype.addChild.call(this,a,c,b),this.reorderBatch(!1),this},getTextureAtlas:function(){return this._renderCmd.getTextureAtlas()},setTextureAtlas:function(a){this._renderCmd.getTextureAtlas(a)},getDescendants:function(){return this._descendants},
initWithFile:function(a,c){var b=cc.textureCache.getTextureForKey(a);return b||(b=cc.textureCache.addImage(a)),this.initWithTexture(b,c)},_setNodeDirtyForCache:function(){this._renderCmd&&this._renderCmd._setNodeDirtyForCache&&this._renderCmd._setNodeDirtyForCache()},init:function(a,c){var b=cc.textureCache.getTextureForKey(a);return b||(b=cc.textureCache.addImage(a)),this.initWithTexture(b,c)},increaseAtlasCapacity:function(){this._renderCmd.increaseAtlasCapacity()},removeChildAtIndex:function(a,
c){this.removeChild(this._children[a],c)},rebuildIndexInOrder:function(a,c){var b=a.children;if(b&&0<b.length)for(var d=0;d<b.length;d++){var e=b[d];e&&0>e.zIndex&&(c=this.rebuildIndexInOrder(e,c))}if(!a===this&&(a.atlasIndex=c,c++),b&&0<b.length)for(d=0;d<b.length;d++)(e=b[d])&&0<=e.zIndex&&(c=this.rebuildIndexInOrder(e,c));return c},highestAtlasIndexInChild:function(a){var c=a.children;return c&&0!==c.length?this.highestAtlasIndexInChild(c[c.length-1]):a.atlasIndex},lowestAtlasIndexInChild:function(a){var c=
a.children;return c&&0!==c.length?this.lowestAtlasIndexInChild(c[c.length-1]):a.atlasIndex},atlasIndexForChild:function(a,c){var b=a.parent,d=b.children,e=d.indexOf(a),f=null;return 0<e&&e<cc.UINT_MAX&&(f=d[e-1]),b===this?0===e?0:this.highestAtlasIndexInChild(f)+1:0===e?0>c?b.atlasIndex:b.atlasIndex+1:0>f.zIndex&&0>c||0<=f.zIndex&&0<=c?this.highestAtlasIndexInChild(f)+1:b.atlasIndex+1},reorderBatch:function(a){this._reorderChildDirty=a},setBlendFunc:function(a,c){void 0===c?this._blendFunc=a:this._blendFunc=
{src:a,dst:c}},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},reorderChild:function(a,c){return cc.assert(a,cc._LogInfos.SpriteBatchNode_reorderChild_2),-1===this._children.indexOf(a)?void cc.log(cc._LogInfos.SpriteBatchNode_reorderChild):void(c!==a.zIndex&&cc.Node.prototype.reorderChild.call(this,a,c))},removeChild:function(a,c){if(null!=a){if(-1===this._children.indexOf(a))return void cc.log(cc._LogInfos.SpriteBatchNode_removeChild);this.removeSpriteFromAtlas(a);
cc.Node.prototype.removeChild.call(this,a,c)}},updateQuadFromSprite:function(a,c){return cc.assert(a,cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite_2),a instanceof cc.Sprite?(this._renderCmd.checkAtlasCapacity(),a.batchNode=this,a.atlasIndex=c,a.dirty=!0,void a.updateTransform()):void cc.log(cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite)},insertQuadFromSprite:function(a,c){return cc.assert(a,cc._LogInfos.CCSpriteBatchNode_insertQuadFromSprite_2),a instanceof cc.Sprite?(this._renderCmd.insertQuad(a,
c),a.batchNode=this,a.atlasIndex=c,a.dirty=!0,a.updateTransform(),void this._renderCmd.cutting(a,c)):void cc.log(cc._LogInfos.CCSpriteBatchNode_insertQuadFromSprite)},initWithTexture:function(a,c){return this._children.length=0,this._descendants.length=0,c=c||cc.SpriteBatchNode.DEFAULT_CAPACITY,this._renderCmd.initWithTexture(a,c),!0},insertChild:function(a,c){a.batchNode=this;a.atlasIndex=c;a.dirty=!0;this._renderCmd.insertQuad(a,c);this._descendants.splice(c,0,a);var b=c+1,d=this._descendants;if(d&&
0<d.length)for(;b<d.length;b++)d[b].atlasIndex++;var e,f=a.children;if(f)for(b=0,e=f.length||0;e>b;b++)if(d=f[b]){var g=this.atlasIndexForChild(d,d.zIndex);this.insertChild(d,g)}},appendChild:function(a){this._reorderChildDirty=!0;a.batchNode=this;a.dirty=!0;this._descendants.push(a);var c=this._descendants.length-1;a.atlasIndex=c;this._renderCmd.insertQuad(a,c);a=a.children;for(var c=0,b=a.length||0;b>c;c++)this.appendChild(a[c])},removeSpriteFromAtlas:function(a){this._renderCmd.removeQuadAtIndex(a.atlasIndex);
a.batchNode=null;var c=this._descendants,b=c.indexOf(a);if(-1!==b){c.splice(b,1);for(var d=c.length;d>b;++b)c[b].atlasIndex--}if(a=a.children)for(c=0,b=a.length||0;b>c;c++)a[c]&&this.removeSpriteFromAtlas(a[c])},getTexture:function(){return this._renderCmd.getTexture()},setTexture:function(a){this._renderCmd.setTexture(a)},addChild:function(a,c,b){cc.assert(null!=a,cc._LogInfos.CCSpriteBatchNode_addChild_3);this._renderCmd.isValidChild(a)&&(c=null==c?a.zIndex:c,b=null==b?a.tag:b,cc.Node.prototype.addChild.call(this,
a,c,b),this.appendChild(a))},removeAllChildren:function(a){var c=this._descendants;if(c&&0<c.length)for(var b=0,d=c.length;d>b;b++)c[b]&&(c[b].batchNode=null);cc.Node.prototype.removeAllChildren.call(this,a);this._descendants.length=0;this._renderCmd.removeAllQuads()},sortAllChildren:function(){if(this._reorderChildDirty){var a,c,b=this._children,d=0,e=b.length;for(a=1;e>a;a++){var f=b[a],d=a-1;for(c=b[d];0<=d&&(f._localZOrder<c._localZOrder||f._localZOrder===c._localZOrder&&f.arrivalOrder<c.arrivalOrder);)b[d+
1]=c,--d,c=b[d];b[d+1]=f}0<b.length&&(this._arrayMakeObjectsPerformSelector(b,cc.Node._stateCallbackType.sortAllChildren),this._renderCmd.updateChildrenAtlasIndex(b));this._reorderChildDirty=!1}},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.SpriteBatchNode.CanvasRenderCmd(this):new cc.SpriteBatchNode.WebGLRenderCmd(this)}});_p=cc.SpriteBatchNode.prototype;cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture);
cc.defineGetterSetter(_p,"textureAtlas",_p.getTextureAtlas,_p.setTextureAtlas);_p.descendants;cc.defineGetterSetter(_p,"descendants",_p.getDescendants);cc.SpriteBatchNode.DEFAULT_CAPACITY=29;cc.SpriteBatchNode.create=function(a,c){return new cc.SpriteBatchNode(a,c)};cc.SpriteBatchNode.createWithTexture=cc.SpriteBatchNode.create;
(function(){cc.SpriteBatchNode.CanvasRenderCmd=function(a){cc.Node.CanvasRenderCmd.call(this,a);this._originalTexture=this._texture=null};var a=cc.SpriteBatchNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);a.constructor=cc.SpriteBatchNode.CanvasRenderCmd;a.checkAtlasCapacity=function(){};a.isValidChild=function(a){return a instanceof cc.Sprite?!0:(cc.log(cc._LogInfos.Sprite_addChild_4),!1)};a.initWithTexture=function(a,b){this._texture=this._originalTexture=a};a.insertQuad=
function(a,b){};a.increaseAtlasCapacity=function(){};a.removeQuadAtIndex=function(){};a.removeAllQuads=function(){};a.getTexture=function(){return this._texture};a.setTexture=function(a){this._texture=a;for(var b=this._node._children,d=0;d<b.length;d++)b[d].setTexture(a)};a.updateChildrenAtlasIndex=function(a){for(var b=this._node._descendants.length=0,d=a.length;d>b;b++)this._updateAtlasIndex(a[b])};a._updateAtlasIndex=function(a){var b,d=this._node._descendants,e=a.children,f=e.length;for(b=0;f>
b&&0>e[b]._localZOrder;b++)d.push(e[b]);for(d.push(a);f>b;b++)d.push(e[b])};a.getTextureAtlas=function(){};a.setTextureAtlas=function(a){};a.cutting=function(a,b){this._node._children.splice(b,0,a)}})();
cc.LabelAtlas=cc.AtlasNode.extend({_string:null,_mapStartChar:null,_textureLoaded:!1,_className:"LabelAtlas",ctor:function(a,c,b,d,e){cc.AtlasNode.prototype.ctor.call(this);this._renderCmd.setCascade();c&&cc.LabelAtlas.prototype.initWithString.call(this,a,c,b,d,e)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_WEBGL?new cc.LabelAtlas.WebGLRenderCmd(this):new cc.LabelAtlas.CanvasRenderCmd(this)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(a,
c){this.addEventListener("load",a,c)},initWithString:function(a,c,b,d,e){var f,g,h=a+"";if(void 0===b){b=cc.loader.getRes(c);if(1!==parseInt(b.version,10))return cc.log("cc.LabelAtlas.initWithString(): Unsupported version. Upgrade cocos2d version"),!1;c=cc.path.changeBasename(c,b.textureFilename);d=cc.contentScaleFactor();f=parseInt(b.itemWidth,10)/d;g=parseInt(b.itemHeight,10)/d;b=String.fromCharCode(parseInt(b.firstChar,10))}else f=b||0,g=d||0,b=e||" ";var k=null,k=c instanceof cc.Texture2D?c:cc.textureCache.addImage(c);
c=k.isLoaded();return this._textureLoaded=c,c||(this._string=h,k.addEventListener("load",function(a){this.initWithTexture(k,f,g,h.length);this.string=this._string;this.setColor(this._renderCmd._displayedColor);this.dispatchEvent("load")},this)),this.initWithTexture(k,f,g,h.length)?(this._mapStartChar=b,this.string=h,!0):!1},setColor:function(a){cc.AtlasNode.prototype.setColor.call(this,a);this._renderCmd.updateAtlasValues()},getString:function(){return this._string},addChild:function(a,c,b){this._renderCmd._addChild(a);
cc.Node.prototype.addChild.call(this,a,c,b)},updateAtlasValues:function(){this._renderCmd.updateAtlasValues()},setString:function(a){a=String(a);var c=a.length;this._string=a;this.setContentSize(c*this._itemWidth,this._itemHeight);this._renderCmd.setString(a);this._renderCmd.updateAtlasValues();this.quadsToDraw=c}});
(function(){var a=cc.LabelAtlas.prototype;cc.defineGetterSetter(a,"opacity",a.getOpacity,a.setOpacity);cc.defineGetterSetter(a,"color",a.getColor,a.setColor);a.string;cc.defineGetterSetter(a,"string",a.getString,a.setString)})();cc.LabelAtlas.create=function(a,c,b,d,e){return new cc.LabelAtlas(a,c,b,d,e)};
(function(){cc.LabelAtlas.CanvasRenderCmd=function(a){cc.AtlasNode.CanvasRenderCmd.call(this,a);this._needDraw=!1};var a=cc.LabelAtlas.CanvasRenderCmd.prototype=Object.create(cc.AtlasNode.CanvasRenderCmd.prototype);a.constructor=cc.LabelAtlas.CanvasRenderCmd;a.setCascade=function(){var a=this._node;a._cascadeOpacityEnabled=!0;a._cascadeColorEnabled=!1};a.updateAtlasValues=function(){for(var a=this._node,b=a._string||"",d=b.length,e=this._texture,f=a._itemWidth,g=a._itemHeight,h=0;d>h;h++){var k=b.charCodeAt(h)-
a._mapStartChar.charCodeAt(0),m=parseInt(k%a._itemsPerRow,10),k=parseInt(k/a._itemsPerRow,10),m=cc.rect(m*f,k*g,f,g),k=b.charCodeAt(h),n=a.getChildByTag(h);n?32===k?(n.init(),n.setTextureRect(cc.rect(0,0,10,10),!1,cc.size(0,0))):(n.initWithTexture(e,m),n.visible=!0):(n=new cc.Sprite,32===k?(n.init(),n.setTextureRect(cc.rect(0,0,10,10),!1,cc.size(0,0))):n.initWithTexture(e,m),cc.Node.prototype.addChild.call(a,n,0,h));n.setPosition(h*f+f/2,g/2)}};a.setString=function(a){a=this._node;if(a._children){a=
a._children;for(var b=a.length,d=0;b>d;d++){var e=a[d];e&&!e._lateChild&&(e.visible=!1)}}};a._addChild=function(){child._lateChild=!0}})();cc.LABEL_AUTOMATIC_WIDTH=-1;
cc.LabelBMFont=cc.SpriteBatchNode.extend({_opacityModifyRGB:!1,_string:"",_config:null,_fntFile:"",_initialString:"",_alignment:cc.TEXT_ALIGNMENT_CENTER,_width:-1,_lineBreakWithoutSpaces:!1,_imageOffset:null,_reusedChar:null,_textureLoaded:!1,_className:"LabelBMFont",_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_WEBGL?new cc.LabelBMFont.WebGLRenderCmd(this):new cc.LabelBMFont.CanvasRenderCmd(this)},_setString:function(a,c){c?this._initialString=a:this._string=a;var b=this._children;
if(b)for(var d=0;d<b.length;d++){var e=b[d];e&&e.setVisible(!1)}this._textureLoaded&&(this.createFontChars(),c&&this.updateLabel())},ctor:function(a,c,b,d,e){cc.SpriteBatchNode.prototype.ctor.call(this);this._imageOffset=cc.p(0,0);this._reusedChar=[];this._cascadeOpacityEnabled=this._cascadeColorEnabled=!0;this.initWithString(a,c,b,d,e)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(a,c){this.addEventListener("load",a,c)},isOpacityModifyRGB:function(){return this._opacityModifyRGB},
setOpacityModifyRGB:function(a){this._opacityModifyRGB=a;if(a=this._children)for(var c=0;c<a.length;c++){var b=a[c];b&&(b.opacityModifyRGB=this._opacityModifyRGB)}},_changeTextureColor:function(){this._renderCmd._changeTextureColor()},init:function(){return this.initWithString(null,null,null,null,null)},initWithString:function(a,c,b,d,e){a=a||"";this._renderCmd;this._config&&cc.log("cc.LabelBMFont.initWithString(): re-init is no longer supported");if(c){var f=cc.loader.getRes(c);if(!f)return cc.log("cc.LabelBMFont.initWithString(): Impossible to create font. Please check file"),
!1;this._config=f;this._fntFile=c;c=cc.textureCache.addImage(f.atlasName);(this._textureLoaded=f=c.isLoaded())||c.addEventListener("load",function(a){this._textureLoaded=!0;this.initWithTexture(a,this._initialString.length);this.setString(this._initialString,!0);this.dispatchEvent("load")},this)}else c=new cc.Texture2D,f=new Image,c.initWithElement(f),this._textureLoaded=!1;return this.initWithTexture(c,a.length)?(this._alignment=d||cc.TEXT_ALIGNMENT_LEFT,this._imageOffset=e||cc.p(0,0),this._width=
null==b?-1:b,this._realOpacity=255,this._realColor=cc.color(255,255,255,255),this._contentSize.width=0,this._contentSize.height=0,this.setAnchorPoint(.5,.5),this._renderCmd._initBatchTexture(),this.setString(a,!0),!0):!1},createFontChars:function(){var a=this._renderCmd._texture||this.textureAtlas.texture,c=0,b=cc.size(0,0),d=0,e=1,f=this._string,g=f?f.length:0;if(0!==g){var h,k=this._config,m=k.kerningDict,n=k.commonHeight,p=k.fontDefDictionary;for(h=0;g-1>h;h++)10===f.charCodeAt(h)&&e++;var q=n*
e,e=-(n-n*e),r=-1;for(h=0;g>h;h++)if(n=f.charCodeAt(h),0!==n)if(10!==n){var u=m[r<<16|65535&n]||0,t=p[n];if(t){var v=cc.rect(t.rect.x,t.rect.y,t.rect.width,t.rect.height),v=cc.rectPixelsToPoints(v);v.x+=this._imageOffset.x;v.y+=this._imageOffset.y;(r=this.getChildByTag(h))?this._renderCmd._updateCharTexture(r,v,n):(r=new cc.Sprite,r.initWithTexture(a,v,!1),r._newTextureWhenChangeColor=!0,this.addChild(r,0,h));r.opacityModifyRGB=this._opacityModifyRGB;this._renderCmd._updateCharColorAndOpacity(r);
v=cc.p(c+t.xOffset+.5*t.rect.width+u,e+(k.commonHeight-t.yOffset)-.5*v.height*cc.contentScaleFactor());r.setPosition(cc.pointPixelsToPoints(v));c+=t.xAdvance+u;r=n;c>d&&(d=c)}else cc.log("cocos2d: LabelBMFont: character not found "+f[h])}else c=0,e-=k.commonHeight;t&&t.xAdvance<t.rect.width?b.width=d-t.xAdvance+t.rect.width:b.width=d;b.height=q;this.setContentSize(cc.sizePixelsToPoints(b))}},updateString:function(a){var c=this._children;if(c)for(var b=0,d=c.length;d>b;b++){var e=c[b];e&&(e.visible=
!1)}this._config&&this.createFontChars();a||this.updateLabel()},getString:function(){return this._initialString},setString:function(a,c){a=String(a);null==c&&(c=!0);null!=a&&cc.isString(a)||(a+="");this._initialString=a;this._setString(a,c)},_setStringForSetter:function(a){this.setString(a,!1)},setCString:function(a){this.setString(a,!0)},_getCharsWidth:function(a,c){if(0>=c)return 0;var b=this.getChildByTag(a),d=this.getChildByTag(a+c);return this._getLetterPosXLeft(d)-this._getLetterPosXLeft(b)},
_checkWarp:function(a,c,b,d){for(var e=a[c],f=0,g=0;c>g;g++)f+=a[g].length;var f=f+c-d,h=this._getCharsWidth(f,a[c].length-1);if(h>b&&1<e.length){var k;d=b/h*e.length|0;for(var g=e.substr(d),m=h-this._getCharsWidth(f+d,g.length-1),n=0,p=0;m>b&&100>p++;)d*=b/m,d|=0,g=e.substr(d),m=h-this._getCharsWidth(f+d,g.length-1);for(p=0;b>m&&100>p++;)g&&(n=(k=cc.LabelTTF._wordRex.exec(g))?k[0].length:1,k=g),this._lineBreakWithoutSpaces&&(n=0),d+=n,g=e.substr(d),m=h-this._getCharsWidth(f+d,g.length-1);d-=n;0===
d&&(d=1,k=k.substr(1));var q;b=e.substr(0,d);cc.LabelTTF.wrapInspection&&cc.LabelTTF._symbolRex.test(k||g)&&(q=cc.LabelTTF._lastWordRex.exec(b),n=q?q[0].length:0,this._lineBreakWithoutSpaces&&(n=0),d-=n,k=e.substr(d),b=e.substr(0,d));cc.LabelTTF._firsrEnglish.test(k)&&(q=cc.LabelTTF._lastEnglish.exec(b),q&&b!==q[0]&&(n=q[0].length,this._lineBreakWithoutSpaces&&(n=0),d-=n,k=e.substr(d),b=e.substr(0,d)));a[c]=k||g;a.splice(c,0,b)}},updateLabel:function(){this.string=this._initialString;var a,c,b;if(0<
this._width){var d=this.string.split("\n"),e="",f=0,g=0;for(a=0;a<d.length;a++)g=d.length,this._checkWarp(d,a,this._width*this._scaleX,f),g<d.length&&f++,0<a&&(e+="\n"),e+=d[a];e+=String.fromCharCode(0);this._setString(e,!1)}if(this._alignment!==cc.TEXT_ALIGNMENT_LEFT)for(d=a=0,e=this._string.length,f=[],g=0;e>g;g++)if(10!==this._string[g].charCodeAt(0)&&0!==this._string[g].charCodeAt(0))f.push(this._string[a]);else{c=0;var h=f.length;if(0===h)d++;else{var k=a+h-1+d;if(!(0>k)){var m=this.getChildByTag(k);
if(null!=m){c=m.getPositionX()+m._getWidth()/2;m=0;switch(this._alignment){case cc.TEXT_ALIGNMENT_CENTER:m=this.width/2-c/2;break;case cc.TEXT_ALIGNMENT_RIGHT:m=this.width-c}if(0!==m)for(c=0;h>c;c++)k=a+c+d,0>k||(b=this.getChildByTag(k),b&&(b.x+=m));a+=h;d++;f.length=0}}}}},setAlignment:function(a){this._alignment=a;this.updateLabel()},_getAlignment:function(){return this._alignment},setBoundingWidth:function(a){this._width=a;this.updateLabel()},_getBoundingWidth:function(){return this._width},setLineBreakWithoutSpace:function(a){this._lineBreakWithoutSpaces=
a;this.updateLabel()},setScale:function(a,c){cc.Node.prototype.setScale.call(this,a,c);this.updateLabel()},setScaleX:function(a){cc.Node.prototype.setScaleX.call(this,a);this.updateLabel()},setScaleY:function(a){cc.Node.prototype.setScaleY.call(this,a);this.updateLabel()},setFntFile:function(a){if(null!=a&&a!==this._fntFile){var c=cc.loader.getRes(a);if(!c)return void cc.log("cc.LabelBMFont.setFntFile() : Impossible to create font. Please check file");this._fntFile=a;this._config=c;a=cc.textureCache.addImage(c.atlasName);
this._textureLoaded=c=a.isLoaded();this.texture=a;this._renderCmd._updateFntFileTexture();c?this.createFontChars():a.addEventListener("load",function(a){this._textureLoaded=!0;this.texture=a;this.createFontChars();this._changeTextureColor();this.updateLabel();this.dispatchEvent("load")},this)}},getFntFile:function(){return this._fntFile},setTexture:function(a){this._renderCmd.setTexture(a)},setAnchorPoint:function(a,c){cc.Node.prototype.setAnchorPoint.call(this,a,c);this.updateLabel()},_setAnchorX:function(a){cc.Node.prototype._setAnchorX.call(this,
a);this.updateLabel()},_setAnchorY:function(a){cc.Node.prototype._setAnchorY.call(this,a);this.updateLabel()},_atlasNameFromFntFile:function(a){},_kerningAmountForFirst:function(a,c){var b=0;if(this._configuration.kerningDictionary){var d=this._configuration.kerningDictionary[(a<<16|65535&c).toString()];d&&(b=d.amount)}return b},_getLetterPosXLeft:function(a){return a.getPositionX()*this._scaleX-a._getWidth()*this._scaleX*a._getAnchorX()},_getLetterPosXRight:function(a){return a.getPositionX()*this._scaleX+
a._getWidth()*this._scaleX*a._getAnchorX()},_isspace_unicode:function(a){return a=a.charCodeAt(0),9<=a&&13>=a||32===a||133===a||160===a||5760===a||8192<=a&&8202>=a||8232===a||8233===a||8239===a||8287===a||12288===a},_utf8_trim_ws:function(a){var c=a.length;if(!(0>=c)&&(--c,this._isspace_unicode(a[c]))){for(var b=c-1;0<=b&&this._isspace_unicode(a[b]);--b)c=b;this._utf8_trim_from(a,c)}},_utf8_trim_from:function(a,c){var b=a.length;c>=b||0>c||a.splice(c,b)}});
(function(){var a=cc.LabelBMFont.prototype;cc.EventHelper.prototype.apply(a);a.string;cc.defineGetterSetter(a,"string",a.getString,a._setStringForSetter);a.boundingWidth;cc.defineGetterSetter(a,"boundingWidth",a._getBoundingWidth,a.setBoundingWidth);a.textAlign;cc.defineGetterSetter(a,"textAlign",a._getAlignment,a.setAlignment)})();cc.LabelBMFont.create=function(a,c,b,d,e){return new cc.LabelBMFont(a,c,b,d,e)};
cc._fntLoader={INFO_EXP:/info [^\n]*(\n|$)/gi,COMMON_EXP:/common [^\n]*(\n|$)/gi,PAGE_EXP:/page [^\n]*(\n|$)/gi,CHAR_EXP:/char [^\n]*(\n|$)/gi,KERNING_EXP:/kerning [^\n]*(\n|$)/gi,ITEM_EXP:/\w+=[^ \r\n]+/gi,INT_EXP:/^[\-]?\d+$/,_parseStrToObj:function(a){a=a.match(this.ITEM_EXP);var c={};if(a)for(var b=0,d=a.length;d>b;b++){var e=a[b],f=e.indexOf("="),g=e.substring(0,f),e=e.substring(f+1);e.match(this.INT_EXP)?e=parseInt(e):'"'===e[0]&&(e=e.substring(1,e.length-1));c[g]=e}return c},parseFnt:function(a,
c){var b={},d=this._parseStrToObj(a.match(this.INFO_EXP)[0]).padding.split(","),d=(parseInt(d[0]),parseInt(d[1]),parseInt(d[2]),parseInt(d[3]),this._parseStrToObj(a.match(this.COMMON_EXP)[0]));if(b.commonHeight=d.lineHeight,cc._renderType===cc._RENDER_TYPE_WEBGL){var e=cc.configuration.getMaxTextureSize();(d.scaleW>e.width||d.scaleH>e.height)&&cc.log("cc.LabelBMFont._parseCommonArguments(): page can't be larger than supported")}1!==d.pages&&cc.log("cc.LabelBMFont._parseCommonArguments(): only supports 1 page");
d=this._parseStrToObj(a.match(this.PAGE_EXP)[0]);0!==d.id&&cc.log("cc.LabelBMFont._parseImageFileName() : file could not be found");b.atlasName=cc.path.changeBasename(c,d.file);for(var f=a.match(this.CHAR_EXP),g=b.fontDefDictionary={},d=0,e=f.length;e>d;d++){var h=this._parseStrToObj(f[d]);g[h.id]={rect:{x:h.x,y:h.y,width:h.width,height:h.height},xOffset:h.xoffset,yOffset:h.yoffset,xAdvance:h.xadvance}}f=b.kerningDict={};if(g=a.match(this.KERNING_EXP))for(d=0,e=g.length;e>d;d++)h=this._parseStrToObj(g[d]),
f[h.first<<16|65535&h.second]=h.amount;return b},load:function(a,c,b,d){var e=this;cc.loader.loadTxt(a,function(a,b){return a?d(a):void d(null,e.parseFnt(b,c))})}};cc.loader.register(["fnt"],cc._fntLoader);
(function(){cc.LabelBMFont.CanvasRenderCmd=function(a){cc.SpriteBatchNode.CanvasRenderCmd.call(this,a);this._needDraw=!0};var a=cc.LabelBMFont.CanvasRenderCmd.prototype=Object.create(cc.SpriteBatchNode.CanvasRenderCmd.prototype);a.constructor=cc.LabelBMFont.CanvasRenderCmd;a.rendering=function(){};a._updateCharTexture=function(a,b,d){32===d?a.setTextureRect(b,!1,cc.size(0,0)):(a.setTextureRect(b,!1),a.visible=!0)};a._updateCharColorAndOpacity=function(a){a._displayedColor=this._displayedColor;a._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty);
a._displayedOpacity=this._displayedOpacity;a._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)};a._updateFntFileTexture=function(){var a=this._node;a._originalTexture=a.texture};a.setTexture=function(a){for(var b=this._node._children,d=this._displayedColor,e=0;e<b.length;e++){var f=b[e],g=f._renderCmd,h=g._displayedColor;(this._texture===g._texture||h.r===d.r&&h.g===d.g&&h.b===d.b)&&(f.texture=a)}this._texture=a};cc.sys._supportCanvasNewBlendModes?a._changeTextureColor=function(){var a=this._node,
b=a.getTexture();if(b&&0<b.getContentSize().width){var d=this._originalTexture.getHtmlElementObj();if(d){var e=b.getHtmlElementObj(),f=cc.rect(0,0,d.width,d.height);e instanceof HTMLCanvasElement&&!a._rectRotated?(cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(d,this._displayedColor,f,e),a.setTexture(b)):(e=cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(d,this._displayedColor,f),b=new cc.Texture2D,b.initWithElement(e),b.handleLoadedTexture(),a.setTexture(b))}}}:a._changeTextureColor=
function(){var a,b=this._node,d=b.getTexture();if(d&&0<d.getContentSize().width&&(a=d.getHtmlElementObj(),a)){var e=cc.textureCache.getTextureColors(this._originalTexture.getHtmlElementObj());e&&(a instanceof HTMLCanvasElement&&!this._rectRotated?(cc.Sprite.CanvasRenderCmd._generateTintImage(a,e,this._displayedColor,null,a),this.setTexture(d)):(a=cc.Sprite.CanvasRenderCmd._generateTintImage(a,e,this._displayedColor),d=new cc.Texture2D,d.initWithElement(a),d.handleLoadedTexture(),b.setTexture(d)))}};
a._updateChildrenDisplayedOpacity=function(a){cc.Node.prototype.updateDisplayedOpacity.call(a,this._displayedOpacity)};a._updateChildrenDisplayedColor=function(a){cc.Node.prototype.updateDisplayedColor.call(a,this._displayedColor)};a._initBatchTexture=function(){}})();var PrototypeGame=function(){var a="img/background.png img/block1.png img/block2.png img/block3.png img/block4.png img/block0.png".split(" "),c=1,b=function(){var a=this;this.rotation=0;this.blocks=[{x:0,y:1,blockTypeId:Math.floor(5*Math.random())},{x:1,y:1,blockTypeId:Math.floor(5*Math.random())},{x:0,y:0,blockTypeId:-1},{x:1,y:0,blockTypeId:-1}];this.createPlayerBlockSprite=function(a,b){var c=cc.Sprite.create("img/block"+a+".png");c.setAnchorPoint(new cc.Point(0,0));c.x=b%2*32;c.y=1>=b?32:0;return c};
this.rotate=function(){0==a.rotation?(a.rotation=1,a.blocks[3].blockTypeId=a.blocks[1].blockTypeId,a.blocks[1].blockTypeId=a.blocks[0].blockTypeId,a.blocks[0].blockTypeId=-1,a.blocks[2].blockTypeId=-1):1==a.rotation?(a.rotation=2,a.blocks[0].blockTypeId=a.blocks[3].blockTypeId,a.blocks[2].blockTypeId=-1,a.blocks[3].blockTypeId=-1):2==a.rotation?(a.rotation=3,a.blocks[3].blockTypeId=a.blocks[1].blockTypeId,a.blocks[1].blockTypeId=a.blocks[0].blockTypeId,a.blocks[0].blockTypeId=-1,a.blocks[2].blockTypeId=
-1):(a.rotation=0,a.blocks[0].blockTypeId=a.blocks[3].blockTypeId,a.blocks[2].blockTypeId=-1,a.blocks[3].blockTypeId=-1)};this.undoRotation=function(){for(var b=0;3>b;b++)a.rotate()}},d=function(){var a=this;this.elapsedSinceLastUpdate=0;this.structure=new b;this.node=new cc.Node;this.node.setAnchorPoint(new cc.Point(0,-1));this.node.setPosition(32*Math.floor(7),576);this.nodeChanged=!0;this.reachedFinalPosition=!1;this.hasCollision=function(b){var c=!1;0>a.node.y&&0!=a.structure.rotation&&2!=a.structure.rotation&&
(c=!0);-64>a.node.y&&(c=!0);if(c)return!0;for(c=0;4>c;c++){var d=a.structure.blocks[c];if(-1<d.blockTypeId){var e=a.getPositionInGrid().x+d.x,d=a.getPositionInGrid().y+d.y;if(b.hasBlockAt(e,d))return!0}}return!1};this.positionWithinBoundaries=function(){0>a.node.x&&1!=a.structure.rotation&&3!=a.structure.rotation&&(a.node.x=0);-32>a.node.x&&(a.node.x=-32);384<a.node.x&&(a.node.x=384)};this.moveBy=function(b,c,d){a.node.x+=32*b;a.node.y+=32*c;a.positionWithinBoundaries();a.hasCollision(d.grid)&&(a.node.x+=
0-32*b,a.node.y+=0-32*c,0>c&&(a.reachedFinalPosition=!0))};this.getPositionInGrid=function(){return{x:a.node.x/32,y:a.node.y/32}};this.rotate=function(b){a.structure.rotate();a.hasCollision(b.grid)?a.structure.undoRotation():(a.nodeChanged=!0,a.positionWithinBoundaries())};this.update=function(b,d){if(a.nodeChanged){a.nodeChanged=!1;a.node.removeAllChildren();for(var e=0;4>e;e++){var f=a.structure.blocks[e].blockTypeId;-1<f&&(f=a.structure.createPlayerBlockSprite(f,e),a.node.addChild(f))}}(a.elapsedSinceLastUpdate+=
b)>=.5*c&&(a.moveBy(0,-1,d),a.elapsedSinceLastUpdate=0)}},e=cc.Scene.extend({blockLayer:{},hudLayer:{},player:{},grid:new function(){this.state=[];for(var a=0;280>a;a++)this.state.push(null);var b=this;this.addPlayerBlocks=function(a){for(var c=0;4>c;c++){var d=a.structure.blocks[c];if(-1<d.blockTypeId){var e=a.getPositionInGrid().x+d.x,f=a.getPositionInGrid().y+d.y,e=b.coordsToIndex(e,f);b.state[e]=d.blockTypeId}}};this.indexToCoords=function(a){return{x:a%14,y:Math.floor(a/14)}};this.coordsToIndex=
function(a,b){return 14*b+a};this.hasBlockAt=function(a,c){return null!==b.state[b.coordsToIndex(a,c)]};this.createBlockSprite=function(a,b,c){c=cc.Sprite.create("img/block"+c+".png");c.setAnchorPoint(new cc.Point(0,0));c.x=a;c.y=b;return c};this.dropFlyingBlocks=function(){var a;for(a=0;a<b.state.length;a++)if(null!==b.state[a]){var c=b.indexToCoords(a);19>c.y&&!b.hasBlockAt(c.x,c.y-1)&&(c=b.coordsToIndex(c.x,c.y-1),b.state[c]=b.state[a],b.state[a]=null,a=c-1)}};this.removeConnectingBlocks=function(){for(var a=
0,c=function(a,d,e){for(var f=b.indexToCoords(a),f=[{x:f.x,y:f.y-1},{x:f.x,y:f.y+1},{x:f.x-1,y:f.y},{x:f.x+1,y:f.y}],g=0;g<f.length;g++){var k=f[g],n=b.coordsToIndex(k.x,k.y);!(0>k.x||13<k.x||0>k.y||19<k.y)&&0<=n&&null!==b.state[n]&&b.state[n]==d&&-1==e.indexOf(n)&&(-1==e.indexOf(a)&&e.push(a),e.push(n),c(n,d,e))}},d=b.state.length-1;0<=d;d--)if(null!==b.state[d]){var e=[];c(d,b.state[d],e);if(5<=e.length){for(var f=0;f<e.length;f++)b.state[e[f]]=null;a+=e.length}}return a};this.update=function(a,
c){b.addPlayerBlocks(c.player);for(var d=null,e=0;0!==d;)e++,b.dropFlyingBlocks(),d=this.removeConnectingBlocks(),c.score+=100*d*e;c.updateHud();c.blockLayer.removeAllChildren();for(e=0;e<b.state.length;e++)null!==b.state[e]&&(d=b.indexToCoords(e),d=b.createBlockSprite(32*d.x,32*d.y,c.grid.state[e]),c.blockLayer.addChild(d))}},score:0,gameEnded:!1,lastSpeedUpdate:0,update:function(a){this.player.update(a,this);this.player.reachedFinalPosition&&(this.grid.update(a,this),this.player=new d,this.blockLayer.addChild(this.player.node),
this.player.hasCollision(this.grid)&&(this.gameEnded=!0));.5<(this.lastSpeedUpdate+=a)&&.3<c&&(this.lastSpeedUpdate=0,c-=.001,this.updateHud());this.gameEnded&&this.unscheduleUpdate()},onEnter:function(){this._super();var a=cc.Sprite.create("img/background.png");a.setAnchorPoint(new cc.Point(0,0));this.addChild(a,0);this.blockLayer=cc.Layer.create();this.blockLayer.setAnchorPoint(new cc.Point(0,0));this.addChild(this.blockLayer,1);this.hudLayer=cc.Layer.create();this.hudLayer.setAnchorPoint(new cc.Point(0,
0));this.hudLayer.setPosition(0,-50);this.addChild(this.hudLayer,2);this.player=new d;this.blockLayer.addChild(this.player.node);cc.eventManager.addListener(f,this);this.updateHud();this.scheduleUpdate()},updateHud:function(){this.hudLayer.removeAllChildren();var a=cc.LabelTTF.create("Connect at least\n5 blocks to\nclear them\n\n\n(use arrow keys\nto move & rotate)\n\n\n\n\n\n\n\n\n\n\n\nSCORE:\n\n\n\n\nSPEED:","Arial",20);a.setPosition(550,390);var b;b=this.score;b="undefined"===typeof b?"000000":
("000000"+b).slice(-6);b=cc.LabelTTF.create(b,"Arial",40);b.fillStyle=new cc.Color(185,185,0);b.setAnchorPoint(new cc.Point(0,0));b.setPosition(470,185);var d=100-Math.floor((c-.3)/.7*100),d=cc.LabelTTF.create((100>=d?d:100)+"%","Arial",30);d.fillStyle=new cc.Color(185,185,0);d.setAnchorPoint(new cc.Point(0,0));d.setPosition(470,75);this.hudLayer.addChild(a,0);this.hudLayer.addChild(b,0);this.hudLayer.addChild(d,0)}}),f=cc.EventListener.create({event:cc.EventListener.KEYBOARD,onKeyReleased:function(a,
b){var c=b.getCurrentTarget(),d=c.player;switch(a){case 38:d.rotate(c);break;case 40:d.moveBy(0,-1,c);break;case 37:d.moveBy(-1,0,c);break;case 39:d.moveBy(1,0,c)}}});cc.game.onStart=function(){cc.LoaderScene.preload(a,function(){e();cc.director.runScene(new e)},this);window.focus();document.getElementById("game").focus()};cc.game.run("game")};window.onload=PrototypeGame;
